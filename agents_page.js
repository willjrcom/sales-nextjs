(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81296],{3484:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});var s=r(99345),o=r(32539),a=r(33705);let n=({stripeStatus:e,limitOptions:t,selectedLimit:r,customValue:n,handleLimitSelect:l,handleCustomLimitChange:i,onCancel:c,onEnable:d})=>(0,s.jsx)("div",{className:"flex flex-col gap-2",children:e?.membershipType===a.V.FREE||e?.membershipType===a.V.FREE_TRIAL?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.o5,{className:"web-text-base text-white/70",children:"Enable on-demand usage to go beyond your plan's included limits."}),(0,s.jsx)("a",{href:"/dashboard",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Upgrade to Pro"}),(0,s.jsx)(o.o5,{className:"text-xs text-white/50",children:"On-demand usage requires a paid plan."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.o5,{className:"web-text-base text-white/70",children:"Launching a cloud agent requires on-demand usage to be enabled. Select a limit to continue."}),(0,s.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[t.map(e=>(0,s.jsx)("div",{className:`flex flex-1 cursor-pointer select-none items-center justify-center rounded-md px-2 py-1 opacity-80 hover:opacity-100 ${r===e?"border border-solid border-white !opacity-100":"border border-solid border-gray-600"}`,onClick:()=>l(e),children:(0,s.jsx)("span",{className:`select-none text-center text-[11px] ${r===e?"text-white":"text-theme-text-primary"}`,children:e})},e)),(0,s.jsx)("input",{type:"text",value:n?`$${n}`:"",onChange:e=>i(parseInt(e.target.value.replace("$",""))||0),onClick:()=>{l("Custom")},onKeyDown:e=>{"Enter"===e.key&&(null===n&&i(50),l("Custom"))},onBlur:()=>{l("Custom")},className:`flex w-[45px] flex-1 items-center justify-center rounded-md border border-solid border-white !bg-transparent px-2 py-1 text-center text-[11px] opacity-80 outline-none ring-0 hover:opacity-100 ${"Custom"===r?"border border-solid border-white !text-white !opacity-100":"border border-solid border-gray-600 !text-theme-text-primary"}`,placeholder:"$ "})]}),(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:c,className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Cancel"}),(0,s.jsx)("button",{onClick:d,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Enable"})]})]})})},7103:(e,t,r)=>{Promise.resolve().then(r.bind(r,23148))},16289:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});var s=r(13528),o=r(49852),a=r(51875),n=r(88341);let l=["dashboard","userPrivacyMode"],i=()=>{let e=(0,o.jE)(),[t,r]=(0,n.useState)(null),[i,c]=(0,n.useState)(0),[d,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1),[x,h]=(0,n.useState)(!1),{data:f,isLoading:g,isFetching:b,refetch:v}=(0,a.I)({queryKey:l,queryFn:async()=>{let e=await fetch("/api/dashboard/get-user-privacy-mode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new s.KoG({inferredPrivacyMode:s.YTt.UNSPECIFIED}).toJson())});if(!e.ok)throw Error(`HTTP error ${e.status}`);let t=await e.json();return s.mWk.fromJson(t)},enabled:!0});(0,n.useEffect)(()=>{f&&(r(f.privacyMode),c(f.hoursRemainingInGracePeriod),u(f.isEnforcedByTeam),p(f.partnerDataShare),h(f.hasAcknowledgedGracePeriodDisclaimer))},[f]);let y=(0,n.useCallback)(async()=>{await v()},[v]),w=(0,n.useCallback)(async t=>{try{let o=crypto.randomUUID(),a=await fetch("/api/dashboard/set-user-privacy-mode",{method:"POST",headers:{"Content-Type":"application/json","x-request-id":o},body:JSON.stringify(new s.eWf({privacyMode:t}).toJson())});if(!a.ok){let e=await a.json();throw Error((e?.error?.details?.at(0)?.details?.detail??e?.error?.message??`HTTP error ${a.status}`)+` (request id: ${o})`)}return r(t),e.invalidateQueries({queryKey:l}),!0}catch(e){return console.error("Error updating user privacy mode:",e),!1}},[e]);return{userPrivacyMode:t,isLoadingPrivacyMode:g||b,hoursRemainingInGracePeriod:i,isEnforcedByTeam:d,partnerDataShare:m,hasAcknowledgedGracePeriodDisclaimer:x,isBackgroundAgentsRestricted:t===s.YTt.NO_STORAGE,fetchUserPrivacyMode:y,updateUserPrivacyMode:w}}},16833:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});var s=r(19834),o=r(51875),a=r(79598);function n(e,t,r){let s={[e]:t};for(let[t,o]of Object.entries(r))t!==e&&("number"==typeof o?s[t]=0:"string"==typeof o?s[t]="user_email"===t||"auth_id"===t?o:"":"boolean"==typeof o?s[t]=!1:s[t]=null);return s}function l(e,t,r){if(!e||0===e.length)return e;let s=function(e){for(let t of["date","event_date","day"])if(t in e&&"string"==typeof e[t])return t;return null}(e[0]);if(!s)return e;let o=function(e,t){let r=[];for(let t of["client_version","model_intent","model","source","repo_name","file_extension","user_email","auth_id","command_name","tool_name"])t in e[0]&&"string"==typeof e[0][t]&&r.push(t);return r}(e,0),a=function(e,t){let r=[],s=new Date(e),o=new Date(t);for(s.setHours(0,0,0,0),o.setHours(0,0,0,0);s<=o;)r.push(function(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}(s)),s.setDate(s.getDate()+1);return r}(t,r);if(o.length>0){let t=new Map;for(let r of e){let e=r[s];if(e){let s=e.split("T")[0]?.split(" ")[0]??e;t.has(s)||t.set(s,[]),t.get(s).push(r)}}let r=new Map;for(let t of o)for(let s of(r.set(t,new Set),e)){let e=s[t];"string"==typeof e&&r.get(t).add(e)}let l=[];for(let i of a)if(t.has(i))l.push(...t.get(i));else{let t=o[0],a=r.get(t);if(a)for(let r of a){let o=n(s,i,e[0]);o[t]=r,l.push(o)}}return l}{let t=new Map;for(let r of e){let e=r[s];if(e){let s=e.split("T")[0]?.split(" ")[0]??e;t.set(s,r)}}let r=[];for(let o of a)if(t.has(o))r.push(t.get(o));else{let t=n(s,o,e[0]);r.push(t)}return r}}function i(e,t){let{startDate:r,endDate:n,enabled:i=!0,user:c,group:d,teamId:u,repoName:m,branchName:p,isPrimaryBranch:x,sortBy:h,page:f,pageSize:g}=t||{},{user:b}=(0,s.Jd)(),v=(0,a.pP)(b),y=(0,a.Li)(e,{startDate:r,endDate:n,user:c,group:d,teamId:u,repoName:m,branchName:p,isPrimaryBranch:x,sortBy:h,page:f,pageSize:g},v);return(0,o.I)({queryKey:["analytics-v2",e,y,h,f,g],queryFn:async({signal:t})=>{let s=`/api/v2${e}`,o=[];if(r){let e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");o.push(`startDate=${e}-${t}-${s}`)}if(n){let e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0");o.push(`endDate=${e}-${t}-${r}`)}if(c){let e=Array.isArray(c)?c.join(","):c;o.push(`user=${e}`)}if(d){let e=Array.isArray(d)?d.join(","):d;o.push(`group=${e}`)}u&&o.push(`teamId=${u}`),m&&o.push(`repoName=${m}`),p&&o.push(`branchName=${p}`),void 0!==x&&o.push(`isPrimaryBranch=${x.toString()}`),h&&o.push(`sortBy=${h}`),void 0!==f&&o.push(`page=${f}`),void 0!==g&&o.push(`pageSize=${g}`);let i=b?.id??b?.sub??b?.email;i&&o.push(`c=${i}`);let v=o.length>0?`?${o.join("&")}`:"",y=`${s}${v}`,w=await (0,a.ZF)(y,{signal:t});if(!w.ok)throw Error(`Analytics API error: ${w.status} ${w.statusText}`);var j=await w.json();if(!r||!n)return j;if("object"==typeof j&&null!==j){if("data"in j&&Array.isArray(j.data))return{...j,data:l(j.data,r,n)};if("timeseries"in j&&"object"==typeof j.timeseries&&null!==j.timeseries){let e=j.timeseries,t="data"in e&&Array.isArray(e.data),s="distribution"in j&&"object"==typeof j.distribution&&null!==j.distribution?j.distribution:null,o=s&&"data"in s&&Array.isArray(s.data);return{...j,...t&&{timeseries:{...e,data:l(e.data,r,n)}},...o&&s&&{distribution:{...s,data:l(s.data,r,n)}}}}}return j},enabled:i&&!!r&&!!n,...a.TD})}},19628:()=>{},20003:(e,t,r)=>{"use strict";r.d(t,{s:()=>m});var s=r(99345),o=r(48e3),a=r(22689),n=r(67638),l=r(70973),i=r(62277),c=r(10128),d=r(58637),u=r(88341);let m=({className:e,tabsClassName:t})=>{let r=(0,a.a)(),{theme:m,setTheme:p}=(0,d.D)(),x=(0,u.useCallback)(e=>{p(e)},[p]),h=(0,u.useMemo)(()=>[{name:(0,s.jsx)(l.A,{"aria-label":"System",className:"size-5 md:size-4"}),value:"system"},{name:(0,s.jsx)(i.A,{"aria-label":"Light",className:"size-5 md:size-4"}),value:"light"},{name:(0,s.jsx)(c.A,{"aria-label":"Dark",className:"size-5 md:size-4"}),value:"dark"}],[]),f=(0,u.useMemo)(()=>"system"===m?0:"light"===m?1:2,[m]);return r?(0,s.jsx)("div",{"aria-label":"Theme selector",className:(0,n.cn)("flex items-center gap-2 w-full",e),role:"group",children:(0,s.jsx)(o.Tabs,{activeIndex:f,"aria-label":"Theme options",gap:2,onChange:x,className:(0,n.cn)("flex-1",t),optionsClassName:"!aspect-auto flex-1 h-8 px-1.5 md:p-0 md:h-5.5",options:h})}):(0,s.jsx)("div",{className:(0,n.cn)("min-w-18",e)})}},20350:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var s=r(96853),o=r(15069);async function a(){try{let e=await fetch("/api/auth/list-jwt-public-keys",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);return(await e.json()).keys}catch(e){throw console.error("Error listing jwt public keys:",e),e}}async function n(e){let t=await a(),r=async(e,r)=>{let o=e.kid,a=t.find(e=>e.kid===o);if(!a)throw Error(`Public key not found for kid: ${o}`);return await (0,s.jU)(a.publicKey,"RS256")},{payload:n}=await (0,o.V)(e,r,{algorithms:["RS256"]});return n}},23148:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>rq});var s=r(99345),o=r(44653),a=r.n(o),n=r(54509),l=r(73452),i=r(67638),c=r(46751),d=r(88341),u=r(72830),m=r(19834),p=r(76034),x=r(13528),h=r(22717);function f(e,t){return getComputedStyle(document.documentElement).getPropertyValue(e).trim()||t}var g=r(17290),b=r(16289),v=r(60722),y=r(76401),w=r(51558),j=r(46244),N=r(56517);let C=e=>{if(!e)return new Date;let[t,r,s]=e.split("-").map(Number);return new Date(t,r-1,s)},k={rules:[]},I="agent-filter-config";var S=r(42285),E=r(71426),A=r(15754);function R(e,t,r){let s=function(e){try{let t=e.match(/github\.com[:/]([^/]+)\/([^/\s]+?)(\.git)?$/);if(t)return{owner:t[1],repo:t[2]};return null}catch(e){return console.error("Failed to parse GitHub repo URL:",e),null}}(e);if(!s)return console.error("Failed to parse GitHub repo URL:",e),!1;try{var o,a;let e=(o=s.owner,a=s.repo,`https://github.com/${o}/${a}/compare/${t}...${r}?expand=1`);return window.open(e,"_blank","noopener,noreferrer"),!0}catch(e){return console.error("Failed to open GitHub compare view:",e),!1}}var M=r(22156),D=r(13615),T=r(32539),P=r(25810),L=r(63779),$=r(91743),_=r(48900),U=r(59339),O=r(99683),F=r(91579),z=r(93128),B=r(22836),G=r(50097),H=r(88855),W=r(30478),q=r(48962),K=r(57111),V=r(42653),J=r(49220),Z=r(814);let X={times:[0,.4,1],duration:.5},Y=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)(Z.P.path,{variants:{normal:{y:0},animate:{y:[0,2,0]}},transition:X,animate:l,d:"m6 9 6 6 6-6"})})})});Y.displayName="ChevronDownIcon";let Q={times:[0,.45,1],duration:.7,ease:[.34,1.56,.64,1]},ee={normal:{rotate:0,x:0,y:0},animate:{rotate:[-2.5,3,-1.5,2,0],x:[0,-1.5,1,-.75,0],y:[0,1,-1.5,.5,0]}},et=(0,d.forwardRef)(({size:e=16,className:t,onMouseEnter:r,onMouseLeave:o,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(e=>{c.current||l.start("animate"),r?.(e)},[l,r]),m=(0,d.useCallback)(e=>{c.current||l.start("normal"),o?.(e)},[l,o]);return(0,s.jsx)("div",{className:(0,i.cn)("inline-flex select-none items-center justify-center text-current",t),onMouseEnter:u,onMouseLeave:m,"aria-hidden":!0,...a,children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",style:{overflow:"visible"},children:[(0,s.jsx)("path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,s.jsx)(Z.P.path,{variants:ee,animate:l,transition:Q,d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"})]})})});function er({size:e=14,className:t=""}){return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:`${t} animate-loader-pulse`,"aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M12 2v4"}),(0,s.jsx)("path",{d:"m16.2 7.8 2.9-2.9"}),(0,s.jsx)("path",{d:"M18 12h4"}),(0,s.jsx)("path",{d:"m16.2 16.2 2.9 2.9"}),(0,s.jsx)("path",{d:"M12 18v4"}),(0,s.jsx)("path",{d:"m4.9 19.1 2.9-2.9"}),(0,s.jsx)("path",{d:"M2 12h4"}),(0,s.jsx)("path",{d:"m4.9 4.9 2.9 2.9"})]})}et.displayName="AnimatedSquarePenIcon";var es=r(98959),eo=r(51101),ea=r(85637),en=r(20003),el=r(50127),ei=r(62045),ec=r(28374),ed=r(46090),eu=r(836),em=r(83586);r(62392);var ep=r(99718),ex=r(14111),eh=r(88242),ef=r(17492);let eg=d.memo(function({selectedOption:e="push",onOptionSelect:t,onOpenChange:r,selectedBranch:o}){let a=(0,S.o)(),[n,l]=(0,d.useState)(!1),[i,c]=(0,d.useState)(!1),[u,m]=(0,d.useState)(""),p=(0,d.useRef)(null),x=(0,d.useMemo)(()=>[{value:"push",label:o?`Push to ${o}`:"Push to branch"},{value:"create",label:"Create new branch"}],[o]),h=(0,d.useCallback)(()=>{l(!1)},[]);(0,d.useEffect)(()=>{r?.(n||i)},[n,i,r]);let f=x.filter(e=>e.label.toLowerCase().includes(u.toLowerCase())).map(e=>({id:e.value,displayName:e.label,data:e})),g=(0,d.useMemo)(()=>x.find(t=>t.value===e),[x,e]),b=(0,d.useCallback)(e=>{t(e.value),h(),c(!1)},[t,h]),v=(0,d.useCallback)(t=>{let r=e===t.data.value;return(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("span",{className:"text-base",children:t.displayName}),r&&(0,s.jsx)("div",{className:"h-4 w-4 flex-shrink-0 text-blue-500",children:"✓"})]})},[e]),y=(0,s.jsx)(ep.A,{className:"h-3 w-3 flex-shrink-0 text-theme-text-secondary"});return(0,s.jsx)(s.Fragment,{children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>c(!0),className:"group inline-flex max-w-full cursor-pointer items-center justify-between text-left text-xs text-theme-text-secondary outline-none ring-0 transition-colors duration-100 hover:text-theme-text-primary focus:outline-none focus:ring-0 focus:ring-offset-0",children:[(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-1.5 overflow-hidden transition-opacity duration-100",children:[y,(0,s.jsx)("span",{className:"min-w-0 max-w-[120px] truncate sm:max-w-[160px] md:max-w-[200px]",children:g?.label||"Select branch option"})]}),(0,s.jsx)(ex.A,{className:"ml-1 h-3 w-3 flex-shrink-0 text-theme-text-secondary transition-all duration-100 group-hover:text-theme-text-secondary"})]}),(0,s.jsx)(eh.P,{isOpen:i,onOpenChange:c,items:f,onItemSelect:e=>b(e.data),noItemsText:"No options available",renderItem:v,onSearchChange:m})]}):(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{ref:p,onClick:()=>{n?h():l(!0)},className:"group inline-flex max-w-full cursor-pointer items-center justify-between text-left text-xs text-theme-text-secondary outline-none ring-0 transition-colors duration-100 hover:text-theme-text-primary focus:outline-none focus:ring-0 focus:ring-offset-0",children:[(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-1.5 overflow-hidden transition-opacity duration-100",children:[y,(0,s.jsx)("span",{className:"min-w-0 max-w-[120px] truncate sm:max-w-[160px] md:max-w-[200px]",children:g?.label||"Select branch option"})]}),(0,s.jsx)(ex.A,{className:`ml-1 h-3 w-3 flex-shrink-0 text-theme-text-secondary transition-all duration-100 group-hover:text-theme-text-secondary ${n?"rotate-180":""}`})]}),(0,s.jsx)(ef.W1,{open:n,onClose:h,align:"left",offsetX:-3,width:200,triggerRef:p,className:"text-[11px]",children:(0,s.jsx)("div",{className:"flex flex-col gap-0.5",children:x.map(t=>{let r=e===t.value;return(0,s.jsx)(ef.Dr,{onClick:()=>b(t),label:(0,s.jsx)("span",{className:"text-[11px]",children:t.label}),rightSlot:r?(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-primary"}):void 0},t.value)})})})]})})});var eb=r(10454);function ev({showAutoModelModal:e,setShowAutoModelModal:t,onEditLimits:r,onContinueWithAuto:o}){return(0,s.jsx)("div",{className:`fixed inset-0 flex items-center justify-center transition-all duration-300 ${e?"pointer-events-auto z-50 bg-black/50 opacity-100":"[*]:pointer-events-none pointer-events-none z-[-1] opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>t(!1),children:(0,s.jsx)("div",{className:`pointer-events-auto mx-4 flex w-[380px] flex-col gap-2 rounded-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] p-6 shadow-lg transition-all duration-300 max-sm:mx-0 max-sm:rounded-b-none max-sm:rounded-t-xl max-sm:border-b-0 sm:mx-0 sm:rounded-lg ${e?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,style:{borderColor:"rgb(36, 38, 42)"},onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-xl font-medium text-gray-300",children:"Running on Auto"}),(0,s.jsx)("span",{className:"web-text-base text-theme-text-secondary",children:"Usage limits reached. This Agent is running on Auto for free."}),(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:r,className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Edit limits"}),(0,s.jsx)("button",{onClick:o,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Continue with Auto"})]})]})})})}var ey=r(50531),ew=r(22067),ej=r(27383),eN=r(61885),eC=r(70482),ek=r(1168),eI=r(18687),eS=r(9827),eE=r(74909),eA=r(91433),eR=r(60568),eM=r(51875),eD=r(49852);async function eT(){let e=await fetch("/api/background-composer/get-available-mcp-servers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok){let t=await e.text();throw Error(`Failed to fetch MCP servers: ${e.status} ${t}`)}let t=await e.json();return Array.isArray(t.servers)?t.servers.map(e=>({id:e.id,name:e.name,isTeamServer:e.isTeamServer,enabled:e.enabled,type:e.type,command:e.command,args:e.args,url:e.url,userHasAccessToken:e.userHasAccessToken??!1})):[]}async function eP(e){let t=await fetch("/api/background-composer/update-user-default-mcp-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabledServerIds:e})});if(!t.ok){let e=await t.text();throw Error(`Failed to update MCP defaults: ${t.status} ${e}`)}}var eL=r(76560);let e$={phase:"idle",hasAccessToken:!1,authUrl:void 0,error:void 0};var e_=r(91621);let eU=({server:e,isOpen:t,onClose:r,isTeamAdmin:o=!1})=>{if((0,d.useEffect)(()=>{if(t)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[t]),(0,d.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r()};if(t)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),!t||!e)return null;let a="STDIO"===e.type,n=a?[e.command,...e.args??[]].filter(Boolean).join(" "):e.url??"";return(0,eR.createPortal)((0,s.jsxs)("div",{className:"fixed inset-0 z-[1001] flex items-center justify-center",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:r}),(0,s.jsxs)("div",{className:"relative z-10 w-[380px] max-w-[90vw] rounded-xl bg-[var(--color-theme-bg-card)] border border-[var(--color-theme-border-secondary)] p-5 shadow-xl",children:[(0,s.jsx)("button",{onClick:r,className:"absolute top-3 right-3 p-1 rounded-md text-[var(--color-theme-text-tertiary)] hover:text-[var(--color-theme-text)] hover:bg-[rgba(255,255,255,0.08)] transition-colors","aria-label":"Close",children:(0,s.jsx)(ej.A,{size:16})}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("h2",{className:"text-base font-semibold text-[var(--color-theme-text)]",children:e.name})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-[11px] font-medium text-[var(--color-theme-text-sec)]",children:a?"Command":"Server URL"}),(0,s.jsx)("div",{className:"rounded-md bg-[rgba(0,0,0,0.2)] border border-[var(--color-theme-border-tertiary)] px-3 py-2",children:(0,s.jsx)("code",{className:"text-xs text-[var(--color-theme-text)] font-mono break-all",children:n||"—"})})]}),a&&e.args&&e.args.length>0&&(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-[11px] font-medium text-[var(--color-theme-text-sec)]",children:"Arguments"}),(0,s.jsx)("div",{className:"rounded-md bg-[rgba(0,0,0,0.2)] border border-[var(--color-theme-border-tertiary)] px-3 py-2",children:(0,s.jsx)("code",{className:"text-xs text-[var(--color-theme-text)] font-mono break-all",children:e.args.join(" ")})})]})]}),(0,s.jsx)("div",{className:"mt-5 pt-4 border-t border-[var(--color-theme-border-tertiary)]",children:e.isTeamServer&&!o?(0,s.jsx)("p",{className:"text-xs text-[var(--color-theme-text-tertiary)]",children:"Only team admins can edit this MCP."}):(0,s.jsxs)("p",{className:"text-xs text-[var(--color-theme-text-tertiary)]",children:["To edit this MCP server,"," ",(0,s.jsxs)("a",{href:"/dashboard?tab=cloud-agents",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 text-[var(--color-theme-text)] underline decoration-[var(--color-theme-text-tertiary)] underline-offset-2 hover:decoration-[var(--color-theme-text)] transition-colors",children:["go to the dashboard",(0,s.jsx)(eN.A,{size:10})]}),"."]})})]})]}),document.body)},eO=({server:e,isEnabled:t,onToggle:r,onViewDetails:o,isHighlighted:a,httpStatus:n})=>{let l="STDIO"===e.type?[e.command,...e.args??[]].filter(Boolean).join(" "):e.url,i=(0,d.useRef)(null);(0,d.useLayoutEffect)(()=>{a&&i.current&&i.current.scrollIntoView({block:"nearest"})},[a]);let c="HTTP"===e.type&&!!e.url&&!!n,u=n?.phase??"idle",m="online"===u,p="checking"===u,x=c&&t&&!p,h=x&&m,f=c&&"needs_auth"===u&&!n?.hasAccessToken&&!!n?.authUrl;return(0,s.jsxs)("li",{ref:i,className:(0,ew.A)("flex items-center justify-between rounded-[6px] px-1.5 py-2 transition-colors select-none cursor-pointer",a?"bg-[rgba(255,255,255,0.08)]":"hover:bg-[var(--color-theme-bg-card-hover)]"),onClick:()=>r(e.id),children:[(0,s.jsxs)("div",{className:"flex flex-col min-w-0 flex-1 mr-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-[11px] font-medium text-[var(--color-theme-text)] truncate",children:e.name}),x&&(0,s.jsx)("span",{className:"inline-flex items-center",title:h?"Online":"Unavailable",children:(0,s.jsx)("span",{className:(0,ew.A)("h-1.5 w-1.5 rounded-full",h?"bg-[#4ade80]":"bg-[#f87171]"),"aria-label":m?"Online":"Unavailable"})}),f&&(0,s.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),n?.authUrl&&window.location.assign(n.authUrl)},className:"rounded-full border border-[var(--color-theme-text-sec)] px-1.5 py-0 text-[9px] font-medium text-[var(--color-theme-text)] hover:border-[var(--color-theme-text)] transition-colors leading-tight",children:"Authenticate"}),c&&t&&p&&(0,s.jsx)(eC.A,{size:10,className:"text-theme-text-ter animate-spin"})]}),l&&(0,s.jsx)("span",{className:"text-[10px] text-[var(--color-theme-text-tertiary)] truncate font-mono",title:l,children:l})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 pl-1 shrink-0",children:[(0,s.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),o(e)},className:"p-0.5 rounded text-[var(--color-theme-text-tertiary)] hover:text-[var(--color-theme-text)] hover:bg-[rgba(255,255,255,0.08)] transition-colors","aria-label":"View server details",children:(0,s.jsx)(ek.A,{size:12})}),(0,s.jsx)(e_.j,{isSelected:t})]})]})},eF=({title:e,servers:t,selection:r,onToggle:o,onViewDetails:a,highlightedId:n,isOpen:l,setIsOpen:i,hasPaddingBottom:c=!1,httpStatuses:d})=>0===t.length?null:(0,s.jsxs)("div",{className:(0,ew.A)("flex flex-col",c&&"pb-1.5"),children:[(0,s.jsxs)("button",{type:"button",onClick:()=>i(!l),className:"flex items-center gap-1 px-1.5 py-1.5 text-xs font-medium text-[var(--color-theme-text-sec)] hover:text-[var(--color-theme-text)] transition-colors w-full text-left select-none",children:[(0,s.jsx)("span",{children:e}),l?(0,s.jsx)(ex.A,{size:12,className:"opacity-70 shrink-0"}):(0,s.jsx)(eI.A,{size:12,className:"opacity-70 shrink-0"})]}),l&&(0,s.jsx)("ul",{className:"flex flex-col gap-0.5",children:t.map(e=>(0,s.jsx)(eO,{server:e,isEnabled:r.has(e.id),onToggle:o,onViewDetails:a,isHighlighted:n===e.id,httpStatus:d[e.id]},e.id))})]}),ez=({disabled:e=!1,onOpenChange:t})=>{let{data:r=[],isLoading:o,error:a}=(0,eM.I)({queryKey:["availableMcpServers"],queryFn:eT,staleTime:3e4,refetchOnWindowFocus:!1,retry:2}),n=function(){let e=(0,eD.jE)();return(0,ec.n)({mutationFn:eP,onSuccess:async()=>{await e.invalidateQueries({queryKey:["availableMcpServers"]})}})}(),{data:l}=(0,eL.H)(),{isTeamAdmin:i}=(0,j.M)(),[c,m]=(0,d.useState)(!1),[p,x]=(0,d.useState)(new Set),h=(0,d.useRef)(null),[f,g]=(0,d.useState)(""),b=(0,d.useRef)(null),[v,y]=(0,d.useState)(null),[w,N]=(0,d.useState)(!0),[C,k]=(0,d.useState)(!0),[I,S]=(0,d.useState)(null),E=e=>{S(e)};(0,d.useEffect)(()=>{t?.(c),c?requestAnimationFrame(()=>{b.current?.focus()}):(g(""),y(null))},[c,t]);let A=p.size,R=n.isPending;(0,d.useEffect)(()=>{if(R)return;let e=new Set(r.filter(e=>e.enabled).map(e=>e.id));e.size===p.size&&Array.from(e).every(e=>p.has(e))||x(e)},[r,p,R]);let M=async t=>{if(e||o||R)return;let r=new Set(p),s=new Set(p);s.has(t)?s.delete(t):s.add(t),x(s);try{await n.mutateAsync(Array.from(s))}catch(t){x(r);let e=t instanceof Error?t.message:"Failed to update MCP defaults.";u.oR.error(e)}},D=(0,d.useMemo)(()=>o?null:0===A?"No MCPs enabled":1===A?"1 MCP enabled":`${A} MCPs enabled`,[A,o]),T=(0,d.useMemo)(()=>{if(!f)return r;let e=f.toLowerCase();return r.filter(t=>t.name.toLowerCase().includes(e))},[r,f]),P=(0,d.useMemo)(()=>T.filter(e=>e.isTeamServer),[T]),L=(0,d.useMemo)(()=>T.filter(e=>!e.isTeamServer),[T]),$=!!l?.teamId,_=(0,d.useMemo)(()=>{let e=[];return $?(w&&P.forEach(t=>e.push(t.id)),C&&L.forEach(t=>e.push(t.id))):T.forEach(t=>e.push(t.id)),e},[$,w,P,C,L,T]);(0,d.useEffect)(()=>{c&&_.length>0&&(null===v||!_.includes(v))&&y(_[0])},[c,_,v]);let U=((e,t)=>{let[r,s]=(0,d.useState)({}),o=(0,d.useRef)({});(0,d.useEffect)(()=>{o.current=r},[r]);let a=(0,d.useMemo)(()=>0===t.size?[]:e.filter(e=>t.has(e.id)&&"HTTP"===e.type&&"string"==typeof e.url&&e.url.trim().length>0).sort((e,t)=>e.id-t.id),[e,t]),n=(0,d.useMemo)(()=>0===a.length?"[]":a.map(e=>`${e.id}:${e.url??""}:${!!e.userHasAccessToken}`).join("|"),[a]);(0,d.useEffect)(()=>{if(0===a.length)return void s({});s(e=>{let t={};return a.forEach(r=>{let s=!!r.userHasAccessToken,o=e[r.id];o?t[r.id]={...o,hasAccessToken:s}:t[r.id]={...e$,hasAccessToken:s,phase:"idle"}}),t})},[n,a.length]);let l=(0,d.useMemo)(()=>{let t=new Map;return e.forEach(e=>{t.set(e.id,e)}),t},[e]),i=(0,d.useMemo)(()=>{if(0===a.length)return[];let e=o.current;return a.filter(t=>{let r=e[t.id],s=!!t.userHasAccessToken;return!r||"idle"===r.phase||"checking"!==r.phase&&"online"!==r.phase&&("needs_auth"!==r.phase||!!s)}).map(e=>({server:e,payload:{id:e.id,url:e.url??"",type:e.type}}))},[n]),c=(0,d.useMemo)(()=>0===i.length?"[]":i.map(({server:e})=>`${e.id}:${e.url??""}`).join("|"),[i]);(0,d.useEffect)(()=>{0!==i.length&&s(e=>{let t={...e};return i.forEach(({server:e})=>{t[e.id]={phase:"checking",hasAccessToken:!!e.userHasAccessToken,authUrl:void 0,error:void 0}}),t})},[c]);let u=(0,d.useMemo)(()=>i.map(({payload:e})=>e),[i]),m=(0,d.useCallback)(async()=>{if(0===u.length)return[];let e=await fetch("/api/background-composer/check-http-mcp-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({servers:u})});if(!e.ok){let t=await e.text();throw Error(`Failed to check MCP status: ${e.status} ${t}`)}let t=await e.json();return Array.isArray(t.statuses)?t.statuses:[]},[u]),{data:p,error:x}=(0,eM.I)({queryKey:["httpMcpStatus",c],queryFn:m,enabled:u.length>0,gcTime:0,staleTime:0,retry:0});return(0,d.useEffect)(()=>{p&&Array.isArray(p)&&s(e=>{let t={...e};return p.forEach(r=>{let s=l.get(r.id),o=r.isAvailable?"online":r.requiresAuth?"needs_auth":"error";t[r.id]={phase:o,authUrl:r.authUrl,hasAccessToken:!!e[r.id]?.hasAccessToken||!!s&&!!s.userHasAccessToken,error:"error"===o?r.error??"Unable to reach MCP server.":void 0}}),t})},[p,l]),(0,d.useEffect)(()=>{x&&0!==u.length&&s(e=>{let t={...e};return u.forEach(r=>{let s=l.get(r.id);t[r.id]={phase:"error",hasAccessToken:!!e[r.id]?.hasAccessToken||!!s&&!!s.userHasAccessToken,authUrl:void 0,error:x.message}}),t})},[x,u,l]),r})(r,p);return o&&0===r.length?null:(0,s.jsxs)("div",{className:"relative text-xs","data-prevent-editor-focus":!0,children:[(0,s.jsxs)("button",{type:"button",ref:h,onClick:()=>{e||o||m(e=>!e)},disabled:e,className:(0,ew.A)("group flex items-center gap-1.5 rounded-full border-none text-left text-xs outline-none transition-colors duration-100",e?"cursor-not-allowed text-theme-text-ter":"text-theme-text-secondary hover:text-theme-text","focus-visible:ring-2 focus-visible:ring-theme-text-sec/50 focus-visible:ring-offset-2 focus-visible:ring-offset-theme-bg-card"),children:[(0,s.jsx)(eS.A,{size:14,className:(0,ew.A)("flex-shrink-0 transition-colors duration-100",e?"text-theme-text-ter":void 0)}),null!==D&&(0,s.jsx)("span",{className:"max-w-[160px] truncate text-[12px]",children:D}),o?(0,s.jsx)(eC.A,{size:12,className:"animate-spin text-theme-text-secondary"}):(0,s.jsx)(ex.A,{size:12,className:(0,ew.A)("flex-shrink-0 transition-transform duration-100 text-theme-text-secondary group-hover:text-theme-text",c?"rotate-180":"")})]}),(0,s.jsx)(ef.W1,{open:c,onClose:()=>m(!1),triggerRef:h,align:"left",offsetX:-3,offsetY:4,width:280,className:"p-0",children:(0,s.jsxs)("div",{className:"flex flex-col",onKeyDown:e=>{if(c)switch(e.key){case"ArrowDown":{if(e.preventDefault(),0===_.length)return;let t=v?_.indexOf(v):-1,r=t<_.length-1?t+1:0;y(_[r]);break}case"ArrowUp":{if(e.preventDefault(),0===_.length)return;let t=v?_.indexOf(v):-1,r=t>0?t-1:_.length-1;y(_[r]);break}case"Enter":e.preventDefault(),null!==v&&M(v)}},children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 border-b border-theme-border-02 px-1.5 py-1.5",children:[(0,s.jsx)(eE.A,{size:12,className:"flex-shrink-0 text-theme-text-secondary"}),(0,s.jsx)("input",{ref:b,type:"text",placeholder:"Search MCP servers...",value:f,onChange:e=>g(e.target.value),className:"flex-1 bg-transparent text-xs outline-none placeholder:text-[var(--color-theme-text-tertiary)] text-[var(--color-theme-text)]"}),(0,s.jsx)("button",{type:"button",onClick:()=>{window.open("/dashboard?tab=cloud-agents","_blank","noopener,noreferrer")},className:"ml-1 inline-flex h-5 w-5 items-center justify-center text-theme-text-secondary hover:text-theme-text transition-colors",title:"Open Cloud Agents dashboard",children:(0,s.jsx)(eA.A,{size:12})})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[a&&(0,s.jsx)("div",{className:"m-2 rounded border border-red-500/40 bg-red-500/10 px-2 py-1.5 text-[11px] text-red-200",children:a.message}),!a&&0===r.length&&(0,s.jsx)("p",{className:"px-2 py-3 text-[var(--color-theme-text-sec)] text-xs text-center",children:"No MCP servers available"}),!a&&r.length>0&&0===T.length&&(0,s.jsx)("p",{className:"px-2 py-3 text-[var(--color-theme-text-sec)] text-xs text-center",children:"No matching servers found"}),!a&&T.length>0&&(0,s.jsx)("div",{className:"flex max-h-64 flex-col overflow-y-auto",children:$?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eF,{title:"Team",servers:P,selection:p,onToggle:M,onViewDetails:E,highlightedId:v,isOpen:w,setIsOpen:N,hasPaddingBottom:0===L.length,httpStatuses:U}),(0,s.jsx)(eF,{title:"User",servers:L,selection:p,onToggle:M,onViewDetails:E,highlightedId:v,isOpen:C,setIsOpen:k,httpStatuses:U})]}):(0,s.jsx)("ul",{className:"flex flex-col gap-0.5",children:T.map(e=>(0,s.jsx)(eO,{server:e,isEnabled:p.has(e.id),onToggle:M,onViewDetails:E,isHighlighted:v===e.id,httpStatus:U[e.id]},e.id))})})]})]})}),(0,s.jsx)(eU,{server:I,isOpen:null!==I,onClose:()=>S(null),isTeamAdmin:i})]})};var eB=r(93846);let eG=({showAutoModelModal:e,setShowAutoModelModal:t,onEditLimits:r,onContinueWithAuto:o})=>(0,s.jsx)(eB._s.Root,{open:e,onOpenChange:e=>{e||t(!1)},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 flex h-fit max-h-[70vh] flex-col rounded-t-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315]",children:[(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsxs)("div",{className:"p-6 pt-0",children:[(0,s.jsx)("div",{className:"mb-0 flex items-center justify-between",children:(0,s.jsx)(T.DZ,{variant:"subheading-2",className:"text-white",children:"Running on Auto"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(T.o5,{className:"web-text-base text-white/70",children:"Usage limits reached"}),(0,s.jsx)(T.o5,{className:"text-xs text-white/50",children:"This Agent is running on Auto for free."}),(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:r,className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Edit limits"}),(0,s.jsx)("button",{onClick:o,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Continue with Auto"})]})]})]})]})]})});var eH=r(69899),eW=r(39313),eq=r(31922),eK=r(16833),eV=r(49029);let eJ="recentRepositories";function eZ(){try{let e=localStorage.getItem(eJ);return e?JSON.parse(e):[]}catch{return[]}}function eX(e,t){if(!t||t.length<1)return e;let r=t.toLowerCase(),o=e.toLowerCase(),a=[],n=0;for(;n<o.length;){let e=o.indexOf(r,n);if(-1===e)break;a.push({start:e,end:e+r.length}),n=e+r.length}if(0===a.length)return e;let l=[],i=0;for(let t=0;t<a.length;t++){let r=a[t];r.start>i&&l.push(e.slice(i,r.start)),l.push((0,s.jsx)("span",{className:"bg-yellow-200 text-black",children:e.slice(r.start,r.end)},t)),i=r.end}return i<e.length&&l.push(e.slice(i)),l}let eY=d.memo(function({selectedRepo:e,onRepoSelect:t,className:r="",hasCachedData:o=!1,onOpenChange:a,hideIcon:n=!1,largeFonts:l=!1,disabled:i=!1}){let c=(0,S.o)(),{installations:u,isLoading:m,githubConnected:p}=(0,h.C)({isTeamAdmin:void 0,includeTeamOwnedRepos:!1,search:void 0}),[x,f]=(0,d.useState)(!1),[g,b]=(0,d.useState)("left"),[y,w]=(0,d.useState)(""),[j,N]=(0,d.useState)(-1),C=(0,d.useRef)(null),k=(0,d.useRef)(null),I=(0,d.useRef)(null);(0,d.useEffect)(()=>{a?.(x)},[x,a]),(0,d.useEffect)(()=>{if(!x||!C.current)return;let e=()=>{let e=C.current;if(!e)return;let t=e.getBoundingClientRect(),r=window.innerWidth-t.left,s=t.right;!(r>=256)&&s>=256?b("right"):b("left")};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[x]);let E=eZ(),{data:A}=(0,eL.H)(),R=(0,d.useMemo)(()=>new Date,[]),M=(0,d.useMemo)(()=>{let e=new Date;return e.setDate(e.getDate()-90),e},[]),D=(0,eK.S)("/analytics/team/ai-commits/by-repo",{startDate:M,endDate:R,teamId:A?.teamId?.toString(),enabled:!!(A?.teamId&&M&&R)}),T=(0,d.useMemo)(()=>{let e=new Map;if(D.data?.data)for(let t of D.data.data)t.repo_name&&e.set(t.repo_name,t.total_commits||0);return e},[D.data]),P=(0,d.useMemo)(()=>u.flatMap(e=>e.repos.map(t=>{let r=t.owner?.trim()||"",s=t.name?.trim()||"",o=r&&s?`${r}/${s}`:s||r||"Untitled",a=T.get(o)??0;return{repo:t,displayName:o,installationName:e.repos.length>0&&r||"Unknown",commitCount:a}})),[u,T]),L=(0,d.useMemo)(()=>[...P].sort((e,t)=>t.commitCount!==e.commitCount?t.commitCount-e.commitCount:e.displayName.localeCompare(t.displayName)),[P]),$=(0,d.useMemo)(()=>y.trim()?L.filter(e=>e.displayName.toLowerCase().includes(y.toLowerCase())):L,[L,y]),_=(0,d.useMemo)(()=>{let e=new Set(E.map(e=>e.repoNodeId));return{recentRepoItems:$.filter(t=>e.has(t.repo.repoNodeId)),otherRepoItems:$.filter(t=>!e.has(t.repo.repoNodeId))}},[$,E]),U=(0,d.useMemo)(()=>{if(e&&(P.some(t=>t.repo.repoNodeId===e.repoNodeId)||o))return e},[e,P,o]),O=(0,d.useCallback)(e=>{try{let t=eZ(),r={repoNodeId:e.repoNodeId,owner:e.owner,name:e.name,htmlUrl:e.htmlUrl,installationId:e.installationId.toString()},s=t.filter(t=>t.repoNodeId!==e.repoNodeId),o=[r,...s].slice(0,3);localStorage.setItem(eJ,JSON.stringify(o))}catch{}t(e),f(!1),w("")},[t]),z=(0,d.useCallback)(()=>{f(!1),w("")},[]),B=(0,d.useCallback)(()=>{f(!1),(0,v.Sv)("BACKGROUND_AGENT_WEB","website",void 0)},[]);(0,d.useEffect)(()=>{if(x){let e=setTimeout(()=>{k.current?.focus(),N(-1)},200);return()=>clearTimeout(e)}},[x]),(0,d.useEffect)(()=>{$.length>0?N(0):N(-1)},[y,$.length]),(0,d.useEffect)(()=>{if(j>=0&&I.current){let e=I.current.querySelectorAll("[data-repo-item]")[j];e&&e.scrollIntoView({block:"nearest",behavior:"auto"})}},[j]),(0,d.useEffect)(()=>{if(!x)return;let e=e=>{let t=_.recentRepoItems.concat(y?$:_.otherRepoItems);switch(e.key){case"ArrowDown":e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),N(e=>{let r=e+1;return r>=t.length?0:r});break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),N(e=>{let r=e-1;return r<0?t.length-1:r});break;case"Enter":j>=0&&j<t.length&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),O(t[j].repo))}};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[x,j,_,$,y,O]);let G=!n&&(0,s.jsx)(eW.A,{strokeWidth:1.5,className:"text-theme-text-secondary",style:{width:"14px",height:"14px"}}),H=(0,d.useCallback)((e,t,r)=>{let o=U?.repoNodeId===e.data.repoNodeId,a=e.displayName.split("/")[1]||e.displayName||"Untitled",n=e.data.owner?.trim()||"";return(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsxs)("div",{className:"mr-3 min-w-0 flex-1",children:[(0,s.jsx)("div",{className:"text-base font-medium text-theme-text-primary",children:eX(a,r)}),(0,s.jsx)("div",{className:"max-w-full flex-shrink-0 truncate web-text-base text-gray-400",children:eX(n,r)})]}),o&&(0,s.jsx)(F.A,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-theme-text-primary"})]})},[U]);return c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>{i||f(!0)},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),i||f(!0))},disabled:i,className:`group flex w-fit max-w-[240px] flex-shrink-0 items-center justify-between rounded-full border-none text-left outline-none transition-colors duration-100 focus:border-none focus:outline-none focus-visible:ring-2 focus-visible:ring-theme-text-sec/50 focus-visible:ring-offset-2 focus-visible:ring-offset-theme-bg-card ${i?"cursor-not-allowed text-theme-text-ter":"text-theme-text-secondary hover:text-theme-text-secondary"} ${r}`,style:{fontSize:l?"14px":"11px"},"data-tooltip-id":i?"insufficient-permissions-tooltip":void 0,"data-tooltip-place":i?"top":void 0,"data-tooltip-content":i?"Insufficient permissions to update setting":void 0,children:[(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-1.5 transition-opacity duration-100",children:[G,(0,s.jsx)("div",{className:"flex min-w-0 items-center gap-1",children:(0,s.jsx)("span",{className:`${l?"text-[12px]":"text-[11px]"} truncate`,children:U?(()=>{let e=U.owner?.trim()||"",t=U.name?.trim()||"";return e&&t?`${e}/${t}`:t||e||"Untitled"})():p?m?"Loading...":"Select repository":"Connect GitHub"})})]}),(0,s.jsx)(ex.A,{className:"ml-1 h-3 w-3 flex-shrink-0 transition-opacity duration-100 text-theme-text-secondary group-hover:text-theme-text-secondary"})]}),(0,s.jsx)(eh.P,{isOpen:x,onOpenChange:f,items:$.map(e=>({id:e.repo.repoNodeId,displayName:e.displayName,data:e.repo})),onItemSelect:e=>O(e.data),searchPlaceholder:"Search repositories...",noItemsText:"No repositories available",onSearchChange:w,renderItem:H})]}):(0,s.jsxs)("div",{className:`relative ${r}`,children:[(0,s.jsxs)("button",{ref:C,onClick:()=>{i||f(!x)},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),i||f(!x))},disabled:i,className:`group flex w-fit max-w-[240px] flex-shrink-0 items-center justify-between rounded-full border-none text-left outline-none transition-colors duration-100 focus:border-none focus:outline-none focus-visible:ring-2 focus-visible:ring-theme-text-sec/50 focus-visible:ring-offset-2 focus-visible:ring-offset-theme-bg-card ${i?"cursor-not-allowed text-theme-text-ter":"text-theme-text-secondary hover:text-theme-text-secondary"}`,style:{fontSize:l?"14px":"11px"},"data-tooltip-id":i?"insufficient-permissions-tooltip":void 0,"data-tooltip-place":i?"top":void 0,"data-tooltip-content":i?"Insufficient permissions to update setting":void 0,children:[(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-1.5 transition-opacity duration-100",children:[G,(0,s.jsx)("div",{className:"flex min-w-0 items-center gap-1",children:(0,s.jsx)("span",{className:`${l?"text-[12px]":"text-[11px]"} truncate`,children:e?(()=>{let t=e.owner?.trim()||"",r=e.name?.trim()||"";return t&&r?`${t}/${r}`:r||t||"Untitled"})():p?m?"Loading...":"Select repository":"Connect GitHub"})})]}),(0,s.jsx)(ex.A,{className:`ml-1 h-3 w-3 flex-shrink-0 transition-opacity duration-100 ${x?"rotate-180":""} text-theme-text-secondary group-hover:text-theme-text-secondary`})]}),(0,s.jsx)(ef.W1,{open:x,onClose:z,triggerRef:C,align:g,offsetX:"right"===g?3:-3,offsetY:4,width:240,className:"max-h-[320px] overflow-hidden",disableKeyboardNavigation:!0,children:(0,s.jsxs)("div",{className:"flex flex-col",children:[P.length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1.5 border-b border-theme-border-02",children:[(0,s.jsx)(eE.A,{className:"h-3 w-3 text-theme-text-secondary flex-shrink-0"}),(0,s.jsx)("input",{ref:k,type:"text",placeholder:"Search repositories...",value:y,onChange:e=>w(e.target.value),className:"flex-1 bg-transparent border-none outline-none web-text-sm text-theme-text-primary placeholder:text-theme-text-secondary",onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Escape"!==e.key&&"Enter"!==e.key&&"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&e.stopPropagation()}})]}),(0,s.jsx)("div",{ref:I,className:"max-h-[240px] overflow-y-auto",children:0===$.length?(0,s.jsx)("div",{className:"px-3 py-4 text-center web-text-sm text-theme-text-secondary",children:y?"No repositories found":p?m?"Loading repositories...":"No repositories available":"Connect GitHub to see repositories"}):(0,s.jsxs)(s.Fragment,{children:[_.recentRepoItems.length>0&&!y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"px-2 py-1.5 text-[11px] text-theme-text-secondary",children:"Recent"}),_.recentRepoItems.map((e,t)=>(0,s.jsx)("div",{"data-repo-item":!0,children:(0,s.jsx)(eV.D,{onClick:()=>O(e.repo),alignItems:"start",className:j===t?"bg-[rgba(255,255,255,0.08)]":"",label:(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium text-start",children:eX(e.repo.name?.trim()||"Untitled",y)}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary text-start",children:eX(e.repo.owner?.trim()||"",y)})]}),rightSlot:U?.repoNodeId===e.repo.repoNodeId&&(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-secondary"})})},e.repo.repoNodeId)),_.otherRepoItems.length>0&&(0,s.jsx)("div",{className:"mx-2 my-1 border-t border-theme-border-02"})]}),(_.otherRepoItems.length>0||y)&&(0,s.jsxs)(s.Fragment,{children:[!y&&_.recentRepoItems.length>0&&(0,s.jsx)("div",{className:"px-2 py-1.5 text-[11px] text-theme-text-secondary",children:"All Repositories"}),(y?$:_.otherRepoItems).map((t,r)=>{let o=y?r:_.recentRepoItems.length+r;return(0,s.jsx)("div",{"data-repo-item":!0,children:(0,s.jsx)(eV.D,{onClick:()=>O(t.repo),alignItems:"start",className:j===o?"bg-[rgba(255,255,255,0.08)]":"",label:(0,s.jsxs)("div",{className:"flex flex-col gap-0.5 ",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium text-start",children:eX(t.repo.name?.trim()||"Untitled",y)}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary text-start",children:eX(t.repo.owner?.trim()||"",y)})]}),rightSlot:e?.repoNodeId===t.repo.repoNodeId&&(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-secondary"})})},t.repo.repoNodeId)})]})]})}),(0,s.jsx)("div",{className:"border-t border-theme-border-02 p-1",children:(0,s.jsx)(eV.D,{onClick:B,icon:(0,s.jsx)(eq.A,{className:"h-3 w-3"}),label:"Manage GitHub",rightSlot:(0,s.jsx)(eN.A,{className:"h-3 w-3"})})})]})})]})}),eQ=(e,t)=>{let r={};return e.forEach(e=>{let s=t[e];r[e]=Math.min(4,Math.max(1,Math.floor("number"==typeof s?s:1)))}),r};function e0({onFocusChange:e,onDropdownOpenChange:t,onBeforeSubmit:r,viewConfig:o,onViewConfigChange:a,filterConfig:n,onFilterConfigChange:l,inputRef:i,isFloating:c,isFollowUp:x,customPlaceholder:f,hideDropdowns:g,hideFooterButtons:b,onStop:v,selectedComposer:N,githubConnected:C,isGithubLoading:k,onConnectGithub:I,githubError:E,deeplinkData:R,hasOpenModal:T,onOrchestraStarted:P}){let{refetchBackgroundComposers:L,setShowUsagePricingModal:$,setShowUpgradePaidModal:_,addOptimisticBackgroundComposer:U,removeOptimisticBackgroundComposer:O,updateComposerStatusOptimistically:F,setSelectedComposerId:z,backgroundComposers:B,showAutoModelModal:G,setShowAutoModelModal:H,addOptimisticMessage:W,removeOptimisticMessage:q,draftInputState:K,setDraftInputState:V,clearDraftInputState:J}=(0,w._F)(),{stripeStatus:Z}=(0,j.M)(),{installations:X,isLoading:Y,loadingMoreRepos:Q,isInitialLoading:ee}=(0,h.C)({isTeamAdmin:void 0,includeTeamOwnedRepos:!1,search:void 0}),et=(0,ed.t)(),eo=(0,S.o)(),{mutateAsync:ea}=(0,ec.n)({mutationFn:async({request:e,signal:t})=>{let r=await fetch("/api/auth/startParallelAgentWorkflow",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJson()),signal:t});if(!r.ok){let e=await r.json();throw console.error("Orchestra request failed:",e),Error(e.message||"Failed to start parallel agent workflow")}let s=await r.json(),o=p.ju.fromJson(s);return{parentBcId:o.parentBcId,workflowId:o.workflowId}},retry:!1}),{user:en}=(0,m.Jd)(),ep=(0,d.useMemo)(()=>!!en?.email&&(en.email.endsWith("anysphere.co")||en.email.endsWith("cursor.com")),[en?.email]),[ex,eh]=(0,d.useState)(!0),ef=(0,d.useMemo)(()=>x&&N?.composer?.bcId?N.composer.bcId:"new",[x,N?.composer?.bcId]),[ew,ej]=(0,d.useState)(()=>K[ef]?.text??""),[eN,eC]=(0,d.useState)(()=>K[ef]?.richText??""),[ek,eI]=(0,d.useState)(null),[eS,eE]=(0,d.useState)(!1),[eA,eR]=(0,d.useState)(null),[eM,eD]=(0,d.useState)(void 0),[eT,eP]=(0,d.useState)(void 0),[eL,e$]=(0,d.useState)(!1),e_=(0,y.useGateValue)("bg_mcps"),eU=(0,d.useRef)(null);(0,d.useEffect)(()=>{let e=(0,A.f6)(),t=(0,A.XG)();e&&!eM&&(eD(e),eU.current=e.repoNodeId),t&&!eT&&eP(t),e$(!0)},[]),(0,d.useEffect)(()=>{!k&&!Y&&!ee&&0===Q.size&&X.length>0&&eM&&eU.current!==eM.repoNodeId&&(X.some(e=>e.repos.some(e=>e.repoNodeId===eM.repoNodeId))||(eD(void 0),eP(void 0)))},[k,Y,ee,Q,X,eM]);let eO=(0,d.useMemo)(()=>N?.composer?.status??B.find(e=>e.bcId===N?.composer?.bcId)?.status,[N,B]),[eF,eB]=(0,d.useState)(()=>{if(x&&N?.modelDetails?.modelName){let e=N.modelDetails.modelName;if(e&&"string"==typeof e)return[e]}return[]}),[eW,eq]=(0,d.useState)(()=>({})),[eK,eV]=(0,d.useState)(!1);(0,d.useEffect)(()=>{if(x)return void eV(!0);let e=(0,A.Ju)(eH.lb),t=(0,A.eS)(eH.lb);eB(e),eq(eQ(e,t)),eV(!0)},[x]),(0,d.useEffect)(()=>{if(x&&N?.modelDetails?.modelName){let e=N.modelDetails.modelName;e&&(eB(t=>1===t.length&&t[0]===e?t:[e]),eq({[e]:1}),eV(!0))}},[x,N?.modelDetails?.modelName]);let[eJ,eZ]=(0,d.useState)(!1),[eX,e0]=(0,d.useState)(!1),[e1,e2]=(0,d.useState)(!1),[e5,e3]=(0,d.useState)(!1),[e4,e6]=(0,d.useState)("push"),e8=!!R&&"push"===e4,e9=e8?"disable push to branch to run multiple models":void 0,[e7,te]=(0,d.useState)(()=>K[ef]?.images??[]),[tt,tr]=(0,d.useState)(new Set),[ts,to]=(0,d.useState)(()=>K[ef]?.imageDataUrls??{}),ta=(0,d.useRef)(!1),tn=(0,d.useRef)(null);(0,d.useEffect)(()=>{V(ef,{text:ew,richText:eN,images:e7,imageDataUrls:ts})},[ef,ew,eN,e7,ts,V]),(0,d.useEffect)(()=>{let e=K[ef];e?(ej(e.text),eC(e.richText),te(e.images),to(e.imageDataUrls),ek&&ek.update(()=>{let t=(0,ei.NiT)();if(t.clear(),e.text){let r=(0,ei.lJ7)(),s=(0,ei.sTu)(e.text);r.append(s),t.append(r),s.select();let o=(0,ei.vJq)();(0,ei.I2P)(o)&&(o.anchor.offset=e.text.length,o.focus.offset=e.text.length)}})):(ej(""),eC(""),te([]),to({}),ek&&ek.update(()=>{(0,ei.NiT)().clear()}))},[ef,ek]),(0,d.useEffect)(()=>{let e=new Set;e7.forEach((t,r)=>{ts[t.uuid]||e.add(r)}),e.size>0?tr(e):tt.size>0&&tr(new Set)},[e7,ts,tt.size]),(0,d.useEffect)(()=>{let e=eJ||eX||e1||e5;t?.(e)},[eJ,eX,e1,e5,t]),(0,d.useEffect)(()=>{eM&&(0,A.$d)(eM)},[eM]),(0,d.useEffect)(()=>{if(eT){if(ta.current){ta.current=!1;return}(0,A.P5)(eT)}},[eT]),(0,d.useEffect)(()=>{if(!x&&eK){let e=eQ(eF,eW);(0,A.d9)(eF,e)}},[x,eW,eK,eF]);let tl=(0,d.useCallback)((e,t)=>{if(x||e8){let t=e.at(-1);if(!t){eB([]),eq({});return}eB([t]),eq({[t]:1})}else{let r=eQ(e,t);eB(e),eq(r)}},[x,e8]);(0,d.useEffect)(()=>{if(!e8||eF.length<=1)return;let e=eF[0];if(!e){eB([]),eq({});return}eB([e]),eq({[e]:1})},[eF,e8]);let ti=(0,d.useCallback)(e=>{eD(e),eM&&eM.repoNodeId===e.repoNodeId||(eP(void 0),(0,A.C4)())},[eM]),tc=(0,d.useCallback)(e=>{eP(e)},[]),td=(e,t)=>({url:e,ref:t,cursorServerCommit:"",userExtensions:[],gitDiffToApply:void 0,environmentJsonOverride:"",dontAllowReadingEnvironmentJsonFromDatabase:!1,skipBuildCaches:!1});(0,d.useImperativeHandle)(i,()=>({setPrompt:e=>{ej(e),eC(e),ek&&ek.update(()=>{let t=(0,ei.NiT)();t.clear(),t.append((0,ei.lJ7)().append((0,ei.sTu)(e)))})},getPrompt:()=>ew,setRepo:(e,t)=>{for(let r of X){let s=r.repos.find(r=>r.owner===e&&r.name===t);if(s)return void ti(s)}console.warn(`Repository ${e}/${t} not found in installations`)},setBranch:e=>{ta.current=!0,eP(e)},focus:()=>{ek&&ek.focus()},insertTextAtCursor:e=>{ek&&ek.update(()=>{let t=(0,ei.vJq)();(0,ei.I2P)(t)?t.insertText(e):(0,ei.NiT)().append((0,ei.lJ7)().append((0,ei.sTu)(e)))})}}),[ek,X,ti,ew]);let tu=(0,d.useCallback)(async e=>{await (0,ey.Q)({files:e,setImages:te,setImageDataUrls:to,showErrorToast:M.Ej,showSuccessToast:M.xj})},[te,to]);(0,d.useCallback)(e=>{te(t=>{let r=t[e];return r&&to(e=>{let{[r.uuid]:t,...s}=e;return s}),t.filter((t,r)=>r!==e)})},[]);let tm=(0,d.useCallback)((e,t,r,s)=>{ej(e),eC(t),te(r),to(s),ek&&ek.update(()=>{let t=(0,ei.NiT)();t.clear(),t.append((0,ei.lJ7)().append((0,ei.sTu)(e)))})},[ek]),tp=async()=>{let e=[...e7],t={...ts},o=!1,a=!1;if(!ew.trim())return(0,M.Ej)("Please enter a message"),!1;if(!x&&E)return(0,M.Ej)("Unable to connect to GitHub. Please try again later."),!1;if(!x&&!1===C&&!k)return I?.(),!1;if(x){if(!N)return(0,M.Ej)("No composer selected"),!1;if(!N.composer?.bcId)return(0,M.Ej)("Invalid composer"),!1;if(0===eF.length||!eF[0])return(0,M.Ej)("Please select a model"),!1;if(eS)return(0,M.Ej)("Please wait for the previous message to be sent"),!1}else{if(!eM)return(0,M.Ej)("Please select a repository"),!1;if(!eT)return(0,M.Ej)("Please select a branch"),!1;if(0===eF.length)return(0,M.Ej)("Please select at least one model"),!1;if(eS)return(0,M.Ej)("Please wait for the previous message to be sent"),!1}if(r&&!r())return!1;let n=eQ(eF,eW),l=[];eF.forEach(e=>{let t=n[e]??1;for(let r=0;r<t;r+=1)l.push({modelName:e,bcId:`bc-${crypto.randomUUID()}`,instanceIndex:r})});let i=l.length;if(!x&&0===i)return u.oR.error("Please select at least one model instance"),!1;(0,eu.sx)("webagent.submitted",{is_follow_up:eu.rw.bool(x??!1),model_count:eu.rw.int(eF.length),model_instance_count:eu.rw.int(i),models:eu.rw.string(eF.map(e=>`${e}:${n[e]??1}`).join(",")),image_count:eu.rw.int(e7.length),source:eu.rw.string(et?"ios_app":"website"),is_mobile:eu.rw.bool(eo)});let c=new AbortController;if(eR(c),eE(!0),x&&N&&N.composer){if(N.composer.isArchived)return(0,M.Ej)("Cannot send message, Agent is archived"),eE(!1),eR(null),!1;te([]),to({}),ej(""),eC(""),J(ef),tn.current?.clearImages(),ek&&ek.update(()=>{(0,ei.NiT)().clear()});try{let r=new D.hS({text:ew,type:D.Jc.HUMAN,images:e});r.isDone=!0,W(N.composer.bcId,r),F(N.composer.bcId,p.R6.RUNNING);let s=new p.FF({bcId:N.composer.bcId,followupMessage:r,synchronous:!0,followupSource:et?p._b.IOS_APP:p._b.WEBSITE}),a=await fetch("/api/auth/addAsyncFollowupBackgroundComposer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.toJson()),signal:c.signal});if(!a.ok){let r=await a.json();if(r?.error?.details?.some(e=>"ERROR_USAGE_PRICING_REQUIRED_CHANGEABLE"===e.error))return console.log("Usage pricing required error:",r),$(!0),q(N.composer.bcId,ew),o||(tm(ew,eN,e,t),o=!0),!1;if(r?.error?.details?.some(e=>"ERROR_BAD_REQUEST"===e.error&&e.details?.detail?.includes("Free trial usage limit reached")))return console.log("Free trial usage limit reached error:",r),_(!0),q(N.composer.bcId,ew),o||(tm(ew,eN,e,t),o=!0),!1;let s=r?.error?.details?.find(e=>"ERROR_UNAUTHORIZED"===e.error||"ERROR_PRO_USER_ONLY"===e.error);if(s){if((s.details?.detail||"").includes("read-only access to this background composer"))return(0,M.Ej)("You have read-only access to this background composer."),q(N.composer.bcId,ew),o||(tm(ew,eN,e,t),o=!0),!1;return console.log("Pro subscription required error:",r),_(!0),q(N.composer.bcId,ew),o||(tm(ew,eN,e,t),o=!0),!1}throw q(N.composer.bcId,ew),Error(`HTTP error! status: ${a.status}`)}(await a.json()).wasSwappedToDefault&&(console.log("Follow-up model was swapped to auto/default"),th()?(0,M.im)({message:"Running on Auto",description:"Usage limits reached. This Agent is running on Auto for free.",duration:4e3}):(H(!0),tf()))}catch(r){r instanceof Error&&"AbortError"===r.name?(console.log("Background composer request was cancelled"),q(N.composer.bcId,ew)):(console.error("Error sending message:",r),q(N.composer.bcId,ew),o||(tm(ew,eN,e,t),o=!0))}finally{eE(!1),eR(null)}return!1}if(1===eF.length&&eF[0]===eH.rH.id){let r=eM.htmlUrl,s=r.replace("https://",""),o="/workspace",a=`bc-${crypto.randomUUID()}`;U(new p.hF({bcId:a,createdAtMs:Date.now(),workspaceRootPath:o,isOwnedByDifferentTeamMember:!1,name:"Cursor Orchestra",branchName:eT,hasStartedVm:!1,repoUrl:s,isArchived:!1,nId:"",isKilled:!1,status:p.R6.CREATING,isUnread:!0,source:et?p._b.IOS_APP:p._b.WEBSITE,ensembleStatus:p.oL.PARENT}),{promptText:ew,modelDetails:new el.Gm({modelName:eH.rH.id,maxMode:!0}),images:e7}),te([]),to({}),ej(""),eC(""),J(ef),tn.current?.clearImages(),ek&&ek.update(()=>{(0,ei.NiT)().clear()});try{let e=crypto.randomUUID(),t=new p.px({bcId:a,snapshotNameOrId:s,startForAuthIdOnTeam:"",devcontainerStartingPoint:td(r,eT),promptGroupId:e,source:et?p._b.IOS_APP:p._b.WEBSITE,snapshotWorkspaceRootPath:o,prompt:"",richPrompt:"",returnImmediately:!0,files:[],repoUrl:s,modelDetails:{modelName:"cursor-orchestra"},additionalModelDetails:[],repositoryInfo:{repositoryInfo:void 0,pathEncryptionKey:"",shouldSyncIndex:!1,repositoryInfoShouldQueryStaging:!1,queryOnlyRepoAccess:void 0,repositoryInfoShouldQueryProd:!1,repoQueryAuthToken:""},autoBranch:!R||"create"===e4,baseBranch:R?.branch??eT,forceVmBackend:void 0,forceCluster:void 0,conversationHistory:[{text:ew,richText:eN||ew,capabilityContexts:[],type:D.Jc.HUMAN,images:e7}],images:[],documentationIdentifiers:[],externalLinks:[],addInitialMessageToResponses:!0,testModeEnabled:ex}),n=new p.L3({baseRequest:t}),l=await ea({request:n,signal:c.signal});return l.parentBcId&&P&&P(a,l.workflowId),!0}catch(r){return r instanceof Error&&"AbortError"===r.name?console.log("Orchestra request was cancelled"):(console.error("Orchestra request error:",r),(0,M.Ej)("Failed to start Cursor Orchestra")),O(a),tm(ew,eN,e,t),!1}finally{eE(!1),eR(null)}}let d=eM.htmlUrl,m=d.replace("https://",""),h=Date.now(),f=l.length>1?crypto.randomUUID():void 0,g=l.map(e=>new p.hF({bcId:e.bcId,createdAtMs:h,workspaceRootPath:"/workspace",isOwnedByDifferentTeamMember:!1,name:"New Cloud Agent",branchName:eT,hasStartedVm:!1,repoUrl:m,isArchived:!1,nId:"",isKilled:!1,status:p.R6.CREATING,isUnread:!0,source:et?p._b.IOS_APP:p._b.WEBSITE,promptGroupId:f}));g.forEach((e,t)=>{let r=l[t];r?U(e,{promptText:ew,modelDetails:new el.Gm({modelName:r.modelName,maxMode:!0}),images:e7}):U(e)}),te([]),to({}),ej(""),eC(""),J(ef),tn.current?.clearImages(),ek&&ek.update(()=>{(0,ei.NiT)().clear()}),eE(!1);try{console.log("Submitting requests for model runs:",l);let r=l.map(async t=>{let{bcId:r,instanceIndex:s}=t,o=t.modelName;try{let t={bcId:r,snapshotNameOrId:m,startForAuthIdOnTeam:"",devcontainerStartingPoint:td(d,eT),source:et?p._b.IOS_APP:p._b.WEBSITE,snapshotWorkspaceRootPath:"/workspace",prompt:"",richPrompt:"",returnImmediately:!0,files:[],repoUrl:m,modelDetails:{modelName:o,maxMode:!0},additionalModelDetails:[],repositoryInfo:{repositoryInfo:void 0,pathEncryptionKey:"",shouldSyncIndex:!1,repositoryInfoShouldQueryStaging:!1,queryOnlyRepoAccess:void 0,repositoryInfoShouldQueryProd:!1,repoQueryAuthToken:""},autoBranch:!R||"create"===e4,baseBranch:R?.branch??eT,forceVmBackend:void 0,forceCluster:void 0,conversationHistory:[{text:ew,richText:eN||ew,capabilityContexts:[],type:D.Jc.HUMAN,images:e7}],images:[],documentationIdentifiers:[],externalLinks:[],addInitialMessageToResponses:!0,promptGroupId:f,testModeEnabled:ex},n=new p.px(t);console.log(`Sending background composer request for model ${o} (instance ${s+1}):`,t);let l=await fetch("/api/auth/startBackgroundComposerFromSnapshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.toJson()),signal:c.signal});if(!l.ok){let e=await l.json();if(e?.error?.details?.some(e=>"ERROR_USAGE_PRICING_REQUIRED_CHANGEABLE"===e.error))return console.log("Usage pricing required error:",e),$(!0),a=!0,{modelName:o,error:Error("Payment error"),success:!1,paymentError:!0,bcId:r,instanceIndex:s};if(e?.error?.details?.some(e=>"ERROR_BAD_REQUEST"===e.error&&e.details?.detail?.includes("Free trial usage limit reached")))return console.log("Free trial usage limit reached error:",e),_(!0),a=!0,{modelName:o,error:Error("Payment error"),success:!1,paymentError:!0,bcId:r,instanceIndex:s};let t=e?.error?.details?.find(e=>"ERROR_UNAUTHORIZED"===e.error);if(t){if((t.details?.detail||"").includes("Please contact your team admin"))return console.log("Team admin restriction error:",e),(0,M.Ej)({message:"Your team has restricted Cloud Agent usage.",description:"Please contact your team admin to be added to the allowlist or removed from the blocklist.",duration:1e4}),O(r),a=!0,{modelName:o,error:Error("Team admin restriction"),success:!1,teamAdminError:!0,bcId:r,instanceIndex:s,hasToast:!0};return console.log("Pro subscription required error:",e),_(!0),a=!0,{modelName:o,error:Error("Payment error"),success:!1,paymentError:!0,bcId:r,instanceIndex:s}}if(e?.error?.details?.some(e=>"ERROR_BAD_REQUEST"===e.error&&e.details?.detail?.includes("Git Repository is empty")))return console.log("Empty repository error:",e),(0,M.Ej)("This repository is empty. Please commit a file before running Agent."),a=!0,{modelName:o,error:Error("Empty repository"),success:!1,emptyRepoError:!0,bcId:r,instanceIndex:s,hasToast:!0};throw Error(`HTTP error for model ${o}! status: ${l.status}`)}let i=await l.json();if(console.log(`Background composer response for model ${o}:`,i),i.wasSwappedToDefault){console.log(`Model ${o} was swapped to auto/default`),th()?(0,M.im)({message:"Running on Auto",description:"Usage limits reached. This Agent is running on Auto for free.",duration:4e3}):(H(!0),tf());let t=g.find(e=>e.bcId===r);t&&(O(r),U(t,{promptText:ew,modelDetails:new el.Gm({modelName:"default",maxMode:!1}),images:e})),o="default"}return{modelName:o,result:i,success:!0,bcId:r,instanceIndex:s}}catch(e){if(e instanceof Error&&"AbortError"===e.name)return console.log(`Background composer request for model ${o} was cancelled`),O(r),{modelName:o,error:e,success:!1,aborted:!0,bcId:r,instanceIndex:s};return console.error(`Error creating background composer for model ${o} (bcId: ${r}):`,e),O(r),{modelName:o,error:e,success:!1,bcId:r,instanceIndex:s}}}),n=await Promise.all(r),i=n.filter(e=>e.success&&!e.aborted),u=n.filter(e=>!e.success&&!e.aborted);if(i.length>0){let e=1===i.length?"cloud agent":`${i.length} cloud agents`,t=i.map(e=>e.bcId).filter(e=>!!e)[0],r=(e,t=0)=>{if(t>5)return;let s=document.getElementById(`composer-${e}`);if(s)return void s.scrollIntoView({behavior:"smooth",block:"center"});setTimeout(()=>r(e,t+1),200)};(0,M.xj)({message:`Launched ${e}`,icon:(0,s.jsx)(er,{className:"h-4 w-4 animate-spin-slow"}),onClick:t?()=>{t&&(z(t),r(t))}:void 0,duration:6e3})}else(a||u.length>0)&&!o&&(tm(ew,eN,e,t),o=!0);let x=u.some(e=>e.hasToast);u.length>0&&0===i.length&&!x&&(0,M.Ej)("Failed to create agents."),L()}catch(r){r instanceof Error&&"AbortError"===r.name?console.log("Background composer request was cancelled"):(console.error("Error creating background composer:",r),(0,M.Ej)("Failed to create agents.")),g.forEach(e=>{O(e.bcId)}),r instanceof Error&&"AbortError"===r.name||o||(tm(ew,eN,e,t),o=!0)}finally{eE(!1),eR(null)}return!1},tx=(0,d.useCallback)(async()=>{if(eA&&eA.abort(),N?.composer?.bcId){let e=N.composer.bcId,t=N.composer.status;F(e,p.R6.FINISHED);try{let r=await fetch("/api/background-composer/pause",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e})});r.ok||(F(e,t),console.error(`Failed to pause background composer: ${r.status} ${r.statusText}`))}catch(r){F(e,t),console.error("Error pausing background composer:",r)}}},[eA,N,F]);(0,d.useEffect)(()=>{if(tt.size>0){let e=Array.from(tt).sort((e,t)=>t-e);te(t=>{let r=[...t];return e.forEach(e=>{e>=0&&e<r.length&&(r.splice(e,1),(0,M.Ej)(`Failed to display image ${e+1}. Removing from selection.`))}),r}),tr(new Set)}},[tt]);let th=()=>{try{return"true"===localStorage.getItem("auto-model-modal-seen")}catch(e){return console.warn("Failed to read auto model modal state from localStorage:",e),!1}},tf=(0,d.useCallback)(()=>{try{localStorage.setItem("auto-model-modal-seen","true")}catch(e){console.warn("Failed to save auto model modal state to localStorage:",e)}},[]);return(0,s.jsxs)("div",{className:x?"relative":"flex flex-col",children:[x&&(eO===p.R6.RUNNING||eO===p.R6.CREATING)&&(0,s.jsxs)("div",{className:"absolute z-10 flex items-center justify-between rounded-t-lg border border-b-0 border-white/5 bg-[#1B1D21] px-3 py-1.5",style:{width:"calc(100% - 22px)",left:"10px",top:"-28.8px"},children:[(0,s.jsxs)("span",{className:"text-[11px] font-medium text-white/60",children:["Generating",(0,s.jsx)(es.X,{})]}),(0,s.jsx)("button",{onClick:v||tx,className:"text-[11px] font-medium text-white/60 transition-colors hover:text-white/80",children:"Stop"})]}),(0,s.jsx)("div",{className:x?`flex min-h-[60px] w-full flex-col rounded-xl bg-[var(--color-theme-bg-card-02)] ${eS?"cursor-pointer hover:bg-[#212326]":"cursor-text"}`:`flex w-full flex-col bg-[var(--color-theme-bg-card-02)] shadow-sm border-theme-border-02 overflow-hidden rounded-xl border ${eS?"cursor-pointer hover:bg-[#212326]":"cursor-text"}`,style:x?{border:"1px solid rgba(255, 255, 255, 0.08)"}:{},onClick:e=>{!eS&&(e.target.closest('button, input, textarea, select, [role="menu"], [role="listbox"], [role="dialog"], [data-prevent-editor-focus]')||ek?.focus())},children:(0,s.jsx)(eb.A,{ref:tn,onSend:tp,placeholder:f||"Ask Cursor to build, fix bugs, explore",autoFocus:!eo,onEditorReady:e=>eI(e),onTextChange:e=>{ej(e),eC(e)},onImageSelect:e=>tu(e),frameless:!0,isFollowUp:x,selectedModels:eF,modelCounts:eW,onModelSelect:tl,onModelDropdownOpenChange:e=>eZ(e),hideDropdowns:g||!eK,disableMultipleModelsToggle:e8,multipleModelsDisabledTooltip:e9,className:"px-0",showTestModeCheckbox:!!(ep&&!x&&(!N||!N.prompt||0===N.prompt.conversationHistory.length)),testModeEnabled:ex,onTestModeChange:eh})}),!x&&!g&&(0,s.jsx)("div",{className:"mt-2 px-3 flex flex-wrap items-center gap-x-4 gap-y-2 min-h-[32px]","data-prevent-editor-focus":!0,children:eL&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eY,{selectedRepo:eM,onRepoSelect:ti,className:"text-theme-text-secondary",hasCachedData:!!eM,onOpenChange:e=>e0(e),largeFonts:!0}),eM&&(0,s.jsx)(em.U,{selectedRepo:eM,selectedBranch:eT,onBranchSelect:tc,className:"text-theme-text-secondary",hasCachedData:!!eT,onOpenChange:e=>e2(e)}),R&&eM?(0,s.jsx)(eg,{selectedOption:e4,onOptionSelect:e=>e6(e)}):null,e_&&(0,s.jsx)(ez,{disabled:eS,onOpenChange:e=>e3(e)})]})}),eo?(0,s.jsx)(eG,{showAutoModelModal:G,setShowAutoModelModal:H,onEditLimits:()=>{H(!1),$(!0)},onContinueWithAuto:()=>{H(!1)}}):(0,s.jsx)(ev,{showAutoModelModal:G,setShowAutoModelModal:H,onEditLimits:()=>{H(!1),$(!0)},onContinueWithAuto:()=>{H(!1)}})]})}var e1=r(58910);function e2({open:e,composerId:t,onClose:r,onCopy:o,onDelete:a,copied:n,triggerRef:l}){let[i,c]=(0,d.useState)(!1),[u,m]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{if(e){m(!0);let e=setTimeout(()=>c(!0),10);return()=>clearTimeout(e)}{c(!1);let e=setTimeout(()=>m(!1),150);return()=>clearTimeout(e)}},[e]),u)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-40 cursor-default",onMouseDown:r}),(0,s.jsxs)(ef.W1,{open:e,onClose:r,align:"right",minWidth:170,offsetX:4,topFull:!1,top:28,zIndex:50,origin:"top-right",triggerRef:l,children:[(0,s.jsx)(ef.Dr,{icon:n?(0,s.jsx)(F.A,{}):(0,s.jsx)(z.A,{}),label:"Copy request ID",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),o()}}),(0,s.jsx)(ef.Dr,{icon:(0,s.jsx)(e1.A,{}),label:"Delete agent",type:"destructive",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),a()}})]})]}):null}var e5=r(30654);function e3({className:e}){return(0,s.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`${e} icon-generating`,style:{transformOrigin:"center center"},children:(0,s.jsx)("path",{d:"M8.86853 3.94922C8.70903 3.94922 8.57003 3.88997 8.45154 3.77148C8.33305 3.65299 8.2738 3.51172 8.2738 3.34766V1.24219C8.2738 1.07812 8.33305 0.936849 8.45154 0.818359C8.57003 0.69987 8.70903 0.640625 8.86853 0.640625C9.03259 0.640625 9.17387 0.69987 9.29236 0.818359C9.41085 0.936849 9.47009 1.07812 9.47009 1.24219V3.34766C9.47009 3.51172 9.41085 3.65299 9.29236 3.77148C9.17387 3.88997 9.03259 3.94922 8.86853 3.94922ZM11.7806 5.15234C11.6667 5.03841 11.6097 4.89714 11.6097 4.72852C11.6097 4.5599 11.6667 4.41862 11.7806 4.30469L13.2777 2.82129C13.3916 2.70736 13.5306 2.65039 13.6947 2.65039C13.8633 2.65039 14.0046 2.70736 14.1185 2.82129C14.2325 2.93522 14.2894 3.0765 14.2894 3.24512C14.2894 3.40918 14.2325 3.54818 14.1185 3.66211L12.6283 5.15234C12.5144 5.26628 12.3731 5.32324 12.2045 5.32324C12.0358 5.32324 11.8946 5.26628 11.7806 5.15234ZM12.9906 8.06445C12.9906 7.90039 13.0498 7.76139 13.1683 7.64746C13.2868 7.52897 13.4258 7.46973 13.5853 7.46973H15.6908C15.8549 7.46973 15.9961 7.52897 16.1146 7.64746C16.2331 7.76139 16.2924 7.90039 16.2924 8.06445C16.2924 8.22396 16.2331 8.36296 16.1146 8.48145C15.9961 8.59993 15.8549 8.65918 15.6908 8.65918H13.5853C13.4258 8.65918 13.2868 8.59993 13.1683 8.48145C13.0498 8.36296 12.9906 8.22396 12.9906 8.06445ZM11.7806 10.9697C11.8946 10.8558 12.0358 10.7988 12.2045 10.7988C12.3731 10.7988 12.5144 10.8558 12.6283 10.9697L14.1185 12.4668C14.2325 12.5807 14.2894 12.722 14.2894 12.8906C14.2894 13.0547 14.2325 13.1937 14.1185 13.3076C14.0046 13.4215 13.8633 13.4785 13.6947 13.4785C13.5306 13.4785 13.3916 13.4215 13.2777 13.3076L11.7806 11.8174C11.6667 11.7035 11.6097 11.5622 11.6097 11.3936C11.6097 11.2249 11.6667 11.0837 11.7806 10.9697ZM8.86853 12.1797C9.03259 12.1797 9.17387 12.2389 9.29236 12.3574C9.41085 12.4759 9.47009 12.6149 9.47009 12.7744V14.8867C9.47009 15.0462 9.41085 15.1852 9.29236 15.3037C9.17387 15.4222 9.03259 15.4814 8.86853 15.4814C8.70903 15.4814 8.57003 15.4222 8.45154 15.3037C8.33305 15.1852 8.2738 15.0462 8.2738 14.8867V12.7744C8.2738 12.6149 8.33305 12.4759 8.45154 12.3574C8.57003 12.2389 8.70903 12.1797 8.86853 12.1797ZM5.96326 10.9697C6.07719 11.0837 6.13416 11.2249 6.13416 11.3936C6.13416 11.5622 6.07719 11.7035 5.96326 11.8174L4.46619 13.3076C4.35225 13.4215 4.21098 13.4785 4.04236 13.4785C3.8783 13.4785 3.7393 13.4215 3.62537 13.3076C3.51143 13.1937 3.45447 13.0547 3.45447 12.8906C3.45447 12.722 3.51143 12.5807 3.62537 12.4668L5.1156 10.9697C5.22953 10.8558 5.37081 10.7988 5.53943 10.7988C5.70805 10.7988 5.84932 10.8558 5.96326 10.9697ZM4.7533 8.06445C4.7533 8.22396 4.69405 8.36296 4.57556 8.48145C4.45707 8.59993 4.31807 8.65918 4.15857 8.65918H2.04626C1.88676 8.65918 1.74776 8.59993 1.62927 8.48145C1.51078 8.36296 1.45154 8.22396 1.45154 8.06445C1.45154 7.90039 1.51078 7.76139 1.62927 7.64746C1.74776 7.52897 1.88676 7.46973 2.04626 7.46973H4.15857C4.31807 7.46973 4.45707 7.52897 4.57556 7.64746C4.69405 7.76139 4.7533 7.90039 4.7533 8.06445ZM5.96326 5.15234C5.84932 5.26628 5.70805 5.32324 5.53943 5.32324C5.37081 5.32324 5.22953 5.26628 5.1156 5.15234L3.62537 3.66211C3.51143 3.54818 3.45447 3.40918 3.45447 3.24512C3.45447 3.0765 3.51143 2.93522 3.62537 2.82129C3.7393 2.70736 3.8783 2.65039 4.04236 2.65039C4.21098 2.65039 4.35225 2.70736 4.46619 2.82129L5.96326 4.30469C6.07719 4.41862 6.13416 4.5599 6.13416 4.72852C6.13416 4.89714 6.07719 5.03841 5.96326 5.15234Z",fill:"currentColor"})})}function e4({className:e}){return(0,s.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,children:(0,s.jsx)("path",{d:"M8.87537 15.0371C7.91378 15.0371 7.01143 14.8548 6.16833 14.4902C5.32524 14.1302 4.58468 13.6312 3.94666 12.9932C3.30863 12.3551 2.80733 11.6146 2.44275 10.7715C2.08272 9.92839 1.90271 9.02604 1.90271 8.06445C1.90271 7.10286 2.08272 6.20052 2.44275 5.35742C2.80733 4.51432 3.30863 3.77376 3.94666 3.13574C4.58468 2.49316 5.32524 1.99186 6.16833 1.63184C7.01143 1.27181 7.91378 1.0918 8.87537 1.0918C9.83695 1.0918 10.7393 1.27181 11.5824 1.63184C12.4255 1.99186 13.1661 2.49316 13.8041 3.13574C14.4421 3.77376 14.9411 4.51432 15.3011 5.35742C15.6657 6.20052 15.848 7.10286 15.848 8.06445C15.848 9.02604 15.6657 9.92839 15.3011 10.7715C14.9411 11.6146 14.4421 12.3551 13.8041 12.9932C13.1661 13.6312 12.4255 14.1302 11.5824 14.4902C10.7393 14.8548 9.83695 15.0371 8.87537 15.0371ZM8.87537 13.875C9.67745 13.875 10.4294 13.7246 11.1312 13.4238C11.833 13.123 12.4506 12.7061 12.9838 12.1729C13.517 11.6396 13.934 11.0221 14.2347 10.3203C14.5355 9.61849 14.6859 8.86654 14.6859 8.06445C14.6859 7.26237 14.5355 6.51042 14.2347 5.80859C13.934 5.10221 13.517 4.4847 12.9838 3.95605C12.4506 3.42285 11.833 3.00586 11.1312 2.70508C10.4294 2.4043 9.67745 2.25391 8.87537 2.25391C8.07328 2.25391 7.32133 2.4043 6.61951 2.70508C5.91768 3.00586 5.30017 3.42285 4.76697 3.95605C4.23376 4.4847 3.81677 5.10221 3.51599 5.80859C3.21521 6.51042 3.06482 7.26237 3.06482 8.06445C3.06482 8.86654 3.21521 9.61849 3.51599 10.3203C3.81677 11.0221 4.23376 11.6396 4.76697 12.1729C5.30017 12.7061 5.91768 13.123 6.61951 13.4238C7.32133 13.7246 8.07328 13.875 8.87537 13.875ZM8.86853 9.29492C8.51762 9.29492 8.33761 9.11491 8.32849 8.75488L8.23962 5.13867C8.23507 4.96549 8.28975 4.82194 8.40369 4.70801C8.52218 4.59408 8.67485 4.53711 8.86169 4.53711C9.04399 4.53711 9.19438 4.59635 9.31287 4.71484C9.43591 4.82878 9.49516 4.97233 9.4906 5.14551L9.38806 8.75488C9.3835 9.11491 9.21033 9.29492 8.86853 9.29492ZM8.86853 11.5166C8.66801 11.5166 8.49483 11.4482 8.349 11.3115C8.20317 11.1702 8.13025 11.0016 8.13025 10.8057C8.13025 10.6097 8.20317 10.4434 8.349 10.3066C8.49483 10.1654 8.66801 10.0947 8.86853 10.0947C9.06905 10.0947 9.24223 10.1631 9.38806 10.2998C9.53389 10.4365 9.60681 10.6051 9.60681 10.8057C9.60681 11.0062 9.53162 11.1748 9.38123 11.3115C9.23539 11.4482 9.06449 11.5166 8.86853 11.5166Z",fill:"currentColor"})})}var e6=r(83601);function e8({className:e}){return(0,s.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,children:(0,s.jsx)("path",{d:"M8.87537 15.0371C7.91378 15.0371 7.01143 14.8548 6.16833 14.4902C5.32524 14.1302 4.58468 13.6312 3.94666 12.9932C3.30863 12.3551 2.80733 11.6146 2.44275 10.7715C2.08272 9.92839 1.90271 9.02604 1.90271 8.06445C1.90271 7.10286 2.08272 6.20052 2.44275 5.35742C2.80733 4.51432 3.30863 3.77376 3.94666 3.13574C4.58468 2.49316 5.32524 1.99186 6.16833 1.63184C7.01143 1.27181 7.91378 1.0918 8.87537 1.0918C9.83695 1.0918 10.7393 1.27181 11.5824 1.63184C12.4255 1.99186 13.1661 2.49316 13.8041 3.13574C14.4421 3.77376 14.9411 4.51432 15.3011 5.35742C15.6657 6.20052 15.848 7.10286 15.848 8.06445C15.848 9.02604 15.6657 9.92839 15.3011 10.7715C14.9411 11.6146 14.4421 12.3551 13.8041 12.9932C13.1661 13.6312 12.4255 14.1302 11.5824 14.4902C10.7393 14.8548 9.83695 15.0371 8.87537 15.0371ZM8.87537 13.875C9.67745 13.875 10.4294 13.7246 11.1312 13.4238C11.833 13.123 12.4506 12.7061 12.9838 12.1729C13.517 11.6396 13.934 11.0221 14.2347 10.3203C14.5355 9.61849 14.6859 8.86654 14.6859 8.06445C14.6859 7.26237 14.5355 6.51042 14.2347 5.80859C13.934 5.10221 13.517 4.4847 12.9838 3.95605C12.4506 3.42285 11.833 3.00586 11.1312 2.70508C10.4294 2.4043 9.67745 2.25391 8.87537 2.25391C8.07328 2.25391 7.32133 2.4043 6.61951 2.70508C5.91768 3.00586 5.30017 3.42285 4.76697 3.95605C4.23376 4.4847 3.81677 5.10221 3.51599 5.80859C3.21521 6.51042 3.06482 7.26237 3.06482 8.06445C3.06482 8.86654 3.21521 9.61849 3.51599 10.3203C3.81677 11.0221 4.23376 11.6396 4.76697 12.1729C5.30017 12.7061 5.91768 13.123 6.61951 13.4238C7.32133 13.7246 8.07328 13.875 8.87537 13.875ZM8.12341 11.3047C8.00948 11.3047 7.90466 11.2796 7.80896 11.2295C7.71781 11.1794 7.62895 11.0996 7.54236 10.9902L5.87439 8.93945C5.76957 8.79818 5.71716 8.6569 5.71716 8.51562C5.71716 8.36523 5.76729 8.23763 5.86755 8.13281C5.97237 8.02344 6.0977 7.96875 6.24353 7.96875C6.33923 7.96875 6.42582 7.98926 6.5033 8.03027C6.58533 8.06673 6.66736 8.13965 6.74939 8.24902L8.09607 9.99219L10.933 5.43945C11.0606 5.23438 11.2201 5.13184 11.4115 5.13184C11.5528 5.13184 11.6804 5.17741 11.7943 5.26855C11.9082 5.3597 11.9652 5.48047 11.9652 5.63086C11.9652 5.70833 11.947 5.78581 11.9105 5.86328C11.8786 5.9362 11.8422 6.00456 11.8011 6.06836L8.67712 10.9902C8.54041 11.1999 8.35583 11.3047 8.12341 11.3047Z",fill:"#6B7280"})})}function e9({status:e,className:t,isArchived:r=!1}){let o=(0,d.useMemo)(()=>e,[e]);return r?(0,s.jsx)(e8,{className:t}):o===p.R6.RUNNING||o===p.R6.CREATING?(0,s.jsx)(er,{className:`${t}`}):o===p.R6.FINISHED||o===p.R6.UNSPECIFIED?(0,s.jsx)(e6.A,{className:t}):o===p.R6.ERROR||o===p.R6.EXPIRED?(0,s.jsx)(e4,{className:`${t} !text-orange-600 dark:!text-orange-400`}):(0,s.jsx)(e3,{className:t})}function e7({tabs:e,activeTabId:t,onChange:r,className:o}){return(0,s.jsx)("div",{className:o??"",children:(0,s.jsx)("div",{className:"relative z-0 inline-flex w-full",children:(0,s.jsx)("ul",{className:"px-2 relative grid grid-cols-[repeat(auto-fill,minmax(155px,1fr))] w-full items-stretch gap-2 overflow-hidden bg-transparent",children:e.map(e=>(0,s.jsx)("li",{className:"flex flex-1",children:(0,s.jsxs)("button",{onMouseDown:()=>r(e.id),className:`relative flex w-full flex-col items-start gap-1 rounded-md border border-theme-border-02 px-3 py-2 text-left transition-all ${t===e.id?"bg-theme-card-02-hex border-theme-border-03":"bg-theme-card-03-hex"}`,children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-2 text-theme-text-primary",children:[(0,s.jsx)("div",{className:"web-text-base font-medium leading-tight truncate ",children:e.label}),e.statusIcon&&(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center -mt-[1px] text-theme-text-secondary",children:e.statusIcon})]}),e.subtitle&&(0,s.jsx)("div",{className:"text-xs leading-tight text-theme-text-secondary truncate w-[100%]",children:e.subtitle})]})},e.id))})})})}var te=r(7464),tt=r(79020),tr=r(20143),ts=r(10364),to=r(90331),ta=r(85648),tn=r(81001),tl=r(62230),ti=r(78968);let tc=[{name:"list",displayName:"List",icon:(0,s.jsx)(tt.A,{className:"h-3 w-3"})},{name:"full",displayName:"Full",icon:(0,s.jsx)(tr.A,{className:"h-3 w-3"})}];function td({activeViewMode:e,onViewModeChange:t}){let r=(0,S.o)(),o=(0,d.useRef)(null),a=(0,d.useRef)(null),[n,l]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let t=()=>{let t=o.current;if(e&&t){let e=a.current;if(e&&t.offsetWidth>0){let{offsetLeft:r,offsetWidth:s}=e,o=(r/t.offsetWidth*100).toFixed(),a=(100-(r+s)/t.offsetWidth*100).toFixed();t.style.clipPath=`inset(0 ${a}% 0 ${o}% round 6px)`}}},r=requestAnimationFrame(()=>{t(),l(!0)});return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),cancelAnimationFrame(r)}},[e]),(0,s.jsxs)("div",{className:"relative flex w-[213px] flex-col items-center",children:[(0,s.jsx)("ul",{className:"relative flex w-full justify-end",children:tc.map(o=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{ref:e===o.name?a:null,"data-tab":o.name,onClick:()=>t(o.name),className:`flex ${r?"h-[32px] text-[13px]":"h-[22px] text-[12px]"} items-center gap-2 rounded px-2 font-medium text-theme-text-secondary no-underline`,children:[o.icon,o.displayName]})},o.name))}),(0,s.jsx)("div",{"aria-hidden":!0,className:`absolute z-10 w-[213px] overflow-hidden ${n?"duration-250 transition-all ease-in-out":""}`,ref:o,style:{clipPath:"inset(0px 75% 0px 0% round 3px)"},children:(0,s.jsx)("ul",{className:"relative flex w-full justify-end bg-theme-bg-hex",children:tc.map(e=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{"data-tab":e.name,onClick:()=>t(e.name),className:`flex ${r?"h-[32px] text-[13px]":"h-[22px] text-[12px]"} items-center gap-2 rounded px-2 font-medium text-white no-underline`,tabIndex:-1,children:[e.icon,e.displayName]})},e.name))})})]})}function tu({viewConfig:e,onViewConfigChange:t}){(0,S.o)();let[r,o]=(0,d.useState)(!1),[a,n]=(0,d.useState)("left"),[l,i]=(0,d.useState)(!1),c=(0,d.useRef)(null);(0,d.useEffect)(()=>{i(!0)},[]);let u=()=>{n("left")},m=()=>o(!1);return(0,d.useEffect)(()=>{let e=()=>{r&&u()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[r]),(0,ti.vC)("esc",()=>{r&&m()}),(0,s.jsxs)(s.Fragment,{children:[r&&l&&(0,eR.createPortal)((0,s.jsx)("div",{className:"fixed inset-0 z-[999] cursor-default",onClick:m}),document.body),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{ref:c,onClick:()=>{r||u(),o(e=>!e)},type:"button",className:"flex items-center rounded-md p-1 outline-none transition-all duration-200 hover:bg-white/5 focus:outline-none",children:(0,s.jsx)(ts.A,{className:"h-3 w-3 text-theme-text-secondary"})}),(0,s.jsxs)(ef.W1,{open:r,onClose:m,align:a,width:"full"===e.viewMode?230:300,zIndex:1e3,backdrop:!1,triggerRef:c,children:[(0,s.jsxs)("div",{className:"flex h-[36px] w-full flex-row items-center justify-between px-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eS.A,{className:"h-3 w-3 text-theme-text-secondary"}),(0,s.jsx)("span",{className:"text-[12px] font-semibold text-theme-text-secondary",children:"Group"})]}),(0,s.jsx)("select",{value:e.groupBy||"",onChange:r=>{var s;return s=r.target.value||null,void t({...e,groupBy:s})},onClick:e=>e.stopPropagation(),className:"w-[142px] rounded-[4px] border border-theme-border-02 bg-transparent px-[6px] py-[3px] text-[12px] text-theme-text-primary transition-colors focus:outline-none focus:ring-0",style:{colorScheme:"dark"},children:[{id:null,name:"Date"},{id:"status",name:"Status"},{id:"repo",name:"Repo"},{id:"model",name:"Model"},{id:"merge",name:"Merge"},{id:"prompt",name:"Prompt"}].map(e=>(0,s.jsx)("option",{value:e.id||"",style:{colorScheme:"dark"},children:e.name},e.id||"date"))})]}),(0,s.jsxs)("div",{className:"flex h-[36px] w-full flex-row items-center justify-between px-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(to.A,{className:"h-3 w-3 text-theme-text-secondary"}),(0,s.jsx)("span",{className:"text-[12px] font-semibold text-theme-text-secondary",children:"Sort"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("select",{value:e.sortBy||"date",onChange:r=>t({...e,sortBy:r.target.value||"date"}),onClick:e=>e.stopPropagation(),className:"w-[114px] rounded-[4px] border border-theme-border-02 bg-transparent px-[6px] py-[3px] text-[12px] text-theme-text-primary transition-colors focus:outline-none focus:ring-0",style:{colorScheme:"dark"},children:[(0,s.jsx)("option",{value:"date",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Date"}),(0,s.jsx)("option",{value:"status",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Status"}),(0,s.jsx)("option",{value:"name",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Name"}),(0,s.jsx)("option",{value:"model",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Model"}),(0,s.jsx)("option",{value:"repo",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Repo"}),(0,s.jsx)("option",{value:"branch",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Branch"})]}),(0,s.jsx)("button",{onClick:r=>{r.stopPropagation(),t({...e,sortDirection:"asc"===e.sortDirection?"desc":"asc"})},type:"button",className:"rounded-[4px] p-1 transition-all duration-200 hover:bg-white/5",children:"asc"===e.sortDirection?(0,s.jsx)(ta.A,{className:"h-4 w-4 text-theme-text-secondary"}):(0,s.jsx)(tn.A,{className:"h-4 w-4 text-theme-text-secondary"})})]})]}),"full"!==e.viewMode&&(0,s.jsxs)("div",{className:"flex h-[36px] w-full flex-row items-center justify-between px-2",onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(tl.A,{className:"h-3 w-3 text-theme-text-secondary"}),(0,s.jsx)("span",{className:"text-[12px] font-semibold text-theme-text-secondary",children:"Layout"})]}),(0,s.jsx)(td,{activeViewMode:e.viewMode||"list",onViewModeChange:r=>{t({...e,viewMode:r})}})]}),!(()=>{let t=(0,N.id)();return e.groupBy===t&&(e.viewMode===N.e8||void 0===e.viewMode)&&"date"===e.sortBy&&"desc"===e.sortDirection&&e.properties.every(e=>{let t=N.gm.find(t=>t.id===e.id);return!!t&&e.visible===t.visible&&e.order===t.order&&e.row===t.row})})()&&(0,s.jsx)("div",{className:"border-t border-theme-border-02 pt-1",children:(0,s.jsx)(ef.Dr,{label:(0,s.jsx)("span",{className:"!text-xs",children:"Reset"}),onClick:e=>{e.stopPropagation(),localStorage.removeItem("agent-view-config"),t({groupBy:(0,N.id)(),properties:[...N.gm],viewMode:N.e8,sortBy:"date",sortDirection:"desc"})}})})]})]})]})}var tm=r(75249);let tp={normal:{rotate:0},animate:{rotate:180}},tx=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),(0,s.jsx)("path",{d:"M4.677 21.5a2 2 0 0 0 1.313.5H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2.5"}),(0,s.jsxs)(Z.P.g,{transition:{type:"spring",stiffness:50,damping:10},variants:tp,animate:l,children:[(0,s.jsx)("path",{d:"m3.2 12.9-.9-.4"}),(0,s.jsx)("path",{d:"m3.2 15.1-.9.4"}),(0,s.jsx)("path",{d:"m4.9 11.2-.4-.9"}),(0,s.jsx)("path",{d:"m4.9 16.8-.4.9"}),(0,s.jsx)("path",{d:"m7.5 10.3-.4.9"}),(0,s.jsx)("path",{d:"m7.5 17.7-.4-.9"}),(0,s.jsx)("path",{d:"m9.7 12.5-.9.4"}),(0,s.jsx)("path",{d:"m9.7 15.5-.9-.4"}),(0,s.jsx)("circle",{cx:"6",cy:"14",r:"3"})]})]})})});tx.displayName="FileCogIcon";let th={normal:{rotate:0,x:0,y:0},animate:{rotate:[0,0,8,-3,8,0],x:[0,2,0,-1,0]}},tf={normal:{pathLength:1,opacity:1,pathOffset:0},animate:{pathLength:[0,0,1],opacity:[0,1],pathOffset:[0,1,0]}},tg=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsxs)(Z.P.svg,{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",variants:th,transition:{duration:1},animate:l,children:[(0,s.jsx)("path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z"}),(0,s.jsx)("path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18"}),(0,s.jsx)(Z.P.path,{variants:tf,animate:l,transition:{duration:.8},d:"m2.3 2.3 7.286 7.286"}),(0,s.jsx)("circle",{cx:"11",cy:"11",r:"2"})]})})});tg.displayName="PenToolIcon";let tb={normal:{x:0,y:0},animate:{x:[0,0,-3,2,-2,1,-1,0],y:[0,-3,0,-2,-3,-1,-2,0],transition:{duration:6,ease:"easeInOut",repeat:1/0,repeatType:"reverse",times:[0,.15,.3,.45,.6,.75,.9,1]}}},tv={normal:{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"},animate:{d:["M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-3 5.5-3 5.5s4.74-1 6-2.5c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2.2 4.8-2.2 4.8s3.94-0.3 5.2-1.8c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2.8 5.2-2.8 5.2s4.54-0.7 5.8-2.2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"],transition:{duration:2,ease:[.4,0,.2,1],repeat:1/0,times:[0,.2,.5,.8,1]}}},ty=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsxs)(Z.P.svg,{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",variants:tb,animate:l,children:[(0,s.jsx)(Z.P.path,{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",variants:tv,animate:l}),(0,s.jsx)("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),(0,s.jsx)("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),(0,s.jsx)("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]})})});function tw({onChipClick:e}){let t=(0,S.o)(),r=(0,d.useRef)(null),o=(0,d.useRef)(null),a=(0,d.useRef)(null),n=[{icon:(0,s.jsx)(tg,{ref:r,size:16}),text:"Write documentation",prompt:"Generate comprehensive documentation for all public APIs, functions, and components. Include examples and usage instructions."},{icon:(0,s.jsx)(ty,{ref:o,size:16}),text:"Optimize performance",prompt:"Analyze the codebase for performance bottlenecks and optimize them. Focus on bundle size, load times, and optimizations."},{icon:(0,s.jsx)(tx,{ref:a,size:16}),text:"Find and fix 3 bugs",prompt:"Find and fix 3 bugs in the codebase, such as logic errors, performance issues, or security vulnerabilities. Provide a detailed explanation of the bug and the fix."}],l=[r,o,a];return(0,s.jsxs)("div",{className:t?"mt-0":"mt-12",children:[(0,s.jsx)("div",{className:"mb-3 text-center web-text-base text-theme-text-secondary",children:"Try these examples to get started"}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:n.map((t,r)=>(0,s.jsxs)("button",{onClick:()=>e(t.prompt),onMouseEnter:()=>{l[r]?.current?.startAnimation()},onMouseLeave:()=>{l[r]?.current?.stopAnimation()},className:"group flex items-center gap-2 rounded-full border border-theme-border-02 px-3 py-2 web-text-base text-theme-text-secondary transition-all duration-200 animate-in fade-in slide-in-from-bottom-2 [animation-fill-mode:forwards] hover:border-theme-border-01 hover:text-theme-text-primary hover:bg-[var(--color-theme-bg-card-hover)]",style:{animationDelay:`${100*r}ms`,animationDuration:"400ms"},children:[(0,s.jsx)("span",{className:"text-theme-text-secondary transition-colors group-hover:text-theme-text-primary fill-theme-text fill-theme-text-sec ",children:t.icon}),(0,s.jsx)("span",{children:t.text})]},r))})]})}ty.displayName="RocketIcon";let tj=e=>e[Math.floor(Math.random()*e.length)],tN=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,tC=["⣾","⣽","⣻","⢿","⡿","⣟","⣯","⣷"],tk=[{text:"┌─ Initializing secure container environment",delay:300,color:"#88c0d0"},{text:"│ ▶ Starting virtualization layer...",delay:600,isRandom:!0,variants:["│ ▶ Starting virtualization layer...","│ ▶ Initializing container runtime...","│ ▶ Setting up isolated environment..."]},{text:"│ ✓ Container runtime ready",delay:900,color:"#a3be8c"},{text:"└─ Environment secure",delay:1100,color:"#a3be8c"},{text:"",delay:1200},{text:"┌─ Setting up file system",delay:1300,color:"#88c0d0"},{text:"│ ▣ Creating workspace directories...",delay:1500,isRandom:!0,variants:["│ ▣ Creating workspace directories...","│ ▣ Preparing project structure...","│ ▣ Setting up workspace..."]},{text:"│ ■ Applying permissions...",delay:1700,isRandom:!0,variants:["│ ■ Applying permissions...","│ ■ Configuring access control...","│ ■ Setting security policies..."]},{text:"│ ✓ File system ready",delay:1900,color:"#a3be8c"},{text:"└─ Workspace configured",delay:2e3,color:"#a3be8c"},{text:"",delay:2100},{text:"┌─ Downloading base environment",delay:2200,color:"#88c0d0"},{text:"│ ▦ Fetching image layers...",delay:2400,isRandom:!0,variants:["│ ▦ Fetching image layers...","│ ▦ Downloading container image...","│ ▦ Pulling runtime environment..."]},{text:"│ [████░░░░░░░░░░░░░░░░] Progress: 20%",delay:2600,color:"#ebcb8b",isProgress:!0,progressSteps:["│ [░░░░░░░░░░░░░░░░░░░░] Progress: 0%","│ [██░░░░░░░░░░░░░░░░░░] Progress: 10%","│ [████░░░░░░░░░░░░░░░░] Progress: 20%","│ [██████░░░░░░░░░░░░░░] Progress: 30%","│ [████████░░░░░░░░░░░░] Progress: 40%","│ [██████████░░░░░░░░░░] Progress: 50%","│ [████████████░░░░░░░░] Progress: 60%","│ [██████████████░░░░░░] Progress: 70%","│ [████████████████░░░░] Progress: 80%","│ [██████████████████░░] Progress: 90%","│ [████████████████████] Progress: 100%"]},{text:"│ ✓ Environment image downloaded",delay:3800,color:"#a3be8c"},{text:"└─ Image ready for deployment",delay:3900,color:"#a3be8c"},{text:"",delay:4e3},{text:"┌─ Installing dependencies",delay:4100,color:"#88c0d0"},{text:"│ ◉ Reading package.json...",delay:4300,isRandom:!0,variants:["│ ◉ Reading package.json...","│ ◉ Parsing dependency manifest...","│ ◉ Analyzing project requirements..."]},{text:"│ ◎ Resolving dependency tree...",delay:4500,isRandom:!0,variants:["│ ◎ Resolving dependency tree...","│ ◎ Computing package graph...","│ ◎ Checking version compatibility..."]},{text:"│ Installing: [██████████░░░░░░░░░░] Progress: 50%",delay:4700,color:"#ebcb8b",isProgress:!0,progressSteps:["│ Installing: [░░░░░░░░░░░░░░░░░░░░] Progress: 0%","│ Installing: [████░░░░░░░░░░░░░░░░] Progress: 20%","│ Installing: [██████████░░░░░░░░░░] Progress: 50%","│ Installing: [██████████████░░░░░░] Progress: 70%","│ Installing: [████████████████████] Progress: 100%"]},{text:"│ ✓ Dependencies installed successfully",delay:5400,color:"#a3be8c"},{text:"└─ Package installation complete",delay:5500,color:"#a3be8c"},{text:"",delay:5600},{text:"┌─ Configuring development environment",delay:5700,color:"#88c0d0"},{text:"│ ● Setting up language servers...",delay:5900,isRandom:!0,variants:["│ ● Setting up language servers...","│ ● Initializing LSP services..."]},{text:"│ ▶ Configuring debugging tools...",delay:6100,isRandom:!0,variants:["│ ▶ Configuring debugging tools...","│ ▶ Setting up breakpoint handlers...","│ ▶ Initializing debug protocols..."]},{text:"│ ◈ Configuring settings...",delay:6300,isRandom:!0,variants:["│ ◈ Configuring settings...","│ ◈ Allocating memory...","│ ◈ Adjusting runtime parameters..."]},{text:"│ ✓ Development environment ready",delay:6500,color:"#a3be8c"},{text:"└─ All tools configured",delay:6600,color:"#a3be8c"},{text:"",delay:6700},{text:"┌─ Starting background service",delay:6800,color:"#88c0d0"},{text:"│ ▶ Initializing worker processes...",delay:7e3,isRandom:!0,variants:["│ ▶ Initializing worker processes...","│ ▶ Starting execution engine...","│ ▶ Booting service manager..."]},{text:"│ ◉ Loading runtime libraries...",delay:7200,isRandom:!0,variants:["│ ◉ Loading runtime libraries...","│ ◉ Initializing system modules...","│ ◉ Loading configuration data..."]},{text:"│ ▣ Establishing secure connections...",delay:7400,isRandom:!0,variants:["│ ▣ Establishing connections...","│ ▣ Validating authentication tokens..."]},{text:"│ ✓ Background service online",delay:7600,color:"#a3be8c"},{text:"└─ System ready for task execution ►",delay:7700,color:"#a3be8c"},{text:"",delay:7800}],tI=[{variants:["│ {spinner} Finalizing workspace setup...","│ {spinner} Loading additional configurations...","│ {spinner} Initializing extension support...","│ {spinner} Preparing development tools...","│ {spinner} Setting up code completion...","│ {spinner} Building language services...","│ {spinner} Indexing project files...","│ {spinner} Validating environment...","│ {spinner} Loading editor preferences...","│ {spinner} Preparing execution context..."],color:"#5e81ac",hasSpinner:!0},{variants:["│ ▶ Service ready - awaiting requests...","│ ◉ All tests passed","│ ● Environment ready","│ ▣ Ready for task execution","│ ■ Standing by for user input...","│ ◈ Workspace fully configured","│ ▦ Services starting","│ ✓ Checks passing","│ ▶ Container ready for workload"],color:"#a3be8c",hasSpinner:!1},{variants:["│ {spinner} Loading workspace: {percent}% complete","│ {spinner} Startup progress: {percent}% done","│ {spinner} Initialization: {percent}% finished","│ {spinner} Setup progress: {percent}% complete","│ {spinner} Configuration: {percent}% loaded"],color:"#ebcb8b",hasSpinner:!0,hasMetrics:!0}],tS=()=>({ms:Math.floor(50*Math.random())+10,percent:Math.floor(30*Math.random())+20,speed:(50*Math.random()+10).toFixed(1),count:Math.floor(20*Math.random())+5});function tE({composerId:e}={}){let[t,r]=(0,d.useState)(!1),[o]=(0,d.useState)(()=>e||`${Date.now()}-${Math.random().toString(36).substr(2,9)}`),a=e||o,n=`terminal-logs-state-${a}`,[l,i]=(0,d.useState)([]),[c,u]=(0,d.useState)(0),[m,p]=(0,d.useState)(Date.now()),[x,h]=(0,d.useState)(!1),[f,g]=(0,d.useState)([]),[b,v]=(0,d.useState)(new Map),y=(0,d.useRef)(null),[w,j]=(0,d.useState)(!1),N=(0,d.useCallback)(()=>{if(!y.current)return;let{scrollTop:e,scrollHeight:t,clientHeight:r}=y.current;5>Math.abs(t-r-e)?j(!1):j(!0)},[]);return(0,d.useEffect)(()=>{t&&j(!1)},[t]),(0,d.useEffect)(()=>{!w&&y.current&&(y.current.scrollTop=y.current.scrollHeight)},[l,w]),(0,d.useEffect)(()=>{if(0===b.size)return;let e=setInterval(()=>{let e=Date.now();i(t=>t.map((t,r)=>{let s=b.get(r);if(!s)return t;let o=((e,t=200)=>{let r=Math.floor(e/t)%tC.length;return tC[r]})(e,150),a=s.template.replace("{spinner}",o);return s.metrics&&Object.entries(s.metrics).forEach(([e,t])=>{a=a.replace(`{${e}}`,String(t))}),{...t,text:a}}))},150);return()=>clearInterval(e)},[b,a]),(0,d.useEffect)(()=>{v(new Map)},[a]),(0,d.useEffect)(()=>{try{let e=sessionStorage.getItem(n);if(e){let t=JSON.parse(e),r=t.randomizedLogs&&t.randomizedLogs.length>0?t.randomizedLogs:tk.map(e=>({...e,text:e.isRandom&&e.variants?tj(e.variants):e.text,delay:e.isRandom?e.delay+tN(-100,200):e.delay}));g(r);let s=((e,t)=>{let r=(Date.now()-e)/4,s=[],o=0,a=!1;if(0===t.length)return{startTime:e,displayedLogs:[],currentIndex:0,ongoingPhase:!1,randomizedLogs:[]};for(let e=0;e<t.length;e++){let a=t[e];if(r>=a.delay)if(a.isProgress&&a.progressSteps){let t=a.delay,n=480*a.progressSteps.length,l=r-t;if(l>=n)s.push({...a,text:a.progressSteps[a.progressSteps.length-1]}),o=e+1;else{let t=Math.max(0,Math.min(Math.floor(l/480),a.progressSteps.length-1));s.push({...a,text:a.progressSteps[t]}),o=e}}else s.push(a),o=e+1;else break}if(o>=t.length){a=!0;let e=t[t.length-1].delay,o=Math.floor((r-e)/6e3);for(let t=0;t<o&&t<10;t++){let r=tI[t%tI.length],o=tj(r.variants),a=o;if(r.hasSpinner){let e=tC[0];a=o.replace("{spinner}",e),r.hasMetrics&&Object.entries(tS()).forEach(([e,t])=>{a=a.replace(`{${e}}`,String(t))})}s.push({text:a,delay:e+(t+1)*6e3,color:r.color})}}return{startTime:e,displayedLogs:s,currentIndex:o,ongoingPhase:a,randomizedLogs:t}})(t.startTime,r);p(s.startTime),i(s.displayedLogs),u(s.currentIndex),h(s.ongoingPhase)}else{let e=Date.now(),t=tk.map(e=>({...e,text:e.isRandom&&e.variants?tj(e.variants):e.text,delay:e.isRandom?e.delay+tN(-100,200):e.delay}));p(e),g(t),sessionStorage.setItem(n,JSON.stringify({startTime:e,displayedLogs:[],currentIndex:0,ongoingPhase:!1,randomizedLogs:t}))}}catch(r){console.error("Failed to load terminal logs state:",r);let e=Date.now(),t=tk.map(e=>({...e,text:e.isRandom&&e.variants?tj(e.variants):e.text,delay:e.isRandom?e.delay+tN(-100,200):e.delay}));p(e),g(t)}},[n]),(0,d.useEffect)(()=>{if(0!==f.length)try{sessionStorage.setItem(n,JSON.stringify({startTime:m,displayedLogs:l,currentIndex:c,ongoingPhase:x,randomizedLogs:f}))}catch(e){console.error("Failed to save terminal logs state:",e)}},[n,m,l,c,x,f]),(0,d.useEffect)(()=>{if(0===f.length)return;if(c>=f.length)return void h(!0);let e=f[c],t=Date.now()-m,r=setTimeout(()=>{if(e.isProgress&&e.progressSteps){let t=0,r=()=>{if(t<e.progressSteps.length){let s={...e,text:e.progressSteps[t]};i(e=>{let t=[...e],r=t.findIndex((e,t)=>t===c);return r>=0?t[r]=s:t.push(s),t}),++t<e.progressSteps.length?setTimeout(r,tN(200,280)):u(e=>e+1)}};r()}else i(t=>[...t,e]),u(e=>e+1)},Math.max(0,(e.delay-t)*4));return()=>clearTimeout(r)},[c,m,f,a]),(0,d.useEffect)(()=>{if(!x)return;let e=setInterval(()=>{let e=tI[Math.floor(Math.random()*tI.length)],t=tj(e.variants);i(r=>{let s=[...r];s.length>50&&(s.splice(0,10),v(e=>{let t=new Map;return e.forEach((e,r)=>{r>=10&&t.set(r-10,e)}),t}));let o=s.length,a=t;return v(()=>{let r=new Map;if(e.hasSpinner){let s=e.hasMetrics?tS():void 0;r.set(o,{template:t,color:e.color,metrics:s});let n=tC[0];a=t.replace("{spinner}",n),s&&Object.entries(s).forEach(([e,t])=>{a=a.replace(`{${e}}`,String(t))})}return r}),[...s,{text:a,delay:Date.now()-m,color:e.color}]})},tN(1e4,18e3));return()=>clearInterval(e)},[x,m,a]),(0,s.jsxs)("div",{className:"-mt-2 flex flex-col gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>r(e=>!e),className:"group flex w-full items-center pl-5 pr-2 text-left text-[12px] text-theme-text-secondary opacity-60 hover:opacity-80",children:(0,s.jsxs)("span",{className:"flex items-center gap-0",children:[(0,s.jsx)("span",{className:"make-shine flex items-center",children:"Setting up environment..."}),(0,s.jsx)(eI.A,{className:`ml-1 inline-block align-middle h-3 w-3 transform transition-transform ${t?"rotate-90":"hidden group-hover:inline-block"}`})]})}),t&&(0,s.jsx)("div",{className:"ml-5 mr-5 max-h-[150px] overflow-hidden bg-theme-bg-muted border-theme-border-02 text-theme-text-primary rounded-lg border px-3 py-1 web-text-base whitespace-pre-wrap",style:{borderColor:"rgba(139, 148, 158, 0.25)"},children:(0,s.jsx)("div",{className:"max-h-[150px] w-full overflow-y-auto px-2 py-1",ref:y,onScroll:N,children:l.map((e,t)=>(0,s.jsx)("div",{className:"flex min-w-0 flex-col gap-1",children:(0,s.jsx)("div",{className:"flex min-w-0 gap-3",children:(0,s.jsx)("pre",{className:"kerning-none min-w-0 flex-1 flex-shrink-0 whitespace-pre-wrap break-words font-mono text-xs tabular-nums leading-relaxed",style:{color:e.color||"#d8dee9",letterSpacing:"0.00982143em"},children:e.text})})},t))})})]})}var tA=r(35438),tR=r(19381),tM=r(2335),tD=r(21119),tT=r(87862),tP=r(83692);let tL=r(44387).B8,t$=[{id:"status",label:"Status",type:"multiselect",icon:tR.A,operators:["is","is_not","any_of","none_of"],options:[{value:p.R6.RUNNING,label:"Running"},{value:p.R6.FINISHED,label:"Finished"},{value:p.R6.ERROR,label:"Error"},{value:p.R6.CREATING,label:"Creating"},{value:p.R6.EXPIRED,label:"Expired"}]},{id:"model",label:"Model",type:"multiselect",icon:({className:e})=>(0,s.jsx)("svg",{width:"14",height:"12",viewBox:"0 0 14 12",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:e,children:(0,s.jsx)("path",{d:"M0.457031 6.1377C0.457031 5.77637 0.515625 5.42969 0.632812 5.09766C0.753255 4.76562 0.924154 4.46289 1.14551 4.18945C1.36686 3.91276 1.63053 3.68327 1.93652 3.50098L2.39551 4.28223C2.0765 4.47754 1.82422 4.73958 1.63867 5.06836C1.45638 5.39714 1.36523 5.75195 1.36523 6.13281C1.36523 6.5625 1.45801 6.93848 1.64355 7.26074C1.83236 7.58301 2.0944 7.83366 2.42969 8.0127C2.76497 8.19173 3.15723 8.28125 3.60645 8.28125C4.03939 8.28125 4.42025 8.20475 4.74902 8.05176C5.0778 7.89551 5.33171 7.67904 5.51074 7.40234C5.69303 7.1224 5.78418 6.7985 5.78418 6.43066C5.78418 6.25163 5.75814 6.09212 5.70605 5.95215C5.65397 5.81217 5.5791 5.69499 5.48145 5.60059C5.39355 5.51921 5.32031 5.4541 5.26172 5.40527C5.20312 5.35319 5.15918 5.30111 5.12988 5.24902C5.10059 5.19368 5.08594 5.12207 5.08594 5.03418C5.08594 4.91699 5.12663 4.82096 5.20801 4.74609C5.29264 4.67122 5.40007 4.63379 5.53027 4.63379C5.62142 4.63379 5.7028 4.65007 5.77441 4.68262C5.84603 4.71517 5.93066 4.77376 6.02832 4.8584C6.2334 5.03092 6.3929 5.25391 6.50684 5.52734C6.62077 5.79753 6.67773 6.10352 6.67773 6.44531C6.67773 6.99219 6.54915 7.4707 6.29199 7.88086C6.03483 8.29102 5.6735 8.61003 5.20801 8.83789C4.74251 9.06576 4.20378 9.17969 3.5918 9.17969C2.9668 9.17969 2.41829 9.05436 1.94629 8.80371C1.47428 8.5498 1.10807 8.19499 0.847656 7.73926C0.58724 7.28027 0.457031 6.74642 0.457031 6.1377ZM1.77539 3.54492C1.77539 3.14779 1.87305 2.79785 2.06836 2.49512C2.26367 2.18913 2.52734 1.94987 2.85938 1.77734C3.19141 1.60156 3.5625 1.51367 3.97266 1.51367C4.24609 1.51367 4.52279 1.55924 4.80273 1.65039C5.08268 1.73828 5.34961 1.875 5.60352 2.06055L5.07129 2.79785C4.89551 2.6709 4.71322 2.5765 4.52441 2.51465C4.33561 2.4528 4.15007 2.42188 3.96777 2.42188C3.72038 2.42188 3.50065 2.4707 3.30859 2.56836C3.11654 2.66276 2.96354 2.7946 2.84961 2.96387C2.73893 3.12988 2.68359 3.32357 2.68359 3.54492C2.68359 3.74349 2.72754 3.9209 2.81543 4.07715C2.90658 4.23014 3.03516 4.35059 3.20117 4.43848C3.36719 4.52637 3.56576 4.57031 3.79688 4.57031C3.91732 4.57031 4.02148 4.61589 4.10938 4.70703C4.20052 4.79492 4.24609 4.90072 4.24609 5.02441C4.24609 5.14811 4.20052 5.25553 4.10938 5.34668C4.02148 5.43457 3.91732 5.47852 3.79688 5.47852C3.38346 5.47852 3.02539 5.39714 2.72266 5.23438C2.42318 5.06836 2.19043 4.84049 2.02441 4.55078C1.8584 4.25781 1.77539 3.92253 1.77539 3.54492ZM4.41211 3.38867C4.42839 2.91341 4.54557 2.49512 4.76367 2.13379C4.98177 1.76921 5.27637 1.48438 5.64746 1.2793C6.02181 1.07422 6.44499 0.97168 6.91699 0.97168C7.26204 0.97168 7.58594 1.04004 7.88867 1.17676C8.19141 1.31348 8.44531 1.50228 8.65039 1.74316C8.71224 1.72689 8.77246 1.71549 8.83105 1.70898C8.8929 1.70247 8.94661 1.69922 8.99219 1.69922C9.32422 1.69922 9.63672 1.76107 9.92969 1.88477C10.2259 2.00846 10.488 2.18587 10.7158 2.41699C10.9437 2.64486 11.1227 2.91667 11.2529 3.23242C11.3864 3.54818 11.4531 3.89648 11.4531 4.27734C11.4531 4.75586 11.375 5.15462 11.2188 5.47363C11.0658 5.79264 10.8672 6.05957 10.623 6.27441C10.3822 6.48926 10.1266 6.67643 9.85645 6.83594C9.58626 6.99219 9.3291 7.14518 9.08496 7.29492C8.84408 7.44466 8.64551 7.61556 8.48926 7.80762C8.33626 7.99967 8.25977 8.2373 8.25977 8.52051C8.25977 8.87858 8.39974 9.139 8.67969 9.30176C8.96289 9.46452 9.34212 9.5459 9.81738 9.5459C9.889 9.5459 9.96224 9.5459 10.0371 9.5459C10.112 9.54264 10.1787 9.54102 10.2373 9.54102C10.2861 9.54102 10.3219 9.55404 10.3447 9.58008C10.3708 9.60286 10.3838 9.63379 10.3838 9.67285C10.3838 9.88444 10.4115 10.0977 10.4668 10.3125C10.5221 10.5273 10.6084 10.7064 10.7256 10.8496C10.846 10.9961 10.999 11.0693 11.1846 11.0693C11.3669 11.0693 11.5329 10.9798 11.6826 10.8008C11.8324 10.6217 11.9512 10.3743 12.0391 10.0586C12.127 9.74284 12.1709 9.38477 12.1709 8.98438C12.1709 8.73698 12.1611 8.51237 12.1416 8.31055C12.1253 8.10872 12.1058 7.90527 12.083 7.7002L12.9863 7.45117C13.0124 7.66276 13.0335 7.889 13.0498 8.12988C13.0661 8.37077 13.0742 8.66048 13.0742 8.99902C13.0742 9.37988 13.0335 9.74935 12.9521 10.1074C12.8708 10.4655 12.7503 10.7845 12.5908 11.0645C12.4346 11.3444 12.2376 11.5658 12 11.7285C11.7656 11.8945 11.4938 11.9775 11.1846 11.9775C10.9014 11.9775 10.6523 11.8994 10.4375 11.7432C10.2259 11.5902 10.0534 11.3883 9.91992 11.1377C9.78646 10.8903 9.69694 10.6234 9.65137 10.3369C9.59928 10.3402 9.54557 10.3434 9.49023 10.3467C9.4349 10.3499 9.38281 10.3516 9.33398 10.3516C8.95312 10.3516 8.61133 10.2767 8.30859 10.127C8.00586 9.98047 7.7666 9.77376 7.59082 9.50684C7.41829 9.23665 7.33203 8.91764 7.33203 8.5498C7.33203 8.16895 7.40853 7.85156 7.56152 7.59766C7.71777 7.34049 7.91797 7.11914 8.16211 6.93359C8.40625 6.74479 8.66504 6.56901 8.93848 6.40625C9.21191 6.24349 9.46908 6.07096 9.70996 5.88867C9.9541 5.70312 10.1543 5.48177 10.3105 5.22461C10.4668 4.96745 10.5449 4.65169 10.5449 4.27734C10.5449 3.9388 10.4652 3.64583 10.3057 3.39844C10.1494 3.15104 9.94434 2.95898 9.69043 2.82227C9.43978 2.68229 9.17122 2.61068 8.88477 2.60742C8.80013 2.60742 8.71387 2.6123 8.62598 2.62207C8.54134 2.63184 8.46159 2.64811 8.38672 2.6709C8.32487 2.68392 8.27441 2.68717 8.23535 2.68066C8.19954 2.6709 8.16862 2.64323 8.14258 2.59766C8.04818 2.38281 7.88867 2.20866 7.66406 2.0752C7.43945 1.94173 7.1888 1.875 6.91211 1.875C6.60612 1.875 6.33431 1.94336 6.09668 2.08008C5.8623 2.21354 5.67513 2.39746 5.53516 2.63184C5.39844 2.86296 5.32357 3.12988 5.31055 3.43262C5.30404 3.57259 5.25846 3.68327 5.17383 3.76465C5.08919 3.84277 4.98503 3.88184 4.86133 3.88184C4.73112 3.88184 4.62207 3.83626 4.53418 3.74512C4.44954 3.65397 4.40885 3.53516 4.41211 3.38867ZM10.2129 8.24707C10.2129 8.12012 10.2585 8.01107 10.3496 7.91992C10.4408 7.82552 10.5498 7.78483 10.6768 7.79785C11.266 7.84668 11.7396 7.72135 12.0977 7.42188C12.4557 7.1224 12.6348 6.70247 12.6348 6.16211C12.6348 5.66732 12.4834 5.26855 12.1807 4.96582C11.8812 4.66309 11.4824 4.51497 10.9844 4.52148L11.1309 3.61328C11.6126 3.67188 12.0342 3.81836 12.3955 4.05273C12.7601 4.28385 13.0417 4.58171 13.2402 4.94629C13.4421 5.31087 13.543 5.71615 13.543 6.16211C13.543 6.70573 13.4225 7.17611 13.1816 7.57324C12.944 7.96712 12.6087 8.26335 12.1758 8.46191C11.7428 8.65723 11.2399 8.73698 10.667 8.70117C10.54 8.69141 10.4326 8.64583 10.3447 8.56445C10.2568 8.47982 10.2129 8.37402 10.2129 8.24707ZM7.74219 8.80859L8.0498 9.67773C7.81868 9.74935 7.58594 9.80143 7.35156 9.83398C7.11719 9.86654 6.89258 9.88281 6.67773 9.88281C6.13411 9.88281 5.64095 9.79004 5.19824 9.60449C4.75879 9.41569 4.40723 9.16667 4.14355 8.85742L4.94922 8.2373C5.05339 8.3903 5.2015 8.52214 5.39355 8.63281C5.58561 8.74349 5.80046 8.82975 6.03809 8.8916C6.27897 8.9502 6.52474 8.97949 6.77539 8.97949C6.93815 8.97949 7.10254 8.96484 7.26855 8.93555C7.43783 8.90625 7.5957 8.86393 7.74219 8.80859ZM6.05762 5.41016C6.52311 5.35156 6.85352 5.20996 7.04883 4.98535C7.24414 4.76074 7.34017 4.44661 7.33691 4.04297C7.33366 3.91927 7.37598 3.81348 7.46387 3.72559C7.55176 3.6377 7.65755 3.59375 7.78125 3.59375C7.90495 3.59375 8.01237 3.6377 8.10352 3.72559C8.19466 3.81348 8.24186 3.91927 8.24512 4.04297C8.24837 4.64518 8.09538 5.13835 7.78613 5.52246C7.48014 5.90658 7.00651 6.15885 6.36523 6.2793L6.05762 5.41016Z"})}),operators:["is","is_not","any_of","none_of"],options:eH.lb.map(e=>({value:e.id,label:e.displayName}))},{id:"repoUrl",label:"Repo",type:"multiselect",icon:tM.A,operators:["is","is_not","any_of","none_of","contains","does_not_contain"]},{id:"createdAt",label:"Date",type:"date",icon:tD.A,operators:["is","before","after","between"]},{id:"merge",label:"Pull request",type:"boolean",icon:ep.A,operators:["is","is_not"]}],t_={is:"Is",is_not:"Is not",contains:"Contains",does_not_contain:"Does not contain",starts_with:"Starts with",ends_with:"Ends with",is_empty:"Is empty",is_not_empty:"Is not empty",any_of:"Any of",none_of:"None of",before:"Before",after:"After",between:"Between"},tU={rules:[]},tO=e=>{if(!e)return new Date;let[t,r,s]=e.split("-").map(Number);return new Date(t,r-1,s)},tF=e=>{let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`};function tz({filterConfig:e,onFilterConfigChange:t}){let[r,o]=(0,d.useState)(!1),[a,n]=(0,d.useState)(!1),[l,i]=(0,d.useState)("right"),[c,u]=(0,d.useState)("main"),[m,p]=(0,d.useState)({}),[x,f]=(0,d.useState)(""),g=(0,d.useRef)(null),b=(0,d.useRef)(null),v=(0,d.useRef)(null),y=(0,d.useRef)(null),{installations:w}=(0,h.C)({}),j=function(){try{let e=localStorage.getItem("recentRepositories");return e?JSON.parse(e):[]}catch{return[]}}(),N=(0,d.useMemo)(()=>w.flatMap(e=>e.repos.map(t=>({repo:t,displayName:`${t.owner}/${t.name}`,installationName:e.repos.length>0?t.owner:"Unknown"}))),[w]),C=(0,d.useMemo)(()=>{let e=[],t=j.map(e=>{let t=N.find(t=>t.repo.repoNodeId===e.repoNodeId);return t?{...t,isRecent:!0}:null}).filter(Boolean);t.forEach(t=>{e.push({value:t.repo.htmlUrl,label:t.displayName})});let r=new Set(t.map(e=>e.repo.repoNodeId));return N.filter(e=>!r.has(e.repo.repoNodeId)).forEach(t=>{e.push({value:t.repo.htmlUrl,label:t.displayName})}),e},[N,j]),k=(0,d.useMemo)(()=>new tA.A(C,{keys:["label"],threshold:.3,distance:100,includeScore:!0,includeMatches:!0,minMatchCharLength:1,shouldSort:!0}),[C]),I=(0,d.useMemo)(()=>{if(!x.trim()){let e=Array.isArray(m.value)?m.value:("is"===m.operator||"is_not"===m.operator)&&m.value?[m.value]:[];return e.length>0?C.filter(t=>e.includes(t.value)):C}return k.search(x).map(e=>e.item)},[C,x,k,m.value,m.operator]),S=(0,d.useCallback)(()=>{if(!b.current)return;let e=b.current.getBoundingClientRect();i(window.innerWidth-e.right>=316?"right":"left")},[]),E=()=>{o(!1),setTimeout(()=>{n(!1),u("main"),p({})},150)};(0,d.useEffect)(()=>{let e=()=>{(r||a)&&S()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[r,a,S]);let A=()=>e.rules?.length>0,R=()=>{E()},M=t$.map(e=>{if("repoUrl"===e.id)if(C.length>0)return{...e,type:"multiselect",options:C};else return{...e,type:"text",operators:["is","is_not","contains","does_not_contain","starts_with","ends_with","is_empty","is_not_empty"]};return e}),D=t=>e.rules?.find(e=>e.property===t),T=e=>{m.operator&&L(m.operator,e)},P=()=>{m.editingRuleId&&(t({rules:(e.rules||[]).filter(e=>e.id!==m.editingRuleId)}),p(e=>({...e,editingRuleId:void 0,value:void 0,error:void 0})))},L=(r,s)=>{if(!m.property)return;if(("any_of"===r||"none_of"===r)&&Array.isArray(s)&&0===s.length){m.editingRuleId&&P();return}let o={id:m.editingRuleId||Date.now().toString(),property:m.property.id,operator:r,value:s},a=e.rules||[];m.editingRuleId?t({rules:a.map(e=>e.id===m.editingRuleId?o:e)}):t({rules:[...a,o]}),p(e=>({...e,value:s,editingRuleId:o.id,error:void 0}))},$=(e,t)=>{if(e&&t&&t<e)return"End date cannot be earlier than start date"};return(0,ti.vC)("esc",()=>{(r||a)&&R()}),(0,d.useEffect)(()=>{("operator"!==c||m.property?.id!=="repoUrl")&&f("")},[c,m.property?.id]),(0,d.useEffect)(()=>{if("operator"===c&&m.property?.id==="repoUrl"&&v.current){let e=setTimeout(()=>{v.current?.focus()},50);return()=>clearTimeout(e)}},[c,m.property?.id]),(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:`fixed inset-0 z-[100] h-[100vh] w-[100vw] transition-opacity duration-150 ${r?"opacity-100":"opacity-0"}`,style:{top:"-68px",left:"-174px"},onClick:R}),(0,s.jsxs)("div",{className:"relative",ref:g,children:[(0,s.jsx)("button",{ref:b,onClick:()=>{r||a?E():(n(!0),S(),requestAnimationFrame(()=>{o(!0)}))},className:`flex items-center rounded-[6px] p-1 outline-none transition-all duration-200 focus:outline-none ${A()?"text-theme-text-secondary hover:bg-hover-theme-card-hover-hex":"text-theme-text-secondary hover:bg-white/5"}`,children:(0,s.jsx)(tT.A,{className:"h-3 w-3"})}),a&&(0,s.jsxs)(ef.W1,{open:r,onClose:R,align:"right"===l?"left":"right",width:232,zIndex:999,origin:"right"===l?"top-left":"top-right",triggerRef:b,children:[(0,s.jsx)("div",{className:"flex w-full flex-row items-center justify-between px-2 pb-1",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["operator"===c?(0,s.jsxs)("button",{onClick:()=>{"operator"===c?u("main"):(u("main"),p({}))},className:"-mr-2 flex items-center gap-2 rounded-md p-1 pr-2 transition-colors hover:bg-hover-theme-card-hover-hex",children:[(0,s.jsx)(tP.A,{className:"h-3 w-3 text-theme-text-secondary"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-theme-text-primary",children:m.property?.label})]}):(0,s.jsx)("span",{className:"block py-1 text-xs font-semibold text-theme-text-secondary",children:"Filter"}),"operator"===c&&m.property&&"boolean"!==m.property.type&&(0,s.jsx)("select",{value:m.operator||"",onChange:e=>(e=>{let t=m.value;if("any_of"===e||"none_of"===e?Array.isArray(t)||(t=null!=t?[t]:[]):"is"===e||"is_not"===e?Array.isArray(t)?t=t.length>0?t[0]:void 0:m.property?.type!=="date"||!t||"object"!=typeof t||Array.isArray(t)||t instanceof Date||(t=t.from instanceof Date?t.from:t.to instanceof Date?t.to:void 0):"between"===e?t&&"object"==typeof t&&t.from&&t.to||(t=t instanceof Date?{from:t,to:null}:{from:null,to:null}):"before"!==e&&"after"!==e||t instanceof Date||(t=t&&"object"==typeof t&&t.from instanceof Date?t.from:t&&"object"==typeof t&&t.to instanceof Date?t.to:void 0),p(r=>({...r,operator:e,value:t,error:void 0})),"is_empty"===e||"is_not_empty"===e)L(e,null);else if(null!=t)if(Array.isArray(t)&&0===t.length)return;else"between"===e?t&&"object"==typeof t&&t.from instanceof Date&&t.to instanceof Date&&($(t.from,t.to)||L(e,t)):L(e,t)})(e.target.value),className:"rounded-[4px] border border-theme-border-02 bg-transparent px-[6px] py-[3px] text-xs text-theme-text-primary transition-colors focus:outline-none focus:ring-0",children:m.property.operators.map(e=>(0,s.jsx)("option",{value:e,className:"bg-[#1e1f22]",children:t_[e]},e))})]})}),(0,s.jsxs)("div",{children:["main"===c&&(0,s.jsx)("div",{className:"space-y-0",children:(0,s.jsx)("div",{className:"space-y-0",children:M?.map(e=>{let t=e.icon,r=D(e.id);return(0,s.jsx)(ef.Dr,{onClick:()=>(e=>{let t=D(e.id);if(t)p({property:e,operator:t.operator,value:t.value,editingRuleId:t.id});else{let t;switch(e.type){case"boolean":case"multiselect":t="is";break;case"text":t="contains";break;case"date":t="after";break;default:t=e.operators[0]}p({property:e,operator:t})}u("operator")})(e),icon:(0,s.jsx)(t,{className:`h-4 w-4 text-theme-text-secondary ${r?"mt-1":""}`}),label:(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"text-theme-text-primary",children:e.label}),r&&(0,s.jsx)("span",{className:"!text-[10px] text-theme-text-secondary",children:((e,t)=>{let r=t_[e.operator];if("is_empty"===e.operator||"is_not_empty"===e.operator)return r;let s=e.value;if("multiselect"===t.type&&Array.isArray(e.value))s=e.value.map(e=>t.options?.find(t=>t.value===e)?.label||e).join(", ");else if("boolean"===t.type){var o,a;o=t.id,a=e.value,s="merge"===o?a?"Is merged":"Is not merged":a?"True":"False"}else if("date"===t.type)if("between"===e.operator&&e.value?.from&&e.value?.to){let t=e.value.from.toLocaleDateString(),r=e.value.to.toLocaleDateString();s=`${t} - ${r}`}else e.value instanceof Date&&(s=e.value.toLocaleDateString());else if("multiselect"===t.type&&!Array.isArray(e.value)){let r=t.options?.find(t=>t.value===e.value);s=r?.label||e.value}let n=String(s);return`${r} ${n.toLowerCase()}`})(r,e)})]})},e.id)})})}),"operator"===c&&m.property&&m.operator&&(()=>{if(!m.property||!m.operator)return null;let{property:e,operator:t}=m;switch(e.type){case"boolean":{let t="merge"===e.id?[{value:!0,label:"Is merged"},{value:!1,label:"Is not merged"}]:[{value:!0,label:"True"},{value:!1,label:"False"}],r=m.value;return(0,s.jsx)("div",{className:"space-y-0",children:t.map(e=>(0,s.jsx)(ef.Dr,{onClick:()=>{r===e.value&&m.editingRuleId?P():T(e.value)},label:e.label,rightSlot:r===e.value?(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-secondary"}):null},String(e.value)))})}case"multiselect":if("repoUrl"===e.id){let e=Array.isArray(m.value)?m.value:"any_of"===t||"none_of"===t?[]:void 0;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 px-1",children:[(0,s.jsx)(eE.A,{className:"h-3 w-3 flex-shrink-0 text-theme-text-secondary"}),(0,s.jsx)("input",{ref:v,type:"text",placeholder:"Search repositories...",value:x,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.key&&f("")},className:"flex-1 border-none bg-transparent px-1 py-1 text-xs text-theme-text-secondary placeholder-theme-text-sec focus:outline-none",autoFocus:!0})]}),(0,s.jsx)("div",{className:"border-t border-theme-border-02",children:0===I.length?(0,s.jsx)("div",{className:"py-3 text-center text-xs text-theme-text-secondary",children:x?"No repositories found":"No repositories available"}):(0,s.jsx)(tL,{ref:y,height:Math.min(200,29*I.length),width:222,rowCount:I.length,rowHeight:29,rowRenderer:({index:r,key:o,style:a})=>{let n=I[r],l="is"===t||"is_not"===t?m.value===n.value:Array.isArray(e)&&e.includes(n.value);return(0,s.jsx)("div",{style:a,children:(0,s.jsx)(ef.Dr,{onClick:()=>{if(f(""),"is"===t||"is_not"===t)m.value===n.value&&m.editingRuleId?P():T(n.value);else{let t=Array.isArray(e)?e:[];T(t.includes(n.value)?t.filter(e=>e!==n.value):[...t,n.value])}},label:(0,s.jsx)("span",{className:"truncate",children:function(e,t){if(!t||t.length<1)return e;let r=t.toLowerCase(),o=e.toLowerCase(),a=[],n=0;for(;n<o.length;){let e=o.indexOf(r,n);if(-1===e)break;a.push({start:e,end:e+t.length}),n=e+1}if(0===a.length){for(let s of e.split(/[\s\-_./\\]+/))if(s.toLowerCase().startsWith(r)){let e=o.indexOf(s.toLowerCase());if(-1!==e){a.push({start:e,end:e+t.length});break}}}if(0===a.length)return e;a.sort((e,t)=>e.start-t.start);let l=[],i=0;return a.forEach((t,r)=>{t.start>i&&l.push(e.slice(i,t.start)),l.push((0,s.jsx)("span",{className:"rounded-[2px] bg-theme-border-02 text-cyan-600",children:e.slice(t.start,t.end)},r)),i=t.end}),i<e.length&&l.push(e.slice(i)),l}(n.label,x)}),rightSlot:l?(0,s.jsx)(F.A,{className:"h-3 w-3 flex-shrink-0 text-theme-text-secondary"}):null})},o)},scrollToAlignment:"auto",className:"virtualized-dropdown-list"})})]})}if("is"===t||"is_not"===t){let t=m.value;return(0,s.jsx)("div",{className:"space-y-0",children:e.options?.map(e=>(0,s.jsx)(ef.Dr,{onClick:()=>{t===e.value&&m.editingRuleId?P():T(e.value)},label:e.label,rightSlot:t===e.value?(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-secondary"}):null},e.value))})}{let t=Array.isArray(m.value)?m.value:[];return(0,s.jsx)("div",{className:"space-y-0",children:e.options?.map(e=>(0,s.jsx)(ef.Dr,{onClick:()=>{T(t.includes(e.value)?t.filter(t=>t!==e.value):[...t,e.value])},label:e.label,rightSlot:t.includes(e.value)?(0,s.jsx)(F.A,{className:"h-3 w-3 text-theme-text-secondary"}):null},e.value))})}case"text":return(0,s.jsxs)("div",{className:"space-y-0",children:[(0,s.jsx)("input",{type:"text",value:m.value||"",onChange:e=>p(t=>({...t,value:e.target.value})),onKeyDown:e=>{"Enter"===e.key&&m.value?.trim()&&T(m.value)},placeholder:`Enter ${e.label.toLowerCase()}...`,className:"w-full rounded-md border border-theme-border-02 bg-transparent px-2 py-1.5 text-xs text-theme-text-secondary placeholder-theme-text-sec transition-colors focus:border-white/20 focus:outline-none focus:ring-0",autoFocus:!0}),(0,s.jsx)("button",{onClick:()=>T(m.value),disabled:!m.value?.trim(),className:"w-full rounded-md bg-blue-600 px-2 py-1.5 text-xs font-medium text-white transition-colors hover:bg-blue-700 disabled:bg-gray-600",children:"Apply"})]});case"date":if("between"!==t)return(0,s.jsx)("div",{className:"space-y-0 pt-4 pb-2 px-2",children:(0,s.jsx)("input",{type:"date",value:m.value&&m.value instanceof Date?tF(m.value):"",onChange:e=>{let t=e.target.value?tO(e.target.value):null;p(e=>({...e,value:t})),t&&T(t)},className:"w-full rounded-md border border-theme-border-02 bg-transparent px-1 text-xs text-theme-text-secondary transition-colors focus:border-theme-border-02 focus:outline-none focus:ring-0",autoFocus:!0})});{let e=m.value||{from:null,to:null},t=!!m.error;return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 block text-xs text-theme-text-secondary",children:"From"}),(0,s.jsx)("input",{type:"date",value:e.from&&e.from instanceof Date?tF(e.from):"",onChange:t=>{let r=t.target.value?tO(t.target.value):null,s={...e,from:r},o=$(r,e.to);p(e=>({...e,value:s,error:o})),s.from&&s.to&&!o&&T(s)},className:`w-full rounded-md border bg-transparent px-2 py-1.5 text-xs text-theme-text-secondary transition-colors focus:border-theme-border-02 focus:outline-none focus:ring-0 ${t?"border-red-500":"border-theme-border-02"}`})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 block text-xs text-theme-text-secondary",children:"To"}),(0,s.jsx)("input",{type:"date",value:e.to&&e.to instanceof Date?tF(e.to):"",onChange:t=>{let r=t.target.value?tO(t.target.value):null,s={...e,to:r},o=$(e.from,r);p(e=>({...e,value:s,error:o})),s.from&&s.to&&!o&&T(s)},className:`w-full rounded-md border bg-transparent px-2 py-1.5 text-xs text-theme-text-secondary transition-colors focus:border-theme-border-02 focus:outline-none focus:ring-0 ${t?"border-red-500":"border-theme-border-02"}`})]})]})}default:return null}})()]}),"main"===c&&A()&&(0,s.jsx)("div",{className:"px-2 w-full",children:(0,s.jsx)("div",{className:"flex gap-1",children:(0,s.jsx)("button",{onClick:()=>{t(tU)},className:"rounded-md px-2 py-1 text-xs font-medium text-theme-text-primary transition-colors hover:bg-hover-theme-card-hover-hex",children:"Reset"})})}),"operator"===c&&m.editingRuleId&&(0,s.jsx)("div",{className:"border-t border-theme-border-02 pt-1",children:(0,s.jsx)(ef.Dr,{type:"destructive",onClick:P,label:"Remove filter"})})]})]})]})}var tB=r(86645),tG=r(44827),tH=r(95519),tW=r(73768),tq=r(14924),tK=r(94251),tV=r(3317),tJ=r(25822),tZ=r(7543);function tX({type:e,active:t}){let r="left"===e?t?tW.A:tq.A:"right"===e?t?tK.A:tV.A:t?tJ.A:tZ.A;return(0,s.jsx)("span",{className:"relative inline-flex items-center justify-center",children:(0,s.jsx)(r,{className:"size-4",strokeWidth:1.5})})}let tY={padding:"4px 8px",fontSize:"12px",background:"rgba(0, 0, 0)",outline:"1px solid rgba(255,255,255,0.1)",fontWeight:"400"},tQ=new Map(eH.lb.map((e,t)=>[e.id,t]));function t0(e,t,r){let s=r.get(e.bcId),o=r.get(t.bcId),a=s?.modelDetails?.modelName?.trim()??"",n=o?.modelDetails?.modelName?.trim()??"",l=tQ.get(a),i=tQ.get(n);if(void 0!==l||void 0!==i){if(void 0===l)return 1;if(void 0===i)return -1;if(l!==i)return l-i}let c=a.localeCompare(n);return 0!==c?c:(e.createdAtMs||0)-(t.createdAtMs||0)}let t1=({startTime:e})=>{let[t,r]=(0,d.useState)(Date.now());(0,d.useEffect)(()=>{let e=setInterval(()=>{r(Date.now())},1e3);return()=>clearInterval(e)},[]);let o=((e,t)=>{let r=Math.floor(Math.max(0,t-e)/1e3);if(r<60)return`${r}s`;if(r<3600){let e=Math.floor(r/60),t=r%60;return t>0?`${e}m ${t}s`:`${e}m`}{let e=Math.floor(r/3600),t=Math.floor(r%3600/60);return t>0?`${e}h ${t}m`:`${e}h`}})(e,t);return(0,s.jsxs)("span",{children:["Working for ",o]})};function t2({section:e,selectedComposerId:t,highlightedComposerId:r,detailedComposers:o,detailedDiffs:a,onSelectComposer:n,onClearHighlight:l,groupBy:i}){let{prefetchComposerData:c}=(0,w._F)(),u=(0,d.useMemo)(()=>{let t=new Set;return e.composers.forEach(e=>{if(e.repoUrl){let r=e.repoUrl.split("/");if(r.length>=2){let e=r[r.length-2];e&&t.add(e)}}}),1===t.size},[e.composers]),m=(0,d.useMemo)(()=>"Errored"===e.name||"Expired"===e.name||e.composers.every(e=>{let t=e.status??0;return 3===t||5===t}),[e.composers,e.name]),[x,h]=(0,d.useState)(!m),[f,g]=(0,d.useState)(!1),[b,v]=(0,d.useState)(null),[y,j]=(0,d.useState)(null),[N,C]=(0,d.useState)(null),k=(0,d.useRef)(new Map);(0,d.useEffect)(()=>{if(!b)return;let e=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation(),v(null))};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[b]);let I=async e=>{try{await navigator.clipboard.writeText(e),j(e),setTimeout(()=>{j(t=>t===e?null:t)},800)}catch(e){console.error("Failed to copy request ID",e)}},S=(0,d.useMemo)(()=>{let t=new Map;for(let r of e.composers){let e=r.promptGroupId;if(!e)continue;let s=t.get(e);s?s.push(r):t.set(e,[r])}let r=e.composers.filter(e=>!e.promptGroupId),s=new Map;for(let e of r){let t=5e3*Math.floor((e.createdAtMs||0)/5e3),r=`${e.name||"unnamed"}-${t}`,o=s.get(r);o?o.push(e):s.set(r,[e])}for(let[e,r]of s)r.length>1&&t.set(`optimistic-${e}`,r);let a=new Set,n=[];for(let r of e.composers){let e=r.promptGroupId;if(!e){let s=5e3*Math.floor((r.createdAtMs||0)/5e3),o=`optimistic-${r.name||"unnamed"}-${s}`;t.has(o)&&(e=o)}if(e&&t.get(e)&&t.get(e).length>1){if(a.has(e))continue;a.add(e);let r=t.get(e).slice().sort((e,t)=>t0(e,t,o));n.push({type:"group",composers:r})}else n.push({type:"single",composer:r})}return n},[e.composers,o]);return(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 px-2 py-1 text-[11px] font-medium text-theme-text-secondary transition-colors hover:text-theme-text-primary",style:{fontWeight:"400",lineHeight:"150%",letterSpacing:"0.12px",whiteSpace:"nowrap"},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onClick:()=>h(!x),children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)("div",{className:`flex items-center justify-center transition-opacity duration-200 ${f?"opacity-60":"opacity-0"}`,children:(0,s.jsx)(Y,{className:`transition-transform duration-200 ${x?"":"-rotate-90"}`,size:10})})]}),x&&S.map(d=>{let m="group"===d.type,x=m?d.composers[0]:d.composer,h=m?d.composers:[],f=o.get(x.bcId),g=a.get(x.bcId),w=m?null:(0,A.xH)(f||x,g),j=b===x.bcId,N={current:k.current.get(x.bcId)||void 0},S=m?h.some(e=>e.bcId===t):t===x.bcId,E=m?h.some(e=>e.bcId===r):r===x.bcId,R=(()=>{if(!m)return null;let e=h.length,t=h.filter(e=>{let t=e.status??0;return t===p.R6.FINISHED||t===p.R6.EXPIRED||t===p.R6.ERROR}).length;return h.some(e=>{let t=e.status??0;return t===p.R6.RUNNING||t===p.R6.CREATING})?`${t}/${e} Models Completed`:`${e} ${1===e?"Model":"Models"}`})();return(0,s.jsxs)("div",{id:`composer-${x.bcId}`,"data-composer-item":!0,"data-composer-id":x.bcId,onMouseEnter:()=>{c(x.bcId),m&&h.forEach(e=>{e.bcId!==x.bcId&&c(e.bcId)})},onClick:e=>{if(!e.target.closest("[data-item-menu]")){if(e.metaKey||e.ctrlKey){e.preventDefault(),e.stopPropagation();let t=new URL(window.location.href);t.searchParams.set("selectedBcId",x.bcId),window.open(t.toString(),"_blank","noopener,noreferrer");return}n(x),l()}},onAuxClick:e=>{if(1===e.button){e.preventDefault(),e.stopPropagation();let t=new URL(window.location.href);t.searchParams.set("selectedBcId",x.bcId),window.open(t.toString(),"_blank","noopener,noreferrer")}},onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),v(e=>e===x.bcId?null:x.bcId)},className:"group relative cursor-pointer rounded-md px-[8px] py-[6px] web-text-base hover:bg-theme-card-hover-hex hover:text-theme-text-primary",style:{border:S?"1px solid color-mix(in srgb, color-mix(in srgb, #7b88a1 12%, transparent) 80%, transparent)":E?"1px solid color-mix(in srgb, #7b88a1 20%, transparent)":"1px solid transparent",backgroundColor:S?"var(--color-theme-bg-card-hover)":E?"rgba(255, 255, 255, 0.01)":"",color:S?"#fff":E?"#a1b2c3":"#7b88a1"},children:[(0,s.jsx)("button",{ref:e=>{k.current.set(x.bcId,e)},"data-item-menu":!0,className:`absolute right-1 top-1 z-50 rounded-md p-1 text-theme-text-primary outline-none hover:bg-white/5 hover:text-theme-text-primary focus:outline-none ${j?"opacity-100":"opacity-0 group-hover:opacity-70"}`,onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),v(e=>e===x.bcId?null:x.bcId)},onClick:e=>{e.preventDefault(),e.stopPropagation()},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),v(e=>e===x.bcId?null:x.bcId)),"Escape"===e.key&&(e.preventDefault(),v(null))},"aria-haspopup":"menu","aria-expanded":j,children:(0,s.jsx)(P.A,{size:14})}),(0,s.jsx)(e2,{open:j,composerId:x.bcId,onClose:()=>v(null),onCopy:()=>I(x.bcId),onDelete:()=>{C(m?h.map(e=>e.bcId):[x.bcId]),v(null)},copied:y===x.bcId,triggerRef:N}),(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-1",children:[(0,s.jsx)("div",{className:"flex items-center justify-center pr-[4px] text-theme-text-secondary",children:(()=>{if(m){if(h.some(e=>{let t=e.status??0;return t===p.R6.RUNNING||t===p.R6.CREATING}))return(0,s.jsx)(e9,{status:p.R6.RUNNING,isArchived:!1,className:"h-[14px] w-[14px]"});let e=h.find(e=>e.prUrl&&(e.status??0)!==p.R6.EXPIRED);return e?(0,s.jsx)(tG.K,{prUrl:e.prUrl,size:"sm",showTooltip:!0,hasMultipleModels:!0}):(0,s.jsx)(tG.K,{prUrl:void 0,size:"sm",showTooltip:!0,hasMultipleModels:!0})}let t=!!x.prUrl,r=x.status??0,o=!!x.promptGroupId&&e.composers.filter(e=>e.promptGroupId===x.promptGroupId).length>1;return"merge"!==i||"Ready to open"!==e.name||t||r!==p.R6.FINISHED?"Awaiting follow-up"===e.name?(0,s.jsx)($.A,{className:"h-3 w-3 text-gray-600"}):t&&r!==p.R6.EXPIRED?(0,s.jsx)(tG.K,{prUrl:x.prUrl,size:"sm",showTooltip:!0,hasMultipleModels:o}):o?(0,s.jsx)(tG.K,{prUrl:void 0,size:"sm",showTooltip:!0,hasMultipleModels:!0}):(0,s.jsx)(e9,{status:r,isArchived:x.isArchived,className:"h-[14px] w-[14px]"}):(0,s.jsx)(L.A,{className:"h-3 w-3 text-green-600"})})()}),(0,s.jsx)("div",{className:"text-theme-text-primary min-w-0 flex-1 truncate text-[13px]",style:{lineHeight:"140%",letterSpacing:"0px"},children:x.name||"New Cloud Agent"}),(0,s.jsx)("div",{className:"flex h-[16px] flex-shrink-0 items-center gap-1 text-xs text-theme-text-secondary",children:(0,s.jsx)("span",{children:(()=>{let e=new Date(x.createdAtMs||0),t=new Date().getTime()-e.getTime(),r=Math.floor(t/6e4),s=Math.floor(t/36e5),o=Math.floor(t/864e5),a=Math.floor(o/7),n=Math.floor(o/30),l=Math.floor(o/365);if(r<1)return"now";if(r<60)return`${r}m`;if(s<24)return`${s}h`;if(o<7)return`${o}d`;if(a<4)return`${a}w`;else if(n<12)return`${n}mo`;else return`${l}y`})()})})]}),(0,s.jsx)("div",{className:"flex items-center gap-1 whitespace-nowrap pl-[22px] text-xs text-theme-text-secondary",style:{lineHeight:"150%",letterSpacing:"0.07px"},children:m?(0,s.jsxs)(s.Fragment,{children:[R&&(0,s.jsx)("span",{className:"truncate",children:R}),(()=>{let e=x.repoUrl;if(!e)return null;let t=e.split("/");if(t.length>=2){let e=t.pop()?.replace(/\.git$/,""),r=t.pop(),o=r&&e?u?e:`${r}/${e}`:"";return o&&R?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"\xb7"}),(0,s.jsx)("span",{className:"truncate",children:o})]}):o?(0,s.jsx)("span",{className:"truncate",children:o}):null}return null})()]}):(0,s.jsxs)(s.Fragment,{children:[(()=>{let e=x.status??0,t=e===p.R6.RUNNING||e===p.R6.CREATING,r=(0,eH.$L)(f?.modelDetails?.modelName);return t&&!w?(0,s.jsx)("span",{className:"truncate",children:r}):w&&(w.totalAdded>0||w.totalRemoved>0)||"Unknown model"===r?"":r})(),w&&(w.totalAdded>0||w.totalRemoved>0)&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[w.totalAdded>0&&(0,s.jsxs)("span",{className:"text-green-600 dark:text-green-500",children:["+",w.totalAdded]}),w.totalRemoved>0&&(0,s.jsxs)("span",{className:"dark:text-red-500 text-red-600",children:["-",w.totalRemoved]})]}),(()=>{let e=x.repoUrl;if(!e)return null;let t=e.split("/");if(t.length>=2){let e=t.pop()?.replace(/\.git$/,""),r=t.pop(),o=r&&e?u?e:`${r}/${e}`:"";if(!o)return null;let a=x.status??0,n=a===p.R6.RUNNING||a===p.R6.CREATING,l=(0,eH.$L)(f?.modelDetails?.modelName),i=n&&!w||l&&"Unknown model"!==l,c=w&&(w.totalAdded>0||w.totalRemoved>0);return i||c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"\xb7"}),(0,s.jsx)("span",{className:"truncate",children:o})]}):(0,s.jsx)("span",{className:"truncate",children:o})}return null})()]})}),(0,s.jsx)("div",{className:`pointer-events-none absolute inset-y-0 right-0 w-[80px] rounded-[6px] ${j?"opacity-100":"opacity-0 group-hover:opacity-100"}`,style:{background:`linear-gradient(to left, ${S?"var(--color-theme-bg-card-hover)":E?"rgba(255,255,255,0.01)":"var(--color-theme-bg-card)"} 40%, rgba(255,255,255,0))`}})]},m?`group-${x.promptGroupId}-${x.bcId}`:x.bcId)}),(0,s.jsx)(tm.A,{isOpen:!!N,bcIds:N||[],onClose:()=>C(null),onSuccess:async()=>{C(null)}})]})}function t5({allSections:e,detailedComposers:t,detailedDiffs:r,selectedComposerId:o,selectedComposer:a,isComposerNotFound:n,prLoading:l,existingPrUrl:i,isConversationCollapsed:c,isLeftSidebarVisible:u,setIsLeftSidebarVisible:m,isRightPaneVisible:x,setIsRightPaneVisible:h,viewConfig:f,filterConfig:g,inputBoxRef:b,githubConnected:v,githubError:j,onCloseModal:N,onCollapseConversation:C,onSelectComposer:k,onFocusChange:I,onDropdownOpenChange:E,onBeforeSubmit:R,onViewConfigChange:M,onFilterConfigChange:P,onConnectGithub:L,onOpenExistingPullRequest:$,onOpenPullRequest:J,onPrMerged:Z,isInputFocused:X,isAnyDropdownOpen:Y,backgroundComposers:Q,backgroundComposersLoading:ee,deeplinkData:el,onOrchestraStarted:ei}){let ec=(0,S.o)(),ed=(0,y.useGateValue)("platform_workflows")||!1,[eu,em]=(0,d.useState)(240),[ep,ex]=(0,d.useState)(550),[eh,eg]=(0,d.useState)(!1),[eb,ev]=(0,d.useState)(!1),[ey,ew]=(0,d.useState)(!1),[ej,eN]=(0,d.useState)(!0),[eC,ek]=(0,d.useState)(!0),[eI,eS]=(0,d.useState)(!1),[eE,eA]=(0,d.useState)(0),eR=(0,d.useRef)(null),eM=(0,d.useRef)(null),{diffViewMode:eD,setDiffViewMode:eT,prefetchComposerData:eP}=(0,w._F)(),eL=(0,d.useRef)(null),e$=(0,d.useRef)(null),[e_,eU]=(0,d.useState)(!1),[eO,eF]=(0,d.useState)(!1),[ez,eB]=(0,d.useState)(!1),eG=(0,d.useRef)(null),[eW,eq]=(0,d.useState)(!1),eK=(0,d.useRef)(null),eV=(0,d.useRef)(null),[eJ,eZ]=(0,d.useState)(!1);(0,d.useEffect)(()=>{eZ(!1)},[o]),(0,d.useEffect)(()=>{let e=()=>{if(eK.current){let e=eK.current;eq(e.scrollWidth>e.clientWidth)}};e();let t=null;return eK.current&&(t=new ResizeObserver(e)).observe(eK.current),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),t&&t.disconnect()}},[a?.composer?.name]);let[eX,eY]=(0,d.useState)(!1),[eQ,e1]=(0,d.useState)(!1);a?.composer?.status,p.R6.EXPIRED;let e2=(0,d.useMemo)(()=>{if(!a)return!1;let e=a.composer?.bcId;if(!e)return!1;let t=r.get(e),s=!!t?.diff?.diffs?.length,o=!!t?.submoduleDiffs?.some(e=>!e.errored&&e.diff?.diffs?.length);if(t&&(s||o))return s||o;let n=!!a?.diffSinceStart?.diffs?.length,l=a.composer?.status,i=!!(l&&(l===p.R6.FINISHED||l===p.R6.RUNNING||l===p.R6.EXPIRED));return!!(n&&i)},[a,r]),e3=async()=>{if(a?.composer?.bcId)try{await navigator.clipboard.writeText(a.composer.bcId),eU(!0),setTimeout(()=>eU(!1),350)}catch(e){console.error("Failed to copy request ID",e)}},e4=async()=>{if(a?.composer?.branchName)try{await navigator.clipboard.writeText(a.composer.branchName),eF(!0),setTimeout(()=>eF(!1),2e3)}catch(e){console.error("Failed to copy branch name",e)}},e6=e=>{eT(e)},[e8,e9]=(0,d.useState)("");(0,d.useEffect)(()=>{let e=()=>{eM.current&&eA(eM.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,d.useEffect)(()=>{{localStorage.removeItem("agents-left-panel-width");let e=localStorage.getItem("agents-right-panel-width");if(e){let t=Math.max(550,Math.min(1200,parseInt(e,10)));isNaN(t)||ex(t)}}},[]),(0,d.useEffect)(()=>{localStorage.setItem("agents-right-panel-width",ep.toString())},[ep]),(0,d.useEffect)(()=>{if(eC)return void eN(!0);if(c)eN(!1);else{let e=setTimeout(()=>{eN(!0)},151);return()=>clearTimeout(e)}},[c,eC]),(0,d.useLayoutEffect)(()=>{ek(!0)},[o]);let[tt,tr]=(0,d.useState)(null),ts=(0,d.useMemo)(()=>{let t=e8.trim()?e.map(e=>({...e,composers:e.composers.filter(e=>{let t=e8.toLowerCase().trim();return!!(e.name?.toLowerCase().includes(t)||e.repoUrl&&e.repoUrl.split("/").slice(-2).join("/").toLowerCase().includes(t))||!!e.branchName?.toLowerCase().includes(t)})})).filter(e=>e.composers.length>0):e,r=t.flatMap(e=>e.composers),s=r.filter(e=>(e.status??0)===3),o=r.filter(e=>(e.status??0)===5),a=t.filter(e=>"Errored"!==e.name&&"Expired"!==e.name).map(e=>({...e,composers:e.composers.filter(e=>{let t=e.status??0;return 3!==t&&5!==t})})).filter(e=>e.composers.length>0),n=[];return s.length&&n.push({name:"Errored",composers:s}),o.length&&n.push({name:"Expired",composers:o}),[...a,...n]},[e,e8]),[to,ta]=(0,d.useState)(null);(0,d.useEffect)(()=>{if(!a?.composer?.bcId)return void ta(null);let e=r.get(a.composer.bcId);ta((0,A.xH)(a,e))},[a,a?.composer?.bcId,r]);let tn=a?.composer?.isOwnedByDifferentTeamMember===!0,tl=(0,d.useMemo)(()=>{let r=a?.composer?.promptGroupId;if(!r||tn)return[];let s=new Map;Q.forEach(e=>{e.promptGroupId===r&&s.set(e.bcId,e)}),t.forEach(e=>{let t=e.composer;t?.promptGroupId===r&&s.set(t.bcId,t)}),e.forEach(e=>{e.composers.forEach(e=>{e.promptGroupId===r&&s.set(e.bcId,e)})});let o=a?.composer;return o?.promptGroupId===r&&s.set(o.bcId,o),Array.from(s.values()).sort((e,t)=>(e.createdAtMs||0)-(t.createdAtMs||0))},[a?.composer,Q,t,e,tn]),ti=(0,d.useMemo)(()=>tl.filter(e=>!!t.get(e.bcId)?.modelDetails?.modelName?.trim()).slice().sort((e,r)=>t0(e,r,t)),[tl,t]),tc=(0,d.useMemo)(()=>tl.length>1&&ti.length===tl.length,[tl,ti]),td=(0,d.useMemo)(()=>tl.length>1,[tl]),tp=(0,d.useMemo)(()=>!(tl.length<=1)&&tl.some(e=>{let s=t.get(e.bcId),o=r.get(e.bcId),a=(0,A.xH)(s||e,o);return!!(a&&(a.totalAdded>0||a.totalRemoved>0))}),[tl,t,r]);(0,d.useEffect)(()=>{tl.length>1&&tl.forEach(e=>{eP(e.bcId)})},[tl,eP]);let tx=(0,d.useRef)(null);(0,d.useEffect)(()=>{if(!b?.current)return;let e=e=>{if(X||Y||e.metaKey||e.ctrlKey||e.altKey||1!==e.key.length)return;let t=e.target;if(!t)return;let r=t.tagName;if(t.isContentEditable||["INPUT","TEXTAREA","SELECT"].includes(r))return;e.preventDefault(),b.current?.focus();let s=e.key;setTimeout(()=>{b.current?.insertTextAtCursor?.(s)},0)};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[X,Y,b]),(0,d.useEffect)(()=>{tr(null)},[o]),(0,d.useEffect)(()=>{if(c)return;let e=tx.current;e&&requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})},[o,c]),(0,d.useEffect)(()=>{let e=tx.current;if(!e||c)return void eS(!1);let t=()=>{eS(e.scrollTop>100)};return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[c,o]);let th=(0,d.useMemo)(()=>{let t=new Map;return e.forEach(e=>e.composers.forEach(e=>t.set(e.bcId,e))),t},[e]),tf=(0,d.useRef)(null),tg=(0,d.useCallback)(e=>{b.current&&b.current.setPrompt(e)},[b]),tb=(0,d.useRef)(null);return(0,s.jsxs)("div",{className:"flex h-screen w-full",children:[u&&(0,s.jsxs)("div",{ref:tf,tabIndex:0,role:"listbox","aria-activedescendant":tt||o?`composer-${tt||o}`:void 0,onKeyDown:e=>{if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();let t=tf.current;if(!t)return;let r=Array.from(t.querySelectorAll("[data-composer-item]"));if(0===r.length)return;let s=tt||o,a=r.findIndex(e=>e.getAttribute("data-composer-id")===s);-1===a&&(a=0);let n=a+("ArrowDown"===e.key?1:-1);n<0&&(n=r.length-1),n>=r.length&&(n=0);let l=r[n],i=l.getAttribute("data-composer-id");i&&(tr(i),l.scrollIntoView({block:"nearest"}));return}if("Enter"===e.key){if(e.preventDefault(),tt){let e=th.get(tt);e&&(k(e),tr(null))}return}if("Escape"===e.key){e.preventDefault(),tr(null);return}},onClick:e=>{e.target===e.currentTarget&&tf.current?.focus()},className:`relative z-[1] flex flex-none flex-col border-r border-theme-border-02 outline-none focus:outline-none ${!eh?"transition-all duration-150 ease-in-out":""}`,style:{width:`${eu}px`},children:[(0,s.jsx)("div",{className:"absolute bottom-0 top-0 flex cursor-col-resize items-center justify-center",style:{right:"-12px",width:"24px",zIndex:50},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),eg(!0);let t=e.clientX,r=e=>{em(Math.max(120,Math.min(eE>0?Math.max(120,eE-ep-50):400,eu+(e.clientX-t))))},s=()=>{eg(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)},children:(0,s.jsx)("div",{className:"border-theme-border-02 hover:border-theme-border-02-hover h-full w-0.5 transition-colors"})}),(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsxs)("div",{className:"pt-2 px-2 pb-0",children:[(0,s.jsxs)("div",{className:"mb-[14px] pl-2 flex items-center justify-between",children:[(0,s.jsx)(tH.A,{onClick:o?N:void 0,href:o?"/":"https://cursor.com/home?from=agents"}),u&&(0,s.jsx)("button",{type:"button","aria-label":"Toggle left sidebar","aria-pressed":u,"data-tooltip-id":"toggle-left-sidebar","data-tooltip-content":"Toggle left sidebar","data-tooltip-place":"bottom-start",onClick:()=>m(e=>!e),className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none transition-opacity hover:opacity-100 hover:bg-white/5 focus:outline-none",children:(0,s.jsx)(tX,{type:"left",active:u})})]}),(0,s.jsxs)("div",{className:"relative mb-3",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search agents...",value:e8,onChange:e=>e9(e.target.value),className:"h-[32px] w-full rounded-md border placeholder:text-[var(--color-theme-text-secondary)] placeholder:opacity-100 border-theme-border-02 px-[8px] py-[3px] pr-16 web-text-base text-theme-text-primary bg-transparent transition-colors focus:outline-none"}),(0,s.jsxs)("div",{className:"absolute right-1 top-1/2 z-[99] flex -translate-y-1/2 transform items-center gap-0.5",children:[(0,s.jsx)(tz,{filterConfig:g,onFilterConfigChange:P}),(0,s.jsx)(tu,{viewConfig:f,onViewConfigChange:M})]})]}),(0,s.jsxs)("button",{onClick:()=>{o?N():X||b.current?.focus?.()},className:"group flex h-[32px] w-full gap-1 btn outline-none transition-colors duration-200 focus:outline-none",onMouseDown:()=>{eR.current?.startAnimation()},children:[(0,s.jsx)(et,{ref:eR,size:12}),(0,s.jsx)("span",{children:"New Agent"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===Q.length?ee?(0,s.jsx)("div",{className:"flex flex-col gap-3 p-2",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:"h-3 w-20 animate-pulse rounded bg-theme-border opacity-30"}),(0,s.jsx)("div",{className:"flex flex-col gap-1",children:[void 0,void 0].map((e,r)=>(0,s.jsx)("div",{className:"h-8 w-full animate-pulse rounded bg-theme-border opacity-20",style:{animationDelay:`${(2*t+r)*100}ms`}},r))})]},t))}):(0,s.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-4",children:(0,s.jsx)("span",{className:"text-center text-[13px] text-theme-text-secondary",children:"No agents yet"})}):ts.length>0?(0,s.jsx)("div",{className:"flex flex-col gap-2 p-2",children:ts.filter(e=>e.composers.length>0).map(e=>(0,s.jsx)(t2,{section:e,selectedComposerId:o,highlightedComposerId:tt,selectedComposerDiffStats:to,detailedComposers:t,detailedDiffs:r,onSelectComposer:k,onClearHighlight:()=>tr(null),groupBy:f.groupBy},e.name))}):(0,s.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-4",children:(0,s.jsx)("span",{className:"text-center text-[13px] text-theme-text-secondary",children:e8.trim()?"No agents match search":"No agents match filter"})})}),(0,s.jsx)(V.m_,{id:"link-dashboard",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"link-docs",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"link-contact-support",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"settings-button",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"help-menu",noArrow:!0,style:tY}),(0,s.jsx)("div",{className:"flex-shrink-0 p-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between relative",children:[(0,s.jsx)(ea.m,{trigger:(0,s.jsx)("span",{"data-tooltip-id":"settings-button","data-tooltip-content":"Settings","data-tooltip-place":"bottom-end",className:"rounded-[6px] p-1 text-theme-text-secondary opacity-75 p-2 hover:opacity-100",children:(0,s.jsx)(_.A,{className:"h-4 w-4",strokeWidth:1.5})}),items:[{label:(0,s.jsx)("div",{className:"px-2 py-2 w-full",children:(0,s.jsx)(en.s,{tabsClassName:"!w-full"})}),onClick:()=>{},keepOpen:!0,className:"!p-0 hover:!bg-transparent cursor-default"},{label:(0,s.jsx)("div",{className:"flex items-center gap-2 text-theme-text-primary",children:(0,s.jsx)("span",{children:"Dashboard"})}),href:"/dashboard"},...ed?[{label:(0,s.jsx)("div",{className:"flex items-center gap-2 text-theme-text",children:(0,s.jsx)("span",{children:"Platform"})}),href:"/platform"}]:[],{label:(0,s.jsx)("div",{className:"flex items-center gap-2 text-theme-text-primary",children:(0,s.jsx)("span",{children:"Agent Settings"})}),href:"/dashboard?tab=background-agents"}],menuAlign:"left",menuClassName:"rounded-lg bg-theme-bg py-1",buttonClassName:"!border-0 !bg-transparent !p-0"}),(0,s.jsx)(ea.m,{trigger:(0,s.jsx)("span",{"data-tooltip-id":"help-menu","data-tooltip-content":"Help","data-tooltip-place":"bottom-end",className:"rounded-[6px] p-1 text-theme-text-secondary opacity-75 p-2 hover:opacity-100",children:(0,s.jsx)(U.A,{className:"h-4 w-4",strokeWidth:1.5})}),items:[{label:(0,s.jsx)("div",{className:"flex items-center gap-2 text-theme-text-primary",children:(0,s.jsx)("span",{children:"Documentation"})}),href:"https://cursor.com/docs/cloud-agent#cloud-agents"},{label:(0,s.jsx)("div",{className:"flex items-center gap-2 text-theme-text-primary",children:(0,s.jsx)("span",{children:"Email Support"})}),href:"mailto:support@cursor.com"}],menuAlign:"left",menuClassName:"rounded-lg bg-theme-bg py-1",buttonClassName:"!border-0 !bg-transparent !p-0",onOpenChange:E})]})})]})]}),(0,s.jsx)("div",{ref:eM,className:"z-[0] flex h-full flex-1 flex-col overflow-hidden",children:o&&a?(0,s.jsx)("div",{className:"flex h-full flex-col min-h-0",children:(0,s.jsx)(e5.f,{selectedComposer:a,selectedComposerDiffStats:to,selectedComposerId:o,isComposerNotFound:n,prLoading:l,existingPrUrl:i,onOpenInCursor:A.Q1,onOpenExistingPullRequest:$,onOpenPullRequest:J,onPrMerged:Z,viewConfig:f,expandAllRef:eL,collapseAllRef:e$,onImmediateOpenConversation:()=>{ek(!0),c&&C()},conversationScrollRef:tb,isGroup:tc,groupComposerIds:tl.length>1?tl.map(e=>e.bcId):void 0,prMoreMenuRef:eG,onPrMoreMenuToggle:()=>eB(e=>!e),children:({isComposerNotFound:e,HeaderComponent:n,DiffsComponent:l,ConversationComponent:c,EditorComponent:d,isLoading:f,currentConversation:g,hasArtifacts:b})=>{let v=g.filter(e=>e.type===D.Jc.HUMAN).length,y=g.some(e=>e.type===D.Jc.AI);return(0,s.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,s.jsx)("div",{className:"relative flex flex-1 flex-col overflow-hidden",children:(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsxs)("div",{className:"relative flex flex-1 flex-col overflow-hidden",children:[!e&&(0,s.jsx)("div",{className:"border-b border-theme-border-02 pl-4 pr-2 py-[7px] min-h-[40px] flex items-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 w-full ",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 max-w-[calc(100%-50px)]",children:[!u&&(0,s.jsx)("button",{type:"button","aria-label":"Toggle left sidebar","aria-pressed":u,"data-tooltip-id":"toggle-left-sidebar","data-tooltip-content":"Toggle left sidebar","data-tooltip-place":"bottom-start",onClick:()=>m(e=>!e),className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none transition-opacity hover:opacity-100 hover:bg-white/5 focus:outline-none",children:(0,s.jsx)(tX,{type:"left",active:u})}),a?.composer?.repoUrl&&(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1 overflow-hidden",children:[(0,s.jsxs)("a",{href:(0,A.nY)(a.composer.repoUrl,a.composer.branchName),target:"_blank",title:a.composer.repoUrl,rel:"noopener noreferrer",className:"text-xs text-theme-text-secondary hover:text-theme-text-primary transition-colors flex items-center gap-1 flex-shrink-0",children:[(0,s.jsx)("span",{className:"truncate",children:a.composer.repoUrl.split("/").slice(-2).join("/").replace(/\.git$/,"")}),(0,s.jsx)(O.A,{className:"h-3 w-3 flex-shrink-0"})]}),a?.composer?.branchName&&"main"!==a.composer.branchName&&(0,s.jsxs)("button",{type:"button",onClick:e4,className:"group/branch flex items-center gap-1 min-w-0 flex-1 text-xs text-theme-text-secondary hover:text-theme-text-primary transition-colors cursor-pointer",title:"Click to copy branch name",children:[(0,s.jsx)("span",{className:"truncate",children:a.composer.branchName}),eO?(0,s.jsx)(F.A,{className:"h-3 w-3 text-green-600 flex-shrink-0"}):(0,s.jsx)(z.A,{className:"h-3 w-3 flex-shrink-0"})]})]})]}),(e2||b)&&(0,s.jsx)("button",{type:"button","aria-label":"Toggle file pane","aria-pressed":x,"data-tooltip-id":"toggle-file-pane","data-tooltip-content":"Toggle file pane","data-tooltip-place":"bottom-end",onClick:()=>{h(e=>!e),eV.current?.close()},className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none transition-opacity hover:bg-[var(--color-theme-bg-card-hover)] focus:outline-none",children:(0,s.jsx)(tX,{type:"right",active:x})})]})}),e?(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-medium text-white",children:"Background composer not found"}),(0,s.jsx)("div",{className:"web-text-base text-theme-text-secondary",children:"You do not have access to this Background Agent or it does not exist"})]})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[!f&&a?.modelDetails?.modelName&&(!td||tc)&&(0,s.jsxs)("div",{className:"pointer-events-none w-full flex flex-col justify-start items-center relative flex-none shrink-0",children:[(0,s.jsx)("div",{"aria-hidden":"true",className:"absolute inset-0 pointer-events-none bg-[linear-gradient(180deg,_var(--color-theme-bg)_0%,_var(--color-theme-bg)_60%,_transparent_100%)]"}),(0,s.jsxs)("div",{className:"relative flex flex-col gap-2 w-full justify-center items-center max-w-[720px] px-4 pt-3 pb-2 pointer-events-auto",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-0 min-w-0 w-full",children:[(0,s.jsx)("div",{className:"group relative flex items-center min-w-0 hover:text-theme-text-primary",...eW&&{"data-tooltip-id":"composer-name-tooltip","data-tooltip-content":a?.composer?.name||"New Cloud Agent"},children:(0,s.jsx)("span",{ref:eK,className:"text-xl font-medium text-theme-text-primary line-clamp-2",style:{letterSpacing:"-0.32px"},children:a?.composer?.name||"New Cloud Agent"})}),(!td||tc)&&(0,s.jsx)("div",{className:"mt-1",children:n})]}),td&&tc&&(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)("div",{style:{width:"calc(100% + 16px)",marginLeft:"-8px"},children:(0,s.jsx)(e7,{tabs:ti.map(e=>{var o;let a=t.get(e.bcId),n=r.get(e.bcId),l=(0,A.xH)(a||e,n),i=null,c=l&&(l.totalAdded>0||l.totalRemoved>0),d=e.status??p.R6.UNSPECIFIED,u=d===p.R6.CREATING||d===p.R6.RUNNING;if(u){let t=Number(e.updatedAtMs||e.createdAtMs||0);i=t>0?(0,s.jsx)(t1,{startTime:t}):(0,s.jsx)("span",{children:"Running..."})}else if(c){let e=l.fileCount||0;i=(0,s.jsxs)("span",{className:"flex items-center gap-1 tabular-nums",children:[e>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:[e," ",1===e?"file":"files"]}),(l.totalAdded>0||l.totalRemoved>0)&&(0,s.jsx)("span",{className:"text-theme-text-tertiary",children:"\xb7"})]}),l.totalAdded>0&&(0,s.jsxs)("span",{className:"text-green-600 dark:text-green-500",children:["+",l.totalAdded]}),l.totalRemoved>0&&(0,s.jsxs)("span",{className:"text-red-600 dark:text-red-500",children:["-",l.totalRemoved]})]})}else i=(0,s.jsx)("span",{children:"Task completed"});let m=!!e.prUrl&&d!==p.R6.EXPIRED,x=null;return u?x=(0,s.jsx)(er,{size:14,className:"text-theme-text-secondary"}):m&&(x=(0,s.jsx)(tG.K,{prUrl:e.prUrl,size:"sm",showTooltip:!0})),{id:e.bcId,label:(o=a?.modelDetails?.modelName,(0,eH.$L)(o)),subtitle:i,statusIcon:x}}),activeTabId:o||"",onChange:e=>{if(e!==o){let t=ti.find(t=>t.bcId===e);t&&k(t)}}})})})]})]}),(0,s.jsx)("div",{className:"relative flex-1 overflow-y-auto flex flex-col min-h-0",ref:tb,children:f?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)(es.m,{})}):(0,s.jsxs)(s.Fragment,{children:[!td&&a?.modelDetails?.modelName&&(0,s.jsxs)("div",{className:"px-6 max-w-[720px] mx-auto w-full mt-3 mb-2",children:[(0,s.jsx)(te.o,{modelName:a.modelDetails.modelName,isDiffLoading:f||!r.get(a.composer?.bcId??""),diffStats:to,updatedFilenamesCount:to?.fileCount??0,existingPrUrl:i,source:a.composer?.source}),a.summary&&(0,s.jsx)("div",{className:"mt-3 mb-0",children:(0,s.jsx)("div",{className:"text-[12px] text-theme-text-secondary break-words overflow-wrap-anywhere [&_strong]:text-theme-text-primary [&_strong]:font-semibold",children:(0,s.jsx)(K.oz,{children:a.summary})})})]}),td&&tc&&a?.summary&&(()=>{let e=(a.summary?.replace(/\*\*/g,"").replace(/`/g,"").trim()||"").length>120;return(0,s.jsxs)("div",{className:"px-6 max-w-[720px] mx-auto w-full mt-2 mb-2",children:[eJ?(0,s.jsx)("div",{className:"text-[12px] text-theme-text-secondary break-words overflow-wrap-anywhere [&_strong]:text-theme-text-primary [&_strong]:font-semibold",children:(0,s.jsx)(K.oz,{children:a.summary})}):(0,s.jsx)("div",{className:"text-[12px] text-theme-text-secondary break-words overflow-wrap-anywhere line-clamp-2 [&_strong]:text-theme-text-primary",children:(0,s.jsx)(K.oz,{children:a.summary})}),e&&(0,s.jsx)("button",{onClick:()=>eZ(!eJ),className:"text-theme-text-primary transition-colors mt-1",style:{fontSize:"12px",fontStyle:"normal",fontWeight:"400",lineHeight:"16px"},children:eJ?"Less":"More"})]})})(),(!td||tc)&&c,a.composer?.status===p.R6.CREATING&&1===v&&!y&&(0,s.jsx)("div",{className:"flex flex-col -mt-16 px-6 pb-4",children:(0,s.jsx)("div",{className:"w-full max-w-[720px] mx-auto",children:(0,s.jsx)(tE,{composerId:o||void 0})})}),(0,s.jsx)("div",{className:"flex-1"})]})}),(!td||tc)&&(0,s.jsx)("div",{className:"flex-shrink-0 w-full justify-center items-center px-0 pb-2",children:d})]})})]}),x&&(e2||b||td&&tp)&&(0,s.jsxs)("div",{className:`relative flex flex-none flex-col border-l border-theme-border-02 ${!eb?"transition-all duration-150 ease-in-out":""}`,style:{width:`${ep}px`},children:[(0,s.jsx)("div",{className:"absolute bottom-0 top-0 flex cursor-col-resize items-center justify-center",style:{width:"24px",zIndex:50},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),ev(!0),ew(!1);let t=e.clientX,r=e=>{ex(Math.max(200,Math.min(eE>0?Math.max(200,eE-eu-50):600,ep+(t-e.clientX)))),ew(!0)},s=()=>{ev(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)},children:(0,s.jsx)("div",{className:"border-theme-border-02 hover:border-theme-border-02-hover h-full w-0.5 transition-colors"})}),(0,s.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:e2||b?l:(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-6",children:(0,s.jsx)("div",{className:"web-text-base text-theme-text-secondary",children:"No changes made"})})})})]})]})})})}})}):o&&!n?(0,s.jsxs)("div",{className:"flex h-full flex-col ",children:[!u&&(0,s.jsx)("div",{className:"absolute top-2 left-2 z-[60]",children:(0,s.jsx)("button",{type:"button","aria-label":"Toggle left sidebar","aria-pressed":u,onClick:()=>m(e=>!e),className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none hover:bg-[var(--color-theme-bg-card-hover)] focus:outline-none",children:(0,s.jsx)(tX,{type:"left",active:u})})}),(0,s.jsx)("div",{className:"flex h-full w-full flex-1 flex-col items-center justify-center overflow-hidden px-4",children:(0,s.jsx)(es.m,{})})]}):o&&n?(0,s.jsxs)("div",{className:"flex h-full flex-col ",children:[(0,s.jsxs)("div",{className:`flex flex-shrink-0 items-center justify-between p-4 ${ec?"pt-2":"pt-6"}`,children:[(0,s.jsx)("div",{className:"flex flex-1"}),!u&&(0,s.jsx)("div",{className:"absolute top-1 left-2 z-[60]",children:(0,s.jsx)("button",{type:"button","aria-label":"Toggle left sidebar","aria-pressed":u,onClick:()=>m(e=>!e),className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none transition-opacity hover:opacity-100 focus:outline-none",children:(0,s.jsx)(tX,{type:"left",active:u})})}),(0,s.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2",children:[(0,s.jsx)("a",{href:"/dashboard",className:"cursor-pointer web-text-base text-theme-text-secondary transition-colors hover:text-theme-text-primary",children:"Dashboard"}),ed&&(0,s.jsx)("a",{href:"/platform",className:"cursor-pointer web-text-base text-theme-text-secondary transition-colors hover:text-theme-text-primary",children:"Platform"}),(0,s.jsx)(eo.i,{})]})]}),(0,s.jsx)("div",{className:"flex w-full flex-1 items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-[16px] font-medium text-theme-text-primary",children:"Cloud Agent not found"}),(0,s.jsx)("div",{className:"web-text-base text-theme-text-secondary",children:"You do not have access to this Cloud Agent or it does not exist"}),(0,s.jsx)("button",{onClick:N,className:"mt-4 inline-flex w-fit items-center justify-center rounded-md border border-theme-border-02 px-4 py-2 web-text-base font-medium text-theme-text-primary outline-none ring-0 transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})})]}):(0,s.jsxs)("div",{className:"flex h-full flex-col ",children:[(0,s.jsxs)("div",{className:`flex flex-shrink-0 items-center justify-between p-4 ${ec?"pt-2":"pt-2 "}`,children:[!u&&(0,s.jsx)("div",{className:"flex items-center gap-2 z-[60] ml-2",children:(0,s.jsx)("button",{type:"button","aria-label":"Toggle left sidebar","aria-pressed":u,onClick:()=>m(e=>!e),className:"flex cursor-pointer items-center gap-2 rounded-[6px] p-1 text-theme-text-secondary outline-none transition-opacity hover:opacity-100 focus:outline-none",children:(0,s.jsx)(tX,{type:"left",active:u})})}),(0,s.jsx)("div",{className:"flex flex-1"}),(0,s.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2 justify-end",children:[(0,s.jsx)("a",{href:"/dashboard",className:"flex cursor-pointer items-center web-text-base text-theme-text-secondary px-2 py-1 rounded-full transition-colors hover:text-theme-text-primary",children:(0,s.jsx)(T.o5,{className:"web-text-base",children:"Dashboard"})}),ed&&(0,s.jsx)("a",{href:"/platform",className:"cursor-pointer web-text-base text-theme-text-secondary px-2 py-1 rounded-full transition-colors hover:text-theme-text-primary",children:(0,s.jsx)(T.o5,{className:"web-text-base",children:"Platform"})}),(0,s.jsx)(eo.i,{})]})]}),!o&&(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,s.jsx)("div",{className:"w-full max-w-[640px] px-8 pb-[200px]",children:(0,s.jsxs)("div",{"data-fullscreen-input":!0,children:[(0,s.jsx)(e0,{onFocusChange:I,onDropdownOpenChange:E,onBeforeSubmit:R,deeplinkData:el,viewConfig:f,onViewConfigChange:M,filterConfig:g,onFilterConfigChange:P,inputRef:b,githubConnected:v,onConnectGithub:L,githubError:j,hasOpenModal:!1,isFloating:!0,isFollowUp:!1,onOrchestraStarted:ei}),0===Q.length&&!ee&&(0,s.jsx)(tw,{onChipClick:tg})]})})})]})}),(0,s.jsx)(V.m_,{id:"pr-status-tooltip",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"composer-name-tooltip",place:"bottom-start",noArrow:!0,style:tY}),(0,s.jsx)(V.m_,{id:"branch-name-tooltip",place:"bottom-start",noArrow:!0,style:{...tY,maxWidth:"600px",wordBreak:"break-all"}}),(0,s.jsx)(V.m_,{id:"toggle-left-sidebar",noArrow:!0,style:{...tY,zIndex:9999}}),(0,s.jsx)(V.m_,{id:"toggle-file-pane",noArrow:!0,style:tY,ref:eV}),(0,s.jsx)(V.m_,{id:"settings-button",noArrow:!0,style:tY}),(0,s.jsx)(tm.A,{isOpen:eX,bcIds:tl.length>1?tl.map(e=>e.bcId):a?.composer?.bcId?[a.composer.bcId]:[],onClose:()=>eY(!1),onSuccess:async()=>{N?.()}}),(0,s.jsx)(tB.Z,{isOpen:eQ,onClose:()=>e1(!1),composerName:a?.composer?.name,composerId:a?.composer?.bcId}),a&&(0,s.jsxs)(ef.W1,{open:ez,onClose:()=>eB(!1),align:"left",width:220,minWidth:220,zIndex:50,origin:"top-left",backdrop:!0,triggerRef:eG,children:[(0,s.jsx)(ef.Dr,{onClick:()=>{window.open("/dashboard?tab=background-agents","_blank"),eB(!1)},icon:(0,s.jsx)(_.A,{size:16}),label:"Configure agents"}),(0,s.jsx)("div",{className:"my-1 h-px bg-[var(--color-theme-border-secondary)]"}),(0,s.jsx)(ef.Dr,{onClick:()=>{e1(!0),eB(!1)},icon:(0,s.jsx)(B.A,{size:16}),label:"Share link"}),!a?.composer?.isArchived&&!a?.composer?.isOwnedByDifferentTeamMember&&(0,s.jsx)(ef.Dr,{onClick:()=>{eY(!0),eB(!1)},icon:(0,s.jsx)(G.A,{size:16}),label:"Delete agent",type:"destructive"}),(0,s.jsx)("div",{className:"my-1 h-px bg-[var(--color-theme-border-secondary)]"}),(0,s.jsx)(ef.Dr,{onClick:()=>{e6("unified")},icon:(0,s.jsx)(H.A,{}),label:"Unified view",rightSlot:"unified"===eD?(0,s.jsx)(F.A,{className:"size-3"}):null}),(0,s.jsx)(ef.Dr,{onClick:()=>{e6("split")},icon:(0,s.jsx)(W.A,{}),label:"Split view",rightSlot:"split"===eD?(0,s.jsx)(F.A,{className:"size-3"}):null}),(0,s.jsx)("div",{className:"my-1 h-px bg-[var(--color-theme-border-secondary)]"}),(0,s.jsx)(ef.Dr,{onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),e3()},onClick:e=>{e.preventDefault(),e.stopPropagation()},icon:e_?(0,s.jsx)(F.A,{size:16}):(0,s.jsx)(z.A,{size:16}),label:"Copy request ID"}),(0,s.jsx)(ef.Dr,{onClick:()=>{let e=`Feedback ${a?.composer?.bcId?`[${a.composer.bcId}]`:""}`,t=`mailto:background-agent-feedback@cursor.com?subject=${encodeURIComponent(e)}`;window.open(t,"_blank"),eB(!1),eB(!1)},icon:(0,s.jsx)(q.A,{}),label:"Send feedback"})]})]})}var t3=r(84235),t4=r(79359),t6=r(13283);function t8({isOpen:e,onClose:t}){let r=(0,S.o)(),[o,a]=(0,d.useState)(!1),n=(0,d.useRef)(null),l=(0,d.useRef)(null),i=(0,d.useCallback)(()=>{a(!1),l.current=setTimeout(()=>{t(),l.current=null},150)},[t]),c=(0,d.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),i()},[i]);if((0,d.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i())};if(e)return document.addEventListener("keydown",t,{capture:!0}),()=>{document.removeEventListener("keydown",t,{capture:!0})}},[e,i]),(0,d.useEffect)(()=>{if(e)return document.body.style.overflow="hidden",n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{a(!0),n.current=null},10),()=>{document.body.style.overflow=""};a(!1)},[e]),(0,d.useEffect)(()=>()=>{n.current&&clearTimeout(n.current),l.current&&clearTimeout(l.current)},[]),!e)return null;let u=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:`fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ${o?"opacity-100":"opacity-0"}`,onPointerDown:c,onClick:c,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,s.jsx)("div",{className:`fixed z-[9999] w-full transition-all duration-150 ease-out max-sm:bottom-0 max-sm:left-0 max-sm:right-0 max-sm:top-0 sm:left-1/2 sm:top-1/2 sm:max-w-lg sm:-translate-x-1/2 sm:-translate-y-1/2 ${o?"opacity-100 max-sm:translate-y-0 sm:scale-100":"opacity-0 max-sm:translate-y-full sm:scale-95"}`,children:(0,s.jsxs)("div",{className:`pointer-events-auto mx-4 overflow-hidden rounded-[12px] bg-[#141414] shadow-lg max-sm:mx-0 max-sm:flex max-sm:h-full max-sm:flex-col sm:mx-0 ${r?"pb-[env(safe-area-inset-bottom)]":""}`,style:{boxShadow:"0px 0px 2px 0px rgba(255, 255, 255, 0.08) inset, 0px 0px 2px 0px rgba(0, 0, 0, 0.25), 0px 12px 24px 0px rgba(0, 0, 0, 0.24), 0px 20px 40px 0px rgba(0, 0, 0, 0.12)"},onPointerDown:e=>e.stopPropagation(),children:[(0,s.jsx)("button",{onClick:i,className:"absolute right-4 top-4 z-[9999] rounded-full bg-black/20 p-2 backdrop-blur-[10px] transition-colors hover:bg-black/40",style:{pointerEvents:"auto"},children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 4L4 12M4 4L12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white"})})}),(0,s.jsx)("div",{className:"aspect-video relative w-full",children:(0,s.jsx)("iframe",{src:"https://www.youtube.com/embed/hHTKtrSO6os?controls=0&modestbranding=1&showinfo=0&rel=0&iv_load_policy=3&disablekb=1&showinfo=0&controls=0&autohide=1",title:"Announcement Video",className:"h-full min-h-[288px] w-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsx)("p",{className:"font-regular text-[11px] text-theme-text-secondary",children:"New"}),(0,s.jsx)("h2",{className:"mb-6 text-[16px] font-medium text-gray-300",children:"Cursor Agents on Web"})]}),(0,s.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full",children:(0,s.jsx)(t3.A,{className:"h-4 w-4 text-theme-text-secondary"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-300",children:"Work across devices"}),(0,s.jsx)("p",{className:"text-[12px] text-theme-text-secondary",children:"Run agents from any device with seamless handoff to desktop"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full",children:(0,s.jsx)(t4.A,{className:"h-4 w-4 text-theme-text-secondary"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-300",children:"Team collaboration"}),(0,s.jsx)("p",{className:"text-[12px] text-theme-text-secondary",children:"Share links with team members to review and collaborate"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full",children:(0,s.jsx)(t6.A,{className:"h-4 w-4 text-theme-text-secondary"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-300",children:"Slack integration"}),(0,s.jsx)("p",{className:"text-[12px] text-theme-text-secondary",children:"Trigger agents with @Cursor or get notified when agents finish"})]})]})]}),(0,s.jsx)("div",{className:"flex flex-1 items-end gap-2",children:(0,s.jsx)("button",{onClick:i,className:"w-full rounded-lg bg-[#81a1c1] px-4 py-2.5 text-[12px] font-medium text-[#191C22] transition-colors hover:bg-[#81a1c1]/80",children:"Get started"})})]})]})})]});return(0,eR.createPortal)(u,document.body)}var t9=r(73749);let t7={times:[0,.4,1],duration:.5},re={normal:{x:0},animate:{x:[0,-1.5,0]}},rt=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),(0,s.jsx)("path",{d:"M15 3v18"}),(0,s.jsx)(Z.P.path,{transition:t7,variants:re,animate:l,d:"m10 15-3-3 3-3"})]})})});rt.displayName="PanelRightOpenIcon";var rr=r(87804),rs=r(39862);function ro({isOpen:e,onClose:t,diffViewMode:r,onViewModeToggle:o,onExpandAll:a,onCollapseAll:n,onCopyRequestId:l,onSendFeedback:i,selectedComposerBcId:c,isCopied:u,triggerRef:m}){let[p,x]=(0,d.useState)(!1),[h,f]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{if(e){f(!0);let e=setTimeout(()=>{x(!0)},10);return()=>clearTimeout(e)}{x(!1);let e=setTimeout(()=>{f(!1)},150);return()=>clearTimeout(e)}},[e]),(0,d.useEffect)(()=>{if(e){let e=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),t())};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}}},[e,t]),h)?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(ef.W1,{open:e,onClose:t,align:"right",minWidth:220,zIndex:0x3b9ac9ff,origin:"top-right",triggerRef:m,children:[(0,s.jsxs)("button",{onClick:()=>o("unified"),className:"group flex w-full cursor-pointer items-center justify-between rounded-[6px] p-2 px-2.5 outline-none hover:bg-white/5 focus:outline-none",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(H.A,{size:14,className:"text-theme-text-secondary"}),(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Unified view"})]}),"unified"===r&&(0,s.jsx)(F.A,{className:"h-4 w-4 text-gray-300"})]}),(0,s.jsxs)("button",{onClick:()=>o("split"),className:"group flex w-full cursor-pointer items-center justify-between rounded-[6px] p-2 px-2.5 outline-none hover:bg-white/5 focus:outline-none",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(W.A,{size:14,className:"text-theme-text-secondary"}),(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Split view"})]}),"split"===r&&(0,s.jsx)(F.A,{className:"h-4 w-4 text-gray-300"})]}),(0,s.jsx)("div",{className:"my-1 h-px bg-gray-300/5"}),(0,s.jsx)("button",{onClick:a,className:"group flex w-full cursor-pointer items-center justify-between rounded-[6px] p-2 px-2.5 outline-none hover:bg-white/5 focus:outline-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(rs.p,{size:14,className:"text-theme-text-secondary"}),(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Expand all"})]})}),(0,s.jsx)("button",{onClick:n,className:"group flex w-full cursor-pointer items-center justify-between rounded-[6px] p-2 px-2.5 outline-none hover:bg-white/5 focus:outline-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(rr.f,{size:14,className:"text-theme-text-secondary"}),(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Collapse all"})]})}),(0,s.jsx)("div",{className:"my-1 h-px bg-gray-300/5"}),(0,s.jsx)("button",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),l()},onClick:e=>{e.preventDefault(),e.stopPropagation()},disabled:!c,className:"group flex w-full cursor-pointer items-center justify-between rounded-[6px] p-2 px-2.5 outline-none hover:bg-white/5 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[u?(0,s.jsx)(F.A,{className:"h-4 w-4 text-theme-text-secondary opacity-60 transition-opacity group-hover:opacity-100"}):(0,s.jsx)(z.A,{className:"h-4 w-4 text-theme-text-secondary opacity-60 transition-opacity group-hover:opacity-100"})," ",(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Copy request ID"})]})}),(0,s.jsx)("button",{onClick:i,className:"flex w-full items-center justify-between rounded-[6px] p-2 px-2.5 web-text-base text-gray-300 outline-none hover:bg-white/5 focus:outline-none",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(q.A,{size:14,className:"text-theme-text-secondary"}),(0,s.jsx)("span",{className:"web-text-base font-medium text-gray-300",children:"Send feedback"})]})})]})}):null}var ra=r(59991);function rn({activeTab:e,selectedComposer:t,isConversationLoading:r,isConversationCollapsed:o,onToggleCollapse:a,onFilenameClick:n,isResizing:l,setIsResizing:i}){let{getConversationForAgent:c,getToolStatusForAgent:u,logs:m,detailedDiffs:p,isStreamingConversationEnabled:x}=(0,w._F)(),[h,f]=(0,d.useState)(!1),[g,b]=(0,d.useState)(!0),[v,y]=(0,d.useState)(()=>{{let e=localStorage.getItem("background-composer-sidebar-width");return e?Math.max(254,Math.min(600,parseInt(e,10))):400}}),[j,N]=(0,d.useState)(!1),C=function(){let[e,t]=(0,d.useState)(window.innerWidth);return(0,d.useEffect)(()=>{let e=()=>t(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}()>=1024,k=(0,d.useMemo)(()=>{if(!t)return!1;let e=t.composer?.bcId;if(!e)return!1;let r=!!t?.diffSinceStart?.diffs?.length;if(p.has(e)){let t=p.get(e),r=!!t?.diff?.diffs?.length,s=!!t?.submoduleDiffs?.some(e=>!e.errored&&e.diff?.diffs?.length);return r||s}return r},[t,p]);(0,d.useEffect)(()=>{f(!0)},[]),(0,d.useEffect)(()=>{localStorage.setItem("background-composer-sidebar-width",v.toString())},[v]),(0,d.useEffect)(()=>{if(!C)return void b(!0);if(o)b(!1);else{let e=setTimeout(()=>{b(!0)},151);return()=>clearTimeout(e)}},[o,C]);let I=(0,d.useMemo)(()=>c(t?.composer?.bcId||""),[c,t?.composer?.bcId]),S=(0,d.useMemo)(()=>{if(t?.composer?.bcId)return u(t.composer.bcId)},[u,t?.composer?.bcId]),E=(0,d.useMemo)(()=>!!t?.composer?.bcId&&x(t.composer.bcId),[x,t?.composer?.bcId]),A=(0,d.useMemo)(()=>m.get(t?.composer?.bcId||"")||[],[m,t?.composer?.bcId]),R=(0,d.useMemo)(()=>{if(!t)return!1;let e=!t.summary,r=!k,s=A.length>0,o=I.filter(e=>!e.isTemporary),a=o.filter(e=>e.type===D.Jc.HUMAN).length,n=o.filter(e=>e.type===D.Jc.AI).length,l=1===o.length&&1===a,i=2===o.length&&1===a&&1===n;return e&&r&&s&&(l||i)},[t,k,A.length,I]);if(!C&&!("conversation"===e||C))return null;let M=t?.composer?.isKilled;if(!C)return(0,s.jsx)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:(0,s.jsxs)("div",{className:"flex h-full flex-col px-10 py-2 pb-6",children:[(0,s.jsx)(ra.Ay,{conversation:I,logs:A,isLoading:r,hasComposer:!!t,hasDiff:k,inSidebar:!0,onFilenameClick:n,isComposerKilled:t?.composer?.isKilled,hasStartedVm:t?.composer?.hasStartedVm,isLogStreaming:E,toolStatus:S}),R?(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(ra.qj,{logs:A})}):null,(0,s.jsx)("div",{className:"transition-opacity duration-200",children:(0,s.jsx)("div",{children:!h||r||M?null:(0,s.jsx)("div",{className:"mt-4 w-full",children:(0,s.jsx)(e0,{isFollowUp:!0,customPlaceholder:"Follow up with this agent...",hideDropdowns:!0,hideFooterButtons:!1,selectedComposer:t,hasOpenModal:!0})})})})]})});let T=o?0:v;return(0,s.jsxs)("div",{className:`relative h-full ${!l?"transition-all duration-150 ease-in-out":""}`,style:{width:`${T}px`},children:[!o&&(0,s.jsx)("div",{className:"absolute bottom-0 top-0 flex cursor-col-resize items-center justify-center",style:{width:"12px",zIndex:50},onClick:e=>{e.stopPropagation(),j||a(),N(!1)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),i(!0),N(!1);let t=e.clientX,r=e=>{y(Math.max(254,Math.min(600,v+(t-e.clientX)))),N(!0)},s=()=>{i(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)},children:(0,s.jsx)("div",{className:"bg-border-theme-border-02 hover:bg-border-theme-border-02-hover h-full w-0.5 transition-colors"})}),(0,s.jsx)("div",{className:"flex h-full flex-col overflow-hidden",style:{opacity:+!o,pointerEvents:o?"none":"auto"},children:(0,s.jsxs)("div",{className:"flex h-full flex-col transition-opacity delay-0",style:{opacity:+!!g},children:[(0,s.jsx)(ra.Ay,{conversation:I,logs:A,isLoading:r,hasComposer:!!t,hasDiff:k,inSidebar:!0,onFilenameClick:n,isComposerKilled:t?.composer?.isKilled,hasStartedVm:t?.composer?.hasStartedVm,isLogStreaming:E,toolStatus:S}),R?(0,s.jsx)("div",{className:"p-2 pt-0",children:(0,s.jsx)(ra.qj,{logs:A})}):null,(0,s.jsx)("div",{className:"mt-auto transition-opacity duration-200",style:{opacity:+!!g},children:(0,s.jsx)("div",{className:"p-2 pt-0",children:h&&!r&&(t?.composer?.isKilled?null:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(e0,{isFollowUp:!0,customPlaceholder:"Follow up with this agent...",hideDropdowns:!0,hideFooterButtons:!1,selectedComposer:t,hasOpenModal:!0})}))})})]})})]})}var rl=r(85913),ri=r(56392);function rc({activeTab:e,setActiveTab:t}){let r=(0,S.o)(),o=(0,d.useRef)(null),a=(0,d.useRef)(null);return(0,d.useEffect)(()=>{let t=()=>{let t=o.current;if(e&&t){let e=a.current;if(e){let{offsetLeft:s,offsetWidth:o}=e;t.style.clipPath=`inset(0 ${Number(100-(s+o)/t.offsetWidth*100).toFixed()}% 0 ${Number(s/t.offsetWidth*100).toFixed()}% round ${r?"100px":"6px"})`}}},s=requestAnimationFrame(()=>{t()});return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),cancelAnimationFrame(s)}},[e,a,o,r]),(0,s.jsx)("div",{className:`relative w-full ${r?"py-2":"pt-4"}`,children:(0,s.jsx)("ul",{className:"relative flex gap-3 justify-center",children:rd.map(o=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{ref:e===o.name?a:null,"data-tab":o.name,onMouseDown:()=>{t(o.name)},className:`flex items-center rounded-md ${e===o.name?"bg-theme-card-02-hex border-theme-border-03":"text-theme-text-secondary"} ${r?"justify-center web-text-base":"text-[11px]"} items-center gap-1 px-3 py-2  no-underline`,children:[o.icon,o.displayName]})},o.name))})})}let rd=[{name:"code",displayName:"Diff",icon:(0,s.jsx)(rl.A,{size:14})},{name:"conversation",displayName:"Chat",icon:(0,s.jsx)(ri.A,{size:14})}];function ru({selectedComposerId:e,isModalVisible:t,handleCloseModal:r,isConversationCollapsed:o,isConversationLoading:a,selectedComposer:n,selectedComposerDiffStats:l,isComposerNotFound:i,prLoading:c,existingPrUrl:u,onOpenInCursor:m,onOpenExistingPullRequest:p,onOpenPullRequest:x,handleCollapseConversation:h,onSelectPrevious:f,onSelectNext:g,hasPrevious:b,hasNext:v,onPrMerged:y}){let j=(0,d.useRef)(null),N=(0,d.useRef)(null),C=(0,d.useRef)(null),{diffViewMode:k,setDiffViewMode:I}=(0,w._F)(),[S,E]=(0,d.useState)(!1),A=(0,d.useRef)(null),R=(0,d.useRef)(null),[M,D]=(0,d.useState)(!1),[T,L]=(0,d.useState)(!1),[$,_]=(0,d.useState)(!1),U=(0,d.useRef)(null),[O,F]=(0,d.useState)(()=>{{let e=localStorage.getItem("background-composer-sidebar-width");return e?Math.max(254,Math.min(600,parseInt(e,10))):400}});(0,d.useEffect)(()=>{let e=()=>{{let e=localStorage.getItem("background-composer-sidebar-width");F(e?Math.max(254,Math.min(600,parseInt(e,10))):400)}};window.addEventListener("storage",e);let t=setInterval(e,100);return()=>{window.removeEventListener("storage",e),clearInterval(t)}},[]),(0,d.useEffect)(()=>{_(!0);let e=setTimeout(()=>{_(!1)},150);return()=>clearTimeout(e)},[o]);let z=n?.composer?.isOwnedByDifferentTeamMember??!1,B=async()=>{if(n?.composer?.bcId)try{await navigator.clipboard.writeText(n.composer.bcId),L(!0),setTimeout(()=>L(!1),350)}catch(e){console.error("Failed to copy request ID:",e)}},G=()=>{let e=`Feedback ${n?.composer?.bcId?`[${n?.composer?.bcId}]`:""}`,t=`mailto:background-agent-feedback@cursor.com?subject=${encodeURIComponent(e)}`;window.open(t,"_blank"),D(!1)},H=e=>{I(e)},W=()=>{A.current&&A.current()},q=()=>{R.current&&R.current()},K=(0,d.useRef)([]);return(0,ti.vC)("arrowleft, j",()=>{b&&f&&f()},{enabled:null!==e&&t&&!z,enableOnFormTags:!1,preventDefault:!0},[e,t,b,f,z]),(0,ti.vC)("arrowright, k",()=>{v&&g&&g()},{enabled:null!==e&&t&&!z,enableOnFormTags:!1,preventDefault:!0},[e,t,v,g,z]),(0,s.jsx)("div",{className:`fixed inset-0 flex items-center justify-center duration-300 ${e&&t?"pointer-events-auto z-50 bg-black/50 opacity-100":"pointer-events-none -z-[1] opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:r,children:(0,s.jsx)(e5.f,{selectedComposer:n,selectedComposerDiffStats:l,selectedComposerId:e,isComposerNotFound:i,prLoading:c,existingPrUrl:u,onOpenInCursor:m,onOpenExistingPullRequest:p,onOpenPullRequest:x,onCloseModal:r,onPrMerged:y,expandAllRef:A,collapseAllRef:R,conversationScrollRef:j,children:({activeTab:i,setActiveTab:c,isComposerNotFound:d,currentConversation:u,currentLogs:m,hasComposer:p,isLoading:x,handleFilenameClick:y,HeaderComponent:w,DiffsComponent:I,TerminalLogsComponent:A,ConversationComponent:R,EditorComponent:L})=>{K.current=m;let _=!n?.summary&&m&&m.length>0&&p&&!u.some(e=>!e.isTemporary)&&(!l||0===l.totalAdded&&0===l.totalRemoved),F=!n?.summary&&p&&!u.some(e=>!e.isTemporary)&&(!l||0===l.totalAdded&&0===l.totalRemoved)&&!d&&(!m||0===m.length);return(0,s.jsxs)("div",{className:"flex h-[85vh] w-[90vw] max-w-7xl flex-col overflow-hidden rounded-[20px] border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] shadow-2xl lg:duration-300",style:{pointerEvents:e&&t?"auto":"none",transitionProperty:e&&t?"opacity, transform":"",transitionDuration:"150ms",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transform:e&&t?"scale(1)":"scale(0.95)",zIndex:e&&t?1e3:-10,opacity:e&&t?1:0},onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{ref:j,className:`flex-1 ${!o&&!a?"overflow-hidden":"overflow-y-auto"}`,children:(0,s.jsxs)("div",{className:"flex h-full flex-col lg:flex-row",children:[(0,s.jsxs)("div",{ref:N,className:`flex flex-1 flex-col gap-0 ${!o&&!a?"overflow-y-auto border-white/10 lg:border-r":""}`,children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 flex flex-shrink-0 items-center justify-between bg-[#17191D] p-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:r,className:"flex cursor-pointer items-center gap-2 p-1 text-white opacity-60 transition-opacity hover:opacity-100",children:(0,s.jsx)(ej.A,{className:"h-4 w-4"})}),!z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:f,disabled:!b,className:`flex items-center justify-center gap-2 p-1 text-white transition-opacity ${!b?"cursor-default opacity-30":"cursor-pointer opacity-60 hover:opacity-100"}`,children:(0,s.jsx)(tP.A,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:g,disabled:!v,className:`flex items-center justify-center gap-2 p-1 text-white transition-opacity ${!v?"cursor-default opacity-30":"cursor-pointer opacity-60 hover:opacity-100"}`,children:(0,s.jsx)(t9.A,{className:"h-4 w-4"})})]})]})}),(0,s.jsx)("div",{className:"flex flex-1 flex-col gap-1 pt-0 lg:min-h-0",children:d?(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-medium text-white",children:"Cloud Agent not found"}),(0,s.jsx)("div",{className:"web-text-base text-theme-text-primary",children:"You do not have access to this Cloud Agent or it does not exist"}),(0,s.jsx)("button",{onClick:r,className:"mt-4 inline-flex w-fit items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white outline-none ring-0 transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})}):(0,s.jsxs)(s.Fragment,{children:[w,(0,s.jsxs)("div",{className:"flex h-full flex-1 flex-col gap-1 lg:min-h-0",children:[(0,s.jsx)("div",{className:"relative flex flex-shrink-0 justify-center sm:justify-start lg:hidden",children:(0,s.jsx)(rc,{activeTab:i,setActiveTab:c})}),(_||F)&&(_?A:(0,s.jsx)(tE,{composerId:e||void 0})),!_&&!F&&I,"conversation"===i&&!_&&!F&&(0,s.jsx)("div",{className:"flex flex-1 flex-col px-10 py-5 lg:hidden",children:(0,s.jsx)("div",{className:"flex-1",children:R})})]})]})})]}),!a&&!_&&!F&&u.length>0&&(0,s.jsx)("div",{className:"hidden lg:block","data-conversation-chat":!0,children:(0,s.jsx)(rn,{activeTab:i,onToggleCollapse:h,selectedComposer:n??null,isConversationCollapsed:o,isConversationLoading:x,onFilenameClick:y,isResizing:S,setIsResizing:E})})]})}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:`absolute top-2 z-10 hidden transition-opacity duration-300 ease-in-out lg:block ${$||S?"pointer-events-none opacity-0":"opacity-100"}`,style:{right:a?"8px":o?"40px":`${O+12}px`},children:[(0,s.jsx)("button",{ref:U,onClick:()=>{D(!M)},className:"flex cursor-pointer items-center gap-2 rounded-[16px] p-1 text-white opacity-60 outline-none transition-opacity hover:opacity-100 focus:outline-none",children:(0,s.jsx)(P.A,{size:16})}),(0,s.jsx)(ro,{isOpen:M,onClose:()=>D(!1),diffViewMode:k,onViewModeToggle:H,onExpandAll:W,onCollapseAll:q,onCopyRequestId:B,onSendFeedback:G,selectedComposerBcId:n?.composer?.bcId,isCopied:T,triggerRef:U})]}),"conversation"===i&&!x&&u.length>0&&(0,s.jsx)("div",{className:"block lg:hidden",children:L}),!a&&(0,s.jsx)("button",{"data-tooltip-place":"bottom","data-tooltip-id":"toggle-chat","data-tooltip-content":o?"Show chat":"Hide chat",onMouseDown:()=>{o&&C.current?.startAnimation(),h()},className:`absolute right-2 top-2 z-10 hidden cursor-pointer items-center gap-2 rounded-[16px] p-1 text-white opacity-60 transition-opacity hover:opacity-100 lg:flex ${!o?"bg-white/10":""}`,children:(0,s.jsx)(rt,{ref:C,size:16})})]})]})}})})}function rm({selectedComposerId:e,isModalVisible:t,handleCloseModal:r,selectedComposer:o,selectedComposerDiffStats:a,isComposerNotFound:l,prLoading:i,existingPrUrl:c,onOpenExistingPullRequest:u,onOpenPullRequest:m,onPrMerged:x,groupedComposers:h,groupTitle:f,onSelectComposer:g}){let{detailedDiffs:b,isLoading:v,detailedComposers:y,prefetchComposerData:j}=(0,w._F)(),N=(0,d.useRef)(null),C=(0,d.useRef)(null),k=(0,d.useRef)(null),[I,S]=(0,d.useState)(0),[E,R]=(0,d.useState)(!0),M=(0,d.useRef)(`background-composer-${Math.random().toString(36).substr(2,9)}`),D=(0,d.useRef)({code:0,conversation:0}),T=o?.composer?.bcId,P=(0,d.useMemo)(()=>!(T&&(!v||b.get(T))),[T,v,b]),L=(0,d.useMemo)(()=>{let e=new Set;if(!o)return e;if(T){let t=b.get(T);t?(t.diff?.diffs?.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)}),t.submoduleDiffs?.forEach(t=>{!t.errored&&t.diff?.diffs&&t.diff.diffs.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)})})):o?.diffSinceStart?.diffs?.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)})}return e.delete("/dev/null"),e},[o,T,b]),$=!!(e&&t);(0,d.useEffect)(()=>{(0,n.KZ)(M.current,$)},[$]);let _=()=>{if(!N.current||!k.current)return 0;let e=N.current,t=k.current,r=e.getBoundingClientRect(),s=t.getBoundingClientRect().top-r.top;return e.scrollTop+s};(0,d.useEffect)(()=>{if(h&&e){let t=h.findIndex(t=>t.bcId===e);-1!==t&&S(t)}},[e,h]),(0,d.useEffect)(()=>{h&&h.length>1&&h.forEach(e=>{j(e.bcId)})},[h,j]),(0,d.useEffect)(()=>{requestAnimationFrame(()=>{let e=Math.max(_(),0);D.current={code:e,conversation:e}})},[e]),(0,d.useEffect)(()=>{let e=N.current;if(!e)return;let t=()=>{R(e.scrollTop<=5)};return t(),e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t)}},[]);let U=e=>{let t=window.getSelection(),r=document.createRange();r.selectNodeContents(e.currentTarget),t?.removeAllRanges(),t?.addRange(r)},O=(0,d.useMemo)(()=>({code:({children:e,...t})=>(0,s.jsx)("code",{...t,className:"whitespace-pre-wrap break-words text-theme-text-primary",children:e})}),[]);return(0,s.jsx)(eB._s.Root,{open:$,onOpenChange:e=>{(0,n.KZ)(M.current,e),e||r()},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 mt-24 flex h-[92vh] flex-col rounded-t-xl border border-white/10 bg-theme-card-hex outline-none ring-0",children:[(0,s.jsx)(eB._s.Title,{className:"sr-only",children:"Cloud Agent Details"}),(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsx)("div",{className:"flex flex-1 flex-col overflow-hidden",children:(0,s.jsx)(e5.f,{selectedComposer:o,selectedComposerDiffStats:a,selectedComposerId:e,isComposerNotFound:l,prLoading:i,existingPrUrl:c,onOpenInCursor:A.Q1,onOpenExistingPullRequest:u,onOpenPullRequest:m,onCloseModal:()=>{(0,n.KZ)(M.current,!1),r()},onPrMerged:x,conversationScrollRef:N,children:({activeTab:e,HeaderComponent:t,DiffsComponent:n,setActiveTab:l,currentLogs:i,hasComposer:d,currentConversation:u,ConversationComponent:m,EditorComponent:x,TerminalLogsComponent:f,isComposerNotFound:v,isLoading:w})=>{let j=u.some(e=>!e.isTemporary),R=!a||0===a.totalAdded&&0===a.totalRemoved,M=Array.isArray(i)&&i.length>0,T=!v&&!o?.summary&&d&&!j&&R,$=T&&M;return(0,s.jsxs)(s.Fragment,{children:[!w&&o?.composer?.branchName&&(0,s.jsx)("div",{className:"flex items-center gap-1 px-4 text-[12px] overflow-hidden",children:(0,s.jsx)("span",{onClick:U,className:"truncate text-theme-text-secondary cursor-pointer active:text-theme-text-primary select-text",children:o.composer.branchName})}),t,(0,s.jsxs)("div",{className:"relative z-20 flex-1 overflow-y-auto",ref:N,...!E&&{"data-vaul-no-drag":!0},children:[h&&h.length>1&&(0,s.jsx)("div",{className:"flex flex-col gap-2 pb-2 pt-4 w-full",children:(0,s.jsx)("div",{ref:C,className:"px-4 w-full relative grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2 bg-transparent overflow-x-auto",children:h.map((e,t)=>{let r=t===I,o=e.status??p.R6.CREATING,a=(e=>{let t=Math.floor((Date.now()-e)/1e3);if(t<60)return"Just now";if(t<3600){let e=Math.floor(t/60);return`${e}m`}if(t<86400){let e=Math.floor(t/3600);return`${e}h`}if(t<604800){let e=Math.floor(t/86400);return`${e}d`}{let e=Math.floor(t/604800);return`${e}w`}})(e.createdAtMs||Date.now()),n=y.get(e.bcId),l=n?.modelDetails?.modelName,i=b.get(e.bcId),c=n?(0,A.xH)(n,i):null,d=e.prUrl&&o!==p.R6.EXPIRED?(0,s.jsx)(tG.K,{prUrl:e.prUrl,size:"sm",showTooltip:!0}):(0,s.jsx)(e9,{status:o,isArchived:e.isArchived,className:"h-3.5 w-3.5"});return(0,s.jsxs)("button",{onClick:()=>{h&&g&&t>=0&&t<h.length&&(g(h[t]),S(t))},className:`flex flex-shrink-0 flex-col items-start gap-0.5 rounded-lg border px-3 py-2 transition-all min-w-[80px] ${r?"border-theme-border-03 bg-theme-card-02-hex text-theme-text-primary shadow-sm":"border-theme-border-02 bg-theme-card-03-hex text-theme-text-secondary hover:border-theme-border-03 hover:bg-theme-card-02-hex"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,s.jsx)("div",{className:"web-text-base font-medium text-theme-text-primary text-left whitespace-nowrap",children:l?(0,eH.$L)(l):"Loading..."}),(0,s.jsx)("div",{className:"flex-shrink-0",children:d})]}),(0,s.jsx)("div",{className:"text-xs text-theme-text-secondary",children:c?(0,s.jsxs)(s.Fragment,{children:[c.totalAdded>0&&(0,s.jsxs)("span",{className:"text-green-600",children:["+",c.totalAdded]}),c.totalAdded>0&&c.totalRemoved>0&&(0,s.jsx)("span",{children:" "}),c.totalRemoved>0&&(0,s.jsxs)("span",{className:"text-red-600",children:["-",c.totalRemoved]})]}):a})]},e.bcId)})})}),o?.modelDetails?.modelName&&!w&&!(h&&h.length>1)&&(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)(te.o,{modelName:o.modelDetails?.modelName,source:o.composer?.source,isDiffLoading:P,diffStats:a,updatedFilenamesCount:L.size,existingPrUrl:c})}),o?.summary&&!w&&(0,s.jsx)("div",{className:"group flex flex-col gap-y-2 p-4",children:(0,s.jsx)("div",{className:"relative overflow-hidden transition-all duration-300",children:(0,s.jsx)("div",{style:{lineHeight:"20px"},className:"[&_li_code]:overflow-wrap-anywhere text-theme-text-secondary prose web-text-base prose-invert max-w-none [&_code]:before:content-none [&_code]:after:content-none [&_li_code]:break-all [&_pre]:max-w-full [&_pre]:overflow-x-auto ",children:(0,s.jsx)(K.oz,{components:O,children:o.summary})})})}),(0,s.jsx)("div",{className:"flex h-full flex-col",children:v?(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center px-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-medium text-white",children:"Cloud Agent not found"}),(0,s.jsx)("div",{className:"web-text-base text-theme-text-primary",children:"The cloud agent you're looking for doesn't exist or has been removed."}),(0,s.jsx)("button",{onClick:r,className:"mt-4 inline-flex w-fit items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white outline-none ring-0 transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})}):(0,s.jsx)("div",{className:"flex flex-col gap-0",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("div",{ref:k,style:{zIndex:11},className:"sticky -top-[1px] z-10 mb-0 flex flex-shrink-0 bg-theme-card-hex px-4 transition-colors duration-200 sm:mb-6",children:(0,s.jsx)(rc,{activeTab:e,setActiveTab:t=>{let r=N.current;if(r){let t=Math.max(r.scrollTop,_());"code"===e?D.current.code=t:"conversation"===e&&(D.current.conversation=t)}l(t),requestAnimationFrame(()=>{r&&(r.scrollTop=Math.max(D.current[t],_()))})}})}),"code"===e&&(0,s.jsx)("div",{className:"py-2",children:n}),"conversation"===e&&(0,s.jsx)("div",{className:"min-h-[200px] pb-5",children:(0,s.jsx)("div",{className:"pb-4 h-full",children:$||T&&!M?$?f:(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)(tE,{composerId:o?.composer?.bcId??void 0})}):w&&0===u.length?(0,s.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-2 border-theme-border-02 border-t-theme-accent"}),(0,s.jsx)("div",{className:"web-text-base text-theme-text-secondary",children:"Loading conversation..."})]})}):m})})]})})})]}),x&&(0,s.jsx)("div",{className:"flex-shrink-0 py-3 shadow-sm",children:x})]})}})})]})]})})}var rp=r(40454),rx=r(48616);let rh={normal:{y:0},animate:{y:-1.1}},rf={type:"spring",stiffness:500,damping:30},rg=(0,d.forwardRef)(({onMouseEnter:e,onMouseLeave:t,className:r,size:o=28,...a},n)=>{let l=(0,J.s)(),c=(0,d.useRef)(!1);(0,d.useImperativeHandle)(n,()=>(c.current=!0,{startAnimation:()=>l.start("animate"),stopAnimation:()=>l.start("normal")}));let u=(0,d.useCallback)(t=>{c.current?e?.(t):l.start("animate")},[l,e]),m=(0,d.useCallback)(e=>{c.current?t?.(e):l.start("normal")},[l,t]);return(0,s.jsx)("div",{className:(0,i.cn)(r),onMouseEnter:u,onMouseLeave:m,...a,children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsxs)(Z.P.g,{variants:rh,animate:l,transition:rf,children:[(0,s.jsx)("path",{d:"M3 6h18"}),(0,s.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),(0,s.jsx)(Z.P.path,{d:"M19 8v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V8",variants:{normal:{d:"M19 8v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V8"},animate:{d:"M19 9v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V9"}},animate:l,transition:rf}),(0,s.jsx)(Z.P.line,{x1:"10",x2:"10",y1:"11",y2:"17",variants:{normal:{y1:11,y2:17},animate:{y1:11.5,y2:17.5}},animate:l,transition:rf}),(0,s.jsx)(Z.P.line,{x1:"14",x2:"14",y1:"11",y2:"17",variants:{normal:{y1:11,y2:17},animate:{y1:11.5,y2:17.5}},animate:l,transition:rf})]})})});function rb({added:e,removed:t,fileCount:r}){return(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[e>0&&(0,s.jsxs)("span",{className:"text-green-600",children:["+",e]}),t>0&&(0,s.jsxs)("span",{className:"text-red-600",children:["-",t]})]})}function rv({backgroundComposer:e,detailedBackgroundComposer:t,onSelect:r,prLoading:o,onOpenExistingPullRequest:a,viewConfig:n,hideOrgName:l=!1}){let i,c=(0,S.o)(),{fetchDetailedComposer:u,detailedDiffs:m,prefetchComposerData:p}=(0,w._F)(),x=t?.composer?.prUrl??void 0??e.prUrl??void 0,[h,f]=(0,d.useState)(!1),g=(0,d.useRef)(null);(0,d.useEffect)(()=>{x?(0,A.s9)(e.bcId,x):(0,A.xh)(e.bcId)},[x,e.bcId]);let[b,v]=(0,d.useState)(null);(0,d.useEffect)(()=>{let r=m.get(e.bcId);v((0,A.xH)(t||e,r))},[t,e,m]);let y=async s=>{if(console.log("handleClick",s),s.metaKey||s.ctrlKey){let t=new URL(window.location.href);t.searchParams.set("selectedBcId",e.bcId),window.open(t.toString(),"_blank");return}if(r&&t)r(t);else if(!t&&r)try{let t=await u(e.bcId);t?r(t):console.error("Failed to refetch detailed background composer")}catch(e){console.error("Error refetching detailed background composer:",e)}},j=t=>{switch(t){case"name":case"status":case"model":case"date":case"diff":case"prompt":return!0;case"repo":return!!e.repoUrl;case"branch":return!!e.branchName;default:return!1}},N=n.properties.filter(e=>{if(!e.visible)return!1;if(n.groupBy){let t={status:"status",repo:"repo",model:"model",date:"date",prompt:"prompt"}[n.groupBy];if(t&&e.id===t)return!1}return!0}).sort((e,t)=>e.order-t.order),C=N.filter(e=>("repo"!==n.groupBy||"model"!==e.id)&&0===(e.row||0)),k=N.filter(e=>"repo"===n.groupBy&&"model"===e.id||1===(e.row||0)),I=C.filter(e=>j(e.id)),E=k.filter(e=>j(e.id)),R=["name","prompt","branch","repo"];(i=I.find(e=>R.includes(e.id))?.id)||(i=I.find(e=>"model"===e.id)?.id),i||0!==I.length||(i=E.find(e=>R.includes(e.id))?.id);let M=(r,o=!1)=>{switch(r){case"name":return(0,s.jsx)("div",{className:o?"font-medium text-[13px] leading-[150%] sm:web-text-base truncate text-theme-text-primary group-hover:opacity-100 group-active:text-theme-text-primary sm:opacity-100":"truncate text-theme-text-primary",children:e.name?.length>0?e.name:"New Cloud Agent"});case"status":return(0,s.jsx)(e9,{status:e.status,className:"h-4 w-4 flex-shrink-0 sm:h-4 sm:w-4 text-theme-text-secondary",isArchived:e.isArchived});case"model":return t?.modelDetails?o?(0,s.jsx)("span",{className:"truncate text-[13px] font-medium leading-[150%] text-theme-text-primary",children:(0,eH.$L)(t?.modelDetails.modelName)}):"repo"===n.groupBy?(0,s.jsx)("span",{className:"truncate text-[12px] text-theme-text-secondary",children:(0,eH.$L)(t?.modelDetails.modelName)}):(0,s.jsx)("div",{className:"truncate rounded px-1 py-0 font-mono text-[11px] font-medium text-theme-text-primary hover:text-theme-text-primary"}):(0,s.jsx)(s.Fragment,{});case"date":return(0,s.jsx)("span",{className:"flex-shrink-0 text-[12px] text-theme-text-secondary",children:(e=>{let t=Math.floor((Date.now()-e)/1e3);if(t<60)return"Just now";if(t<3600){let e=Math.floor(t/60);return`${e}m`}if(t<86400){let e=Math.floor(t/3600);return`${e}h`}if(t<604800){let e=Math.floor(t/86400);return`${e}d`}if(t<2592e3){let e=Math.floor(t/604800);return`${e}w`}else if(t<31536e3){let e=Math.floor(t/2592e3);return`${e}mo`}else{let e=Math.floor(t/31536e3);return`${e}y`}})(e.createdAtMs??0)});case"repo":return e.repoUrl?(0,s.jsx)("span",{className:o?"truncate text-[13px] font-medium leading-[150%] text-theme-text-primary":"truncate text-[12px] text-theme-text-secondary",children:(()=>{let t=e.repoUrl.split("/");if(t.length>=2){let r=t.pop()?.replace(/\.git$/,""),s=t.pop();return l&&r?r:s&&r?`${s}/${r}`:e.repoUrl}return e.repoUrl})()}):null;case"branch":return e.branchName?(0,s.jsxs)("div",{className:`flex items-center gap-1 truncate ${o?"text-[13px] font-medium leading-[150%] text-theme-text-primary":"text-[12px] text-theme-text-secondary"}`,children:[(0,s.jsx)(tG.K,{prUrl:x,size:"sm"}),(0,s.jsx)("span",{className:"truncate",children:e.branchName})]}):null;case"diff":return b&&(b.totalAdded>0||b.totalRemoved>0)?(0,s.jsx)("div",{className:"flex-shrink-0 ml-1",children:(0,s.jsx)(rb,{added:b.totalAdded,removed:b.totalRemoved,fileCount:b.fileCount})}):(0,s.jsx)(s.Fragment,{});case"prompt":return t?.prompt?.text?(0,s.jsx)("span",{className:`truncate ${o?"text-[13px] font-medium leading-[150%] text-theme-text-primary":"text-[12px] text-theme-text-secondary"}`,children:t?.prompt?.text||"No prompt"}):(0,s.jsx)("span",{className:`truncate ${o?"text-[13px] font-medium leading-[150%] text-theme-text-primary":"text-[12px] text-theme-text-secondary"}`,children:"No prompt"});default:return null}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tm.A,{isOpen:h,bcIds:[e.bcId],onClose:()=>f(!1)}),(0,s.jsxs)("div",{className:`group relative flex gap-2 rounded-md py-2 items-center justify-between ${!c?"hover:bg-[rgba(255,255,255,0.04)]":""} transition-all duration-100 ${t?"cursor-pointer":""} ${c?"":"min-w-[272px]"}`,style:{backgroundBlendMode:"overlay"},onClick:y,onMouseDown:y,onMouseEnter:()=>p(e.bcId),children:[(0,s.jsxs)("div",{className:`flex min-w-0 flex-1 flex-col gap-0 ${c?"pr-2":""}`,children:[I.length>0&&(0,s.jsx)("div",{className:"flex min-w-0 items-center gap-2 overflow-hidden",children:I.map(e=>{let t=["repo","branch","name","prompt","model"].includes(e.id),r="status"===e.id||"diff"===e.id||"date"===e.id;return(0,s.jsx)("div",{className:`flex items-center gap-1 ${r?"flex-shrink-0":t?"min-w-0 flex-shrink overflow-hidden":"min-w-0 flex-shrink"} ${e.id===i&&!r?"flex-1":t&&!r?"max-w-full":""}`,children:(0,s.jsx)("div",{className:t?"min-w-0 overflow-hidden truncate":"",children:M(e.id,e.id===i)})},e.id)})}),E.filter(e=>"date"!==e.id).length>0&&(0,s.jsx)("div",{className:"flex items-center text-[11px] leading-[150%] pl-6 min-w-0 overflow-hidden gap-1 text-theme-text-secondary",children:E.filter(e=>"date"!==e.id).map((e,t)=>{let r=["repo","branch","name","prompt","model"].includes(e.id),o="status"===e.id||"diff"===e.id;return(0,s.jsx)("div",{className:`flex items-center gap-0 ${o?"flex-shrink-0":r?"min-w-0 flex-shrink overflow-hidden":"min-w-0 flex-shrink"} ${e.id===i&&!o?"flex-1":r&&!o?"max-w-full":""}`,children:(0,s.jsx)("div",{className:r?"min-w-0 overflow-hidden truncate":"",children:M(e.id,e.id===i)})},e.id)})})]}),!c&&(0,s.jsxs)("div",{className:"absolute right-2 flex h-full w-fit items-center pl-4 opacity-0 transition-opacity duration-100 group-hover:bg-[linear-gradient(to_right,transparent_0%,#1e1f22_30px,#1e1f22_100%)] group-hover:opacity-100",style:{height:"calc(100% - 4px)"},children:[(0,s.jsx)(V.m_,{id:"open-pr-tooltip",noArrow:!0,opacity:1,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),x&&!o&&(0,s.jsx)("button",{className:"rounded-md px-2 py-1 web-text-base text-[rgba(204,204,204,0.80)] opacity-0 hover:bg-white/10 hover:!opacity-100 group-hover:opacity-80","data-tooltip-id":"open-pr-tooltip","data-tooltip-place":"top","data-tooltip-content":"View PR",onClick:e=>{e.stopPropagation(),a()},onMouseDown:e=>{e.stopPropagation()},children:(0,s.jsx)(rx.N,{className:"h-4 w-4"})}),!e.isOwnedByDifferentTeamMember&&!!t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V.m_,{id:"open-in-cursor-tooltip",noArrow:!0,opacity:1,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,s.jsx)("button",{className:"rounded-md px-2 py-1 web-text-base text-[rgba(204,204,204,0.80)] opacity-0 hover:bg-white/10 hover:!opacity-100 group-hover:opacity-80","data-tooltip-id":"open-in-cursor-tooltip","data-tooltip-place":"top","data-tooltip-content":"Open in Cursor",onClick:t=>{t.stopPropagation(),(0,A.Q1)(e.bcId)},onMouseDown:e=>{e.stopPropagation()},children:(0,s.jsx)("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2.20489 4.81264L7.84862 8.07105L13.6631 4.63865L2.20489 4.81264ZM8.27898 1.53014L8.25521 3.99014L12.4631 3.94585L8.27898 1.53014ZM3.3016 4.04218L7.52089 3.99786L7.54473 1.53734L3.3016 4.04218ZM8.20954 8.71066L8.14441 15.4379L14.024 5.27812L8.20954 8.71066ZM1.86659 5.47967L1.80701 11.6375L7.11009 8.50701L1.86659 5.47967ZM7.40989 15.4695L7.47105 9.14653L2.02579 12.361L7.40989 15.4695ZM13.5894 12.2478L11.5194 11.0527L9.40232 14.7196L13.5894 12.2478ZM13.9628 11.6011L14.0098 6.73917L11.8928 10.406L13.9628 11.6011ZM14.6888 12.4514L7.76665 16.5378L0.922218 12.5862L1.00002 4.54813L7.92222 0.461814L14.7667 4.41345L14.6888 12.4514Z",fill:"rgba(204,204,204,0.80)"})})})]}),!e.isArchived&&!e.isOwnedByDifferentTeamMember&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V.m_,{id:"archive-tooltip",noArrow:!0,opacity:1,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,s.jsx)(V.m_,{id:"branch-icon-tooltip",noArrow:!0,opacity:1,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,s.jsx)("button",{className:"rounded-md px-2 py-1 web-text-base text-[rgba(204,204,204,0.80)] opacity-0 outline-none ring-0 hover:bg-white/10 hover:!opacity-100 focus:outline-none focus:ring-0 group-hover:opacity-80","data-tooltip-id":"archive-tooltip","data-tooltip-place":"top","data-tooltip-content":"Delete",onMouseEnter:e=>{e.stopPropagation(),g.current?.startAnimation()},onMouseLeave:e=>{e.stopPropagation(),g.current?.stopAnimation()},onClick:e=>{e.stopPropagation(),f(!0)},onMouseDown:e=>{e.stopPropagation()},children:(0,s.jsx)(rg,{ref:g,size:16})})]}),(0,s.jsx)(eI.A,{className:`h-4 w-4 text-[rgba(204,204,204,0.60)] opacity-0 ${t?"group-hover:opacity-100":""} transition-opacity duration-100`,onMouseEnter:e=>{e.stopPropagation()}})]}),c&&(0,s.jsx)("div",{className:"mb-auto mt-1 flex flex-shrink-0 items-center gap-3 transition-opacity duration-100",children:M("date",!1)})]})]})}rg.displayName="DeleteIcon";let ry=e=>{let t=new Date(e||0),r=new Date().getTime()-t.getTime(),s=Math.floor(r/6e4),o=Math.floor(r/36e5),a=Math.floor(r/864e5),n=Math.floor(a/7),l=Math.floor(a/30),i=Math.floor(a/365);if(s<1)return"now";if(s<60)return`${s}m`;if(o<24)return`${o}h`;if(a<7)return`${a}d`;if(n<4)return`${n}w`;else if(l<12)return`${l}mo`;else return`${i}y`},rw=(e,t=!1)=>{if(!e)return"";let r=e.split("/");if(r.length>=2){let e=r.pop()?.replace(/\.git$/,""),s=r.pop();return t&&e?e:s&&e?`${s}/${e}`:""}return""};function rj({title:e,composers:t,sectionPagination:r,setSectionPagination:o,flattenedComposers:a,selectedIndex:n,detailedComposers:l,prLoading:i,onOpenExistingPullRequest:c,onSelectComposer:u,viewConfig:m}){let{detailedDiffs:x,detailedComposers:h}=(0,w._F)(),f=(0,S.o)(),g=(0,d.useMemo)(()=>{let e=new Set;return t.forEach(t=>{if(t.repoUrl){let r=t.repoUrl.split("/");if(r.length>=2){let t=r[r.length-2];t&&e.add(t)}}}),1===e.size},[t]),b=r[e]||0,v=5*b,y=t.slice(v,v+5),j=Math.ceil(t.length/5),N=b>0,C=b<j-1,k=(0,d.useCallback)(()=>{o(t=>({...t,[e]:Math.max(0,b-1)}))},[o,e,b]),I=(0,d.useCallback)(()=>{o(t=>({...t,[e]:Math.min(j-1,b+1)}))},[o,e,b,j]);(0,d.useCallback)(t=>{o(r=>({...r,[e]:t}))},[o,e]);let E=(0,d.useCallback)(()=>{C&&I()},[C,I]),R=(0,d.useCallback)(()=>{N&&k()},[N,k]),[M,D]=(0,d.useState)(!1),T=(0,d.useRef)(null);if((0,rp.useDrag)(({movement:[e],direction:[t],velocity:[r],cancel:s,canceled:o})=>{if(!f||j<=1)return;let a=Math.abs(e)>50;(r>.2||a)&&(t>0&&N?R():t<0&&C&&E(),s())},{from:()=>[0,0],filterTaps:!0,bounds:{left:-100,right:100},rubberband:!0,preventScroll:!0,preventScrollAxis:"y",onDragStart:()=>D(!0),onDragEnd:()=>D(!1)}),0===t.length)return null;if(f){let r=new Map;return t.forEach(e=>{let t=e.promptGroupId||`single-${e.bcId}`;r.has(t)||r.set(t,[]),r.get(t).push(e)}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[r.size>0&&(0,s.jsx)("div",{className:"py-1",children:(0,s.jsx)("div",{className:"text-[12px] tabular-nums leading-[150%] text-theme-text-secondary",children:e})}),Array.from(r.values()).map(e=>{let r=e.length>1,o=e[0],i=n===a.findIndex(e=>e.bcId===o.bcId),c=l.get(o.bcId)||h.get(o.bcId);if(r){let t=e.length,r=e.filter(e=>{let t=e.status??0;return t===p.R6.FINISHED||t===p.R6.EXPIRED||t===p.R6.ERROR}).length,a=e.some(e=>{let t=e.status??0;return t===p.R6.RUNNING||t===p.R6.CREATING}),n=a?`${r}/${t} Models Completed`:`${t} ${1===t?"Model":"Models"}`,l=rw(o.repoUrl,g),c=e.find(e=>e.prUrl&&(e.status??0)!==p.R6.EXPIRED);return(0,s.jsxs)("div",{className:`group flex cursor-pointer flex-col gap-1 rounded-lg border border-transparent px-1 py-1.5 transition-colors hover:border-white/5 hover:bg-theme-card-hover-hex ${i?"ring-2 ring-white/10":""}`,onClick:()=>u(o),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[a?(0,s.jsx)(e9,{status:p.R6.RUNNING,isArchived:!1,className:"h-3.5 w-3.5 flex-shrink-0 text-theme-text-secondary"}):c?(0,s.jsx)(tG.K,{prUrl:c.prUrl,size:"md",hasMultipleModels:!0}):(0,s.jsx)(tG.K,{prUrl:void 0,size:"md",hasMultipleModels:!0}),(0,s.jsx)("div",{className:"min-w-0 flex-1 truncate web-text-base font-medium text-theme-text-primary",children:o.name||"New Cloud Agent"}),(0,s.jsx)("span",{className:"flex-shrink-0 text-xs text-theme-text-secondary",children:ry(o.createdAtMs??0)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pl-6 text-[12px] text-theme-text-secondary",children:[n&&(0,s.jsx)("span",{children:n}),n&&l&&(0,s.jsx)("span",{children:"\xb7"}),l&&(0,s.jsx)("span",{className:"truncate",children:l})]})]},o.bcId)}let d=x.get(o.bcId),m=(0,A.xH)(c||o,d),f=o.status??0,b=f===p.R6.RUNNING||f===p.R6.CREATING,v=(0,eH.$L)(c?.modelDetails?.modelName),y="";b&&!m&&(y=`${v}`);let w=rw(o.repoUrl,g),j=!!o.prUrl&&f!==p.R6.EXPIRED,N=!!o.promptGroupId&&t.filter(e=>e.promptGroupId===o.promptGroupId).length>1,C=y||m&&(m.totalAdded>0||m.totalRemoved>0);return(0,s.jsxs)("div",{className:`group flex cursor-pointer flex-col rounded-lg gap-0.5 px-1 py-1.5 transition-colors hover:border-white/5 hover:bg-theme-card-hover-hex ${i?"ring-2 ring-white/10":""}`,onClick:()=>u(o),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[j?(0,s.jsx)(tG.K,{prUrl:o.prUrl,size:"md",hasMultipleModels:N}):N?(0,s.jsx)(tG.K,{prUrl:void 0,size:"md",hasMultipleModels:!0}):(0,s.jsx)(e9,{status:f,isArchived:o.isArchived,className:"h-4 w-4 flex-shrink-0 text-theme-text-secondary"}),(0,s.jsx)("div",{className:"min-w-0 flex-1 truncate web-text-base font-medium text-theme-text-primary",children:o.name||"New Cloud Agent"}),(0,s.jsx)("span",{className:"flex-shrink-0 text-xs text-theme-text-secondary",children:ry(o.createdAtMs??0)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pl-6 text-[12px] text-theme-text-secondary",children:[y&&(0,s.jsx)("span",{children:y}),m&&(m.totalAdded>0||m.totalRemoved>0)&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[m.totalAdded>0&&(0,s.jsxs)("span",{className:"text-green-600",children:["+",m.totalAdded]}),m.totalRemoved>0&&(0,s.jsxs)("span",{className:"text-red-600",children:["-",m.totalRemoved]})]}),C&&w&&(0,s.jsx)("span",{children:"\xb7"}),w&&(0,s.jsx)("span",{className:"truncate",children:w})]})]},o.bcId)})]})}return(0,s.jsxs)("div",{ref:T,className:`flex flex-col gap-0 transition-opacity duration-200 ${M?"opacity-80":"opacity-100"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between py-1",children:[j>1&&(0,s.jsxs)("div",{className:"text-[12px] tabular-nums leading-[150%] text-theme-text-secondary",children:[e," \xb7 ",b+1," of ",j]}),1===j&&(0,s.jsx)("div",{className:"text-[12px] tabular-nums leading-[150%] text-theme-text-secondary",children:e}),j>1&&(0,s.jsxs)("div",{className:"flex items-center gap-0",children:[(0,s.jsx)("button",{onClick:k,disabled:!N,className:`flex h-5 min-h-5 w-5 min-w-5 items-center justify-center rounded p-1 px-2 py-0.5 text-[11px] transition-opacity ${N?"cursor-pointer text-gray-600 hover:bg-gray-500/10 hover:text-theme-text-primary active:bg-gray-500/20":"cursor-default text-[#30363f]"}`,children:(0,s.jsx)(tP.A,{className:"h-4 min-h-4 w-4 min-w-4"})}),(0,s.jsx)("button",{onClick:I,disabled:!C,className:`flex h-5 min-h-5 w-5 min-w-5 items-center justify-center rounded p-1 px-2 py-0.5 text-[11px] transition-opacity ${C?"cursor-pointer text-gray-600 hover:bg-gray-500/10 hover:text-theme-text-primary active:bg-gray-500/20":"cursor-default text-[#30363f]"}`,children:(0,s.jsx)(t9.A,{className:"h-4 min-h-4 w-4 min-w-4"})})]})]}),(0,s.jsx)("div",{className:`flex flex-col gap-1 sm:gap-0 ${j>1?"min-h-[264px]":""}`,children:y.map(e=>{let t=a.findIndex(t=>t.bcId===e.bcId),r=l.get(e.bcId);return(0,s.jsx)("div",{className:`${n===t?"rounded-md ring-2 ring-white/10":""}`,children:(0,s.jsx)(rv,{backgroundComposer:e,prLoading:i,onOpenExistingPullRequest:c,detailedBackgroundComposer:r,onSelect:()=>{u(e)},viewConfig:m,hideOrgName:g})},e.bcId)})})]})}function rN({showUpgradeModal:e,setShowUpgradeModal:t,onUpgradeToPro:r,isUpgrading:o}){return(0,s.jsx)("div",{className:`fixed inset-0 flex items-center justify-center transition-all duration-300 ${e?"pointer-events-auto z-50 bg-black/50 opacity-100":"[*]:pointer-events-none pointer-events-none z-[-1] opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>t(!1),children:(0,s.jsx)("div",{className:`pointer-events-auto mx-4 flex w-[380px] flex-col gap-2 rounded-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] p-6 shadow-lg transition-all duration-300 max-sm:mx-0 max-sm:rounded-b-none max-sm:rounded-t-xl max-sm:border-b-0 sm:mx-0 sm:rounded-lg ${e?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,style:{borderColor:"rgb(36, 38, 42)"},onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-xl font-medium text-gray-300",children:"Paid subscription required"}),(0,s.jsx)("span",{className:"web-text-base text-theme-text-secondary",children:"Get access to Cloud Agents, fast models, and priority support."}),(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>t(!1),className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Cancel"}),(0,s.jsx)("button",{onClick:r,disabled:o,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:o?"Processing...":"Upgrade to Pro"})]})]})})})}var rC=r(3484);function rk({showUsagePricingModal:e,setShowUsagePricingModal:t,handleHardLimitToggle:r,stripeStatus:o,limitOptions:a,selectedLimit:n,customValue:l,handleLimitSelect:i,handleCustomLimitChange:c}){return(0,s.jsx)("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ${e?"pointer-events-auto bg-black/50 opacity-100":"pointer-events-none opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>t(!1),children:(0,s.jsxs)("div",{className:`flex w-[380px] flex-col gap-2 rounded-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] p-6 shadow-2xl transition-all duration-300 ${e?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"mb-0 flex items-center justify-between",children:(0,s.jsx)(T.DZ,{variant:"subheading-2",className:"text-white",children:"Requires on-demand usage to be enabled"})}),(0,s.jsx)(rC.V,{stripeStatus:o,limitOptions:a,selectedLimit:n,customValue:l,handleLimitSelect:i,handleCustomLimitChange:c,onCancel:()=>t(!1),onEnable:r})]})})}var rI=r(64144);function rS({inputBoxRef:e,showFAB:t}){let r=(0,d.useCallback)(()=>{let t=document.querySelector(".agents-page");t?t.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{e.current?.focus()},500)},[e]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:`fixed bottom-6 right-6 z-40 transition-all duration-300 ease-out ${t?"pointer-events-auto scale-100 opacity-100":"pointer-events-none scale-75 opacity-0"}`,children:(0,s.jsx)("button",{onClick:r,className:"hover:shadow-2xl border border-theme-border-02 flex h-12 w-12 items-center justify-center rounded-full bg-theme-bg shadow-xl transition-all duration-200 hover:scale-105 active:scale-95","aria-label":"Scroll to top",children:(0,s.jsx)(rI.A,{className:"text-theme-text-primary",size:16})})})})}function rE({isOpen:e,onClose:t,onConnect:r}){let o=(0,S.o)(),[a,n]=(0,d.useState)(!1),[l,i]=(0,d.useState)(!1),c=(0,d.useRef)(null),u=(0,d.useRef)(null),m=(0,d.useCallback)(()=>{a||(i(!1),u.current=setTimeout(()=>{t(),u.current=null},150))},[a,t]),p=(0,d.useCallback)(e=>{a||(e.preventDefault(),e.stopPropagation(),m())},[a,m]),x=(0,d.useCallback)(async()=>{n(!0);try{await r(),m()}catch(e){console.error("Failed to connect GitHub:",e)}finally{n(!1)}},[r,m]);if((0,d.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&!a&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),m()),"Enter"===t.key&&e&&!a&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),x())};if(e)return document.addEventListener("keydown",t,{capture:!0}),()=>{document.removeEventListener("keydown",t,{capture:!0})}},[e,a,m,x]),(0,d.useEffect)(()=>{if(e)return(0,eu.sx)("webagent.github_connect_modal_shown",{source:eu.rw.string("background_agents")}),document.body.style.overflow="hidden",c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{i(!0),c.current=null},10),()=>{document.body.style.overflow=""};i(!1)},[e]),(0,d.useEffect)(()=>()=>{c.current&&clearTimeout(c.current),u.current&&clearTimeout(u.current)},[]),!e)return null;let h=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:`fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ${l?"opacity-100":"opacity-0"}`,onPointerDown:p,onClick:p,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,s.jsx)("div",{className:`fixed z-[9999] w-full transition-all duration-150 ease-out max-sm:bottom-0 max-sm:left-0 max-sm:right-0 sm:left-1/2 sm:top-1/2 sm:max-w-sm sm:-translate-x-1/2 sm:-translate-y-1/2 ${l?"opacity-100 max-sm:translate-y-0 sm:scale-100":"opacity-0 max-sm:translate-y-full sm:scale-95"}`,children:(0,s.jsxs)("div",{className:`pointer-events-auto mx-4 border border-theme-border-02 bg-theme-card-hex p-6 shadow-lg max-sm:mx-0 max-sm:rounded-b-none max-sm:rounded-t-xl max-sm:border-b-0 sm:mx-0 sm:rounded-lg ${o?"pb-[96px]":""}`,onPointerDown:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"mb-2 flex justify-center sm:hidden",children:(0,s.jsx)("div",{className:"h-1 w-10 rounded-full",style:{backgroundColor:"var(--color-theme-border-strong)"}})}),(0,s.jsxs)("div",{className:"mb-4 flex flex-col items-start justify-between gap-2",children:[(0,s.jsx)("span",{className:"text-xl font-medium text-theme-text-primary",children:"Connect GitHub"}),(0,s.jsx)("span",{className:"web-text-base text-theme-text-secondary",children:"GitHub connection is required to use Cloud Agents. This allows us to access your repositories and create pull requests with the generated code changes."})]}),(0,s.jsxs)("div",{className:`flex w-full flex-row items-center gap-2 ${o?"flex-col-reverse":""}`,children:[(0,s.jsx)("button",{onClick:m,disabled:a,className:"focus:ring-none h-[32px] inline-flex w-full btn--sec transition-colors focus:outline-none focus:ring-offset-2 disabled:cursor-default disabled:opacity-50 disabled:hover:bg-transparent",children:"Cancel"}),(0,s.jsx)("button",{onClick:x,disabled:a,className:"btn h-[32px] w-full focus:outline-none focus:ring-0 disabled:cursor-default disabled:opacity-50 disabled:hover:bg-brand-dashboard-highlight",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Connecting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eq.A,{className:"mr-2 h-4 w-4"}),"Connect GitHub"]})})]}),(0,s.jsx)("div",{className:"h-[env(safe-area-inset-bottom)] sm:hidden"})]})})]});return(0,eR.createPortal)(h,document.body)}let rA=({showUpgradeModal:e,setShowUpgradeModal:t,onUpgradeToPro:r})=>(0,s.jsx)(eB._s.Root,{open:e,onOpenChange:e=>{e||t(!1)},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 flex h-fit max-h-[70vh] flex-col rounded-t-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315]",children:[(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsxs)("div",{className:"p-6 pt-0",children:[(0,s.jsx)("div",{className:"mb-0 flex items-center justify-between",children:(0,s.jsx)(T.DZ,{variant:"subheading-2",className:"text-white",children:"Paid Subscription Required"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(T.o5,{className:"web-text-base text-white/70",children:"Upgrade to continue"}),(0,s.jsx)(T.o5,{className:"text-xs text-white/50",children:"Get access to advanced tools, priority support, and enhanced functionality with Cursor Pro."}),(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>t(!1),className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Cancel"}),(0,s.jsx)("button",{onClick:r,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Upgrade to Pro"})]})]})]})]})]})}),rR=e=>{let{showUsagePricingModal:t,setShowUsagePricingModal:r,handleHardLimitToggle:o,stripeStatus:a,limitOptions:n,selectedLimit:l,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d}=e;return(0,s.jsx)(eB._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 flex h-fit max-h-[70vh] flex-col rounded-t-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315]",children:[(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsxs)("div",{className:"p-6 pt-0",children:[(0,s.jsx)("div",{className:"mb-0 flex items-center justify-between",children:(0,s.jsx)(T.DZ,{variant:"subheading-2",className:"text-white",children:"Requires on-demand usage to be enabled"})}),(0,s.jsx)(rC.V,{stripeStatus:a,limitOptions:n,selectedLimit:l,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d,onCancel:()=>r(!1),onEnable:o})]})]})]})})},rM=({isLoadingPrivacyMode:e,isEnforcedByTeam:t,onCancel:r})=>{let o=(0,c.useRouter)(),a=(0,d.useCallback)(()=>{o.push("/dashboard?tab=settings")},[o]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-0 flex items-center justify-between",children:(0,s.jsx)(T.DZ,{variant:"subheading-2",className:"text-white",children:"Privacy Mode change required"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)(T.o5,{className:"web-text-base text-white/70",children:["Cloud agents require code storage to function properly. Your current privacy mode prevents this."," ",t?"Your privacy mode is enforced by your team admin. Please contact them to change privacy settings.":"To use cloud agents, please update your privacy mode in settings to allow code storage."]}),!t&&(0,s.jsxs)("div",{className:"mt-4 flex w-full flex-row items-center gap-2",children:[(0,s.jsx)("button",{onClick:r,className:"focus:ring-none inline-flex w-full items-center justify-center rounded-md border border-solid border-white/10 px-4 py-2 web-text-base font-medium text-white text-white/50 transition-colors hover:bg-white/5 focus:outline-none focus:ring-offset-2",children:"Cancel"}),(0,s.jsx)("button",{onClick:a,disabled:e,className:"inline-flex w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:e?"Loading...":"Open settings"})]})]})]})};function rD({showPrivacyModeModal:e,setShowPrivacyModeModal:t,isLoadingPrivacyMode:r,isEnforcedByTeam:o,isMobile:a,hoursRemainingInGracePeriod:n=0}){let l=()=>t(!1);if(n>0){let r=(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsxs)("h3",{className:"mb-2 text-lg font-semibold text-white",children:["Privacy mode change ",a?"on desktop":"in Cursor"," required"]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("p",{className:"web-text-base text-brand-gray-400",children:["Cloud agents require code storage to function properly.\xa0",o?"Please contact your team admin to change privacy settings.":"Please update your privacy mode in settings to allow code storage."]}),(0,s.jsx)("p",{className:"web-text-base text-brand-gray-400",children:a?"Please open Cursor on desktop to configure your privacy settings.":"Configure your privacy settings in the Cursor app"})]})]}),(0,s.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,s.jsx)("button",{onClick:l,className:"h-fit w-full rounded-lg border border-white/20 px-4 py-2 text-white transition-colors hover:bg-white/5",children:"Close"}),!a&&(0,s.jsx)("button",{onClick:()=>{let e="localhost"===window.location.hostname;window.location.href=`${e?"cursor-dev":"cursor"}://anysphere.cursor-deeplink/settings`},className:"inline-flex h-fit w-full items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 web-text-base font-medium text-white transition-colors hover:bg-brand-dashboard-highlight/30 hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:"Open settings"})]})]});return a?(0,s.jsx)(eB._s.Root,{open:e,onOpenChange:e=>{e||t(!1)},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 mt-24 flex h-auto flex-col rounded-t-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] outline-none ring-0",children:[(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsx)("div",{className:"p-6",children:r})]})]})}):(0,s.jsx)("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ${e?"pointer-events-auto bg-black/50 opacity-100":"pointer-events-none opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:l,children:(0,s.jsx)("div",{className:`flex w-[380px] flex-col gap-2 rounded-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] p-6 shadow-2xl transition-all duration-300 ${e?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:r})})}return a?(0,s.jsx)(eB._s.Root,{open:e,onOpenChange:e=>{e||t(!1)},children:(0,s.jsxs)(eB._s.Portal,{children:[(0,s.jsx)(eB._s.Overlay,{className:"fixed inset-0 z-50 bg-black/50"}),(0,s.jsxs)(eB._s.Content,{className:"fixed bottom-0 left-0 right-0 z-50 mt-24 flex h-auto flex-col rounded-t-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] outline-none ring-0",children:[(0,s.jsx)("div",{className:"p-4 pb-0",children:(0,s.jsx)(eB._s.Handle,{className:"mx-auto mb-4 h-1 w-12 rounded-full bg-white/20"})}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(rM,{isLoadingPrivacyMode:r,isEnforcedByTeam:o,onCancel:l})})]})]})}):(0,s.jsx)("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ${e?"pointer-events-auto bg-black/50 opacity-100":"pointer-events-none opacity-0"}`,style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:l,children:(0,s.jsx)("div",{className:`flex w-[380px] flex-col gap-2 rounded-xl border border-white/10 bg-gradient-to-b from-[#17191D] to-[#121315] p-6 shadow-2xl transition-all duration-300 ${e?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:(0,s.jsx)(rM,{isLoadingPrivacyMode:r,isEnforcedByTeam:o,onCancel:l})})})}function rT(e,t,r,s){let o="asc"===r.sortDirection?1:-1;if(!r.sortBy)return(0,A.JJ)(e,t)*o;switch(r.sortBy){case"name":{let r=e.name||"",s=t.name||"";return r.localeCompare(s)*o}case"status":{let r=e.status??p.R6.UNSPECIFIED;return(r-(t.status??p.R6.UNSPECIFIED))*o}case"model":{let r=s.get(e.bcId),a=s.get(t.bcId),n=r?.modelDetails?.modelName||"",l=a?.modelDetails?.modelName||"";return n.localeCompare(l)*o}case"date":{let r=(0,A.IB)(e);return(r-(0,A.IB)(t))*o}case"repo":{let r=e.repoUrl||"",s=t.repoUrl||"";return r.localeCompare(s)*o}case"branch":{let r=e.branchName||"",s=t.branchName||"";return r.localeCompare(s)*o}default:return(0,A.JJ)(e,t)}}function rP({showFAB:e,deeplinkData:t,onViewModeChange:r}){let{user:o,error:a,isLoading:n}=(0,m.Jd)(),{backgroundComposers:l,detailedComposers:i,detailedDiffs:c,getConversationForAgent:u,getToolStatusForAgent:D,isLoading:T,startConversationFetching:P,stopConversationFetching:L,fetchDetailedComposer:$,refetchBackgroundComposers:_,showUsagePricingModal:U,setShowUsagePricingModal:O,showUpgradePaidModal:F,setShowUpgradePaidModal:z,showPrivacyModeModal:B,setShowPrivacyModeModal:G,updateComposerPrUrl:H,selectedComposerId:W,setSelectedComposerId:q}=(0,w._F)(),K=(0,d.useRef)(null),V=(0,d.useRef)(P),J=(0,d.useRef)(L);(0,d.useEffect)(()=>{V.current=P},[P]),(0,d.useEffect)(()=>{J.current=L},[L]);let Z=(0,y.useGateValue)("enable_gitlab_github_enterprise_bga"),X=(0,h.C)({isTeamAdmin:void 0,includeTeamOwnedRepos:!1,search:void 0}),Y=(0,g.d)({isTeamAdmin:void 0,enterpriseAppUuid:void 0,includeTeamOwnedRepos:!1,search:void 0}),{githubConnected:Q,isLoading:ee,installations:et,loadingMoreRepos:er,error:es}=Z?X:Y;Z&&X.repoUrlToScmProvider;let{stripeStatus:eo,updateHardLimit:ea,processCheckout:en}=(0,j.M)();(0,d.useEffect)(()=>{es&&(0,M.Ej)("Unable to connect to SCM Provider. Please try again later.")},[es]);let{userPrivacyMode:el,isLoadingPrivacyMode:ei,isEnforcedByTeam:ec,hoursRemainingInGracePeriod:ed}=(0,b.W)(),{isPWAInstalled:eu}=(0,E.H)(),{filterConfig:em,updateFilterConfig:ep}=function(){let[e,t]=(0,d.useState)(()=>{{let e=localStorage.getItem(I);if(e)try{let t=JSON.parse(e);if(void 0!==t.status||void 0!==t.source||!t.rules)return console.log("Old filter config detected, resetting to default"),k;if(!Array.isArray(t.rules))return console.log("Invalid rules array, resetting to default"),k;return t.rules&&t.rules.forEach(e=>{if("createdAt"===e.property&&e.value){if("between"===e.operator&&"object"==typeof e.value){if(e.value.from&&"string"==typeof e.value.from){let t=e.value.from.includes("T")?e.value.from.split("T")[0]:e.value.from;e.value.from=C(t)}if(e.value.to&&"string"==typeof e.value.to){let t=e.value.to.includes("T")?e.value.to.split("T")[0]:e.value.to;e.value.to=C(t)}}else if("string"==typeof e.value){let t=e.value.includes("T")?e.value.split("T")[0]:e.value;e.value=C(t)}}}),t}catch(e){console.error("Failed to parse stored filter config:",e)}}return k});return(0,d.useEffect)(()=>{localStorage.setItem(I,JSON.stringify(e))},[e]),{filterConfig:e,updateFilterConfig:(0,d.useCallback)(e=>{t(e)},[]),resetFilterConfig:(0,d.useCallback)(()=>{t(k)},[])}}(),[ex,eh]=(0,d.useState)(!1),ef=(0,d.useMemo)(()=>["$50","$"+100,"$"+150],[]),[eg,eb]=(0,d.useState)(ef[0]),[ev,ey]=(0,d.useState)(null),[ew,ej]=(0,d.useState)(null),[eN,eC]=(0,d.useState)(null),ek=(0,S.o)();(0,d.useEffect)(()=>{{let e=window.sessionStorage.getItem("pendingChipText");e&&ej(e)}},[]),(0,d.useEffect)(()=>{ew?window.sessionStorage.setItem("pendingChipText",ew):window.sessionStorage.removeItem("pendingChipText")},[ew]),(0,d.useEffect)(()=>{{let e=window.sessionStorage.getItem("pendingPromptText");e&&eC(e)}},[]);let{viewConfig:eI,updateViewConfig:eS}=(0,N.ST)();(0,d.useEffect)(()=>{r&&eI.viewMode&&r(eI.viewMode)},[eI.viewMode,r]),(0,d.useEffect)(()=>{Q&&eN&&K.current?.setPrompt&&(console.log("[GitHub Connection] Restoring prompt text:",eN),K.current.setPrompt(eN),eC(null),window.sessionStorage.removeItem("pendingPromptText")),Q&&(window._bypassBeforeUnload=!1,console.log("[GitHub Connection] Reset bypass flag after successful connection"))},[Q,eN]);let[eE,eA]=(0,d.useState)({promptSet:!1,branchSet:!1,repoSet:!1,allProcessed:!1}),eR=(0,d.useRef)(null);(0,d.useEffect)(()=>{if(!t||!K.current)return;let{bugReport:e,repoOwner:r,repoName:s,branch:o}=t,a={...eE},n=!1;if(!a.promptSet&&K.current.setPrompt){let t=e.locations.map(e=>`${e.file}:${e.startLine}-${e.endLine}`).join(", "),r=`Fix this bug:

${e.description}

Affected files: ${t}`;console.log("[BugBot] Setting prompt from deeplink data:",{promptLength:r.length,bugId:e.id,fileLocations:t}),K.current.setPrompt(r),a.promptSet=!0,n=!0}!a.repoSet&&r&&s&&Q&&K.current.setRepo&&(et.some(e=>e.repos.some(e=>e.owner===r&&e.name===s))?(console.log("[BugBot] Setting repo from deeplink data:",{repoOwner:r,repoName:s}),K.current.setRepo(r,s),a.repoSet=!0,n=!0,eR.current&&(clearTimeout(eR.current),eR.current=null)):eR.current||(eR.current=window.setTimeout(()=>{eA(e=>e.repoSet?e:((0,M.Ej)(`Repository "${r}/${s}" not found in your connected repositories`),{...e,repoSet:!0})),eR.current=null},5e3))),!a.branchSet&&o&&K.current.setBranch&&(!(r&&s)||a.repoSet)&&(console.log("[BugBot] Setting branch from deeplink data:",{branch:o}),K.current.setBranch(o),a.branchSet=!0,n=!0);let l=!!o,i=!!(r&&s);if(a.promptSet&&(!l||a.branchSet)&&(!i||a.repoSet)&&!a.allProcessed){a.allProcessed=!0,n=!0;{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()),console.log("[BugBot] Cleared URL param after all deeplink data processed"))}}n&&eA(a)},[t,ee,er.size,et,Q,eE.promptSet,eE.repoSet,eE.branchSet,eE.allProcessed,eE]),(0,d.useEffect)(()=>()=>{eR.current&&(clearTimeout(eR.current),eR.current=null)},[]);let eM=(0,d.useMemo)(()=>W?i.get(W):null,[W,i]),eD=(0,d.useRef)(null);(0,d.useEffect)(()=>{if("undefined"==typeof document)return;null===eD.current&&(eD.current=document.title);let e=eM?.composer?.name?.trim();if(e){let t=(eD.current||"Agents").replace(/^[^–—-]+\s+[–—-]\s+/,"");document.title=`${e} – ${t}`}else eD.current&&(document.title=eD.current);return()=>{eD.current&&(document.title=eD.current)}},[eM?.composer?.name]);let[eT,eP]=(0,d.useState)(!1),[eL,e$]=(0,d.useState)(!1),e_=(0,d.useMemo)(()=>{if(!W||T||eT)return!1;let e=l.some(e=>e.bcId===W),t=i.has(W);return!(e||t)},[W,T,l,i,eT]);(0,d.useEffect)(()=>{let e=setTimeout(()=>{e$(e_)},100);return()=>clearTimeout(e)},[e_]);let[eU,eO]=(0,d.useState)(null),[eF,ez]=(0,d.useState)(!1),[eB,eG]=(0,d.useState)(!1),[eW,eq]=(0,d.useState)(!1),eK=(0,d.useMemo)(()=>{if(!W)return;let e=i.get(W);if(e?.composer?.prUrl)return e.composer.prUrl;let t=l.find(e=>e.bcId===W);return t?.prUrl||void 0},[W,i,l]),[eV,eJ]=(0,d.useState)(!1),[eZ,eX]=(0,d.useState)(!1),[eY,eQ]=(0,d.useState)(!1),[e1,e2]=(0,d.useState)(!1),[e5,e3]=(0,d.useState)(null),e4=(0,d.useCallback)((e,t)=>{e3({parentBcId:e,workflowId:t})},[]),[e6,e8]=(0,d.useState)(!1);(0,d.useEffect)(()=>{if(e6){let e=setTimeout(()=>e8(!1),2e3);return()=>clearTimeout(e)}},[e6]);let e9=(0,d.useCallback)(()=>{e2(!1),setTimeout(()=>eQ(!1),200)},[]),e7=(0,d.useCallback)(()=>{eQ(!0),setTimeout(()=>e2(!0),10)},[]);(0,d.useEffect)(()=>{if(!eY)return;let e=e=>{"Escape"!==e.key||eB||e9()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[eY,e9,eB]),(0,d.useEffect)(()=>(eY?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[eY]);let te=ek&&!!W&&eV;!function({isAnyDrawerOpen:e,defaultColorVar:t="--color-theme-bg",drawerOpenColorVar:r,defaultColorFallback:s="#17191d",drawerOpenColorFallback:o="#0b0c0e"}){(0,d.useEffect)(()=>{let a=()=>{let a=document.querySelector('meta[name="theme-color"]');a||((a=document.createElement("meta")).name="theme-color",document.head.appendChild(a));let n=f(t,s),l=r?f(r,o):function(e){let t=e.replace("#",""),r=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),a=Math.round(.5*r),n=Math.round(.5*s),l=Math.round(.5*o);return`#${a.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}(n),i=e?l:n;a.content=i};a();let n=setTimeout(a,20);return()=>{clearTimeout(n)}},[e,t,r,s,o])}({isAnyDrawerOpen:ek&&eB||te});let[tt,tr]=(0,d.useState)({Completed:0,"In Progress":0,Other:0,Archived:0}),ts=(0,d.useMemo)(()=>el===x.YTt.NO_STORAGE||el===x.YTt.UNSPECIFIED,[el]),to=(0,d.useMemo)(()=>("prompt"===eI.groupBy||"model"===eI.groupBy)&&l.some(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&!i.has(e.bcId)),[eI.groupBy,l,i]),ta=(0,d.useCallback)(()=>!ts||(G(!0),!1),[ts,G]),tn=(0,d.useCallback)(()=>{eX(!0)},[]),tl=(0,d.useCallback)(async()=>{try{if(K.current?.getPrompt){let e=K.current.getPrompt();e&&e.trim()&&(window.sessionStorage.setItem("pendingPromptText",e),console.log("[GitHub Connection] Saving prompt text:",e))}}catch(e){console.error("Failed to save prompt text to sessionStorage",e)}try{if(o?.sub){let e={sub:o.sub,timestamp:Date.now(),source:"BACKGROUND_AGENT_WEB"};window.sessionStorage.setItem("githubLinkSession",JSON.stringify(e))}}catch(e){console.error("Failed to write githubLinkSession to sessionStorage",e)}(0,v.Sv)("BACKGROUND_AGENT_WEB","website",void 0)},[o?.sub]),tc=(0,d.useCallback)(async()=>{if(eM){eq(!0);try{let e=await (0,A.jC)(eM);e.error?((0,M.Ej)(e.error),eM.composer?.repoUrl&&eM.composer?.branchName&&(R(eM.composer.repoUrl,"main",eM.composer.branchName)||console.error("Failed to open GitHub compare view"))):e.prUrl&&eM.composer&&(H(eM.composer.bcId,e.prUrl),await _())}catch(e){console.error("Failed to create PR:",e),(0,M.Ej)("Failed to create PR"),eM.composer?.repoUrl&&eM.composer?.branchName&&(R(eM.composer.repoUrl,"main",eM.composer.branchName)||console.error("Failed to open GitHub compare view"))}finally{eq(!1)}}},[eM,_,H]),td=(0,d.useCallback)(()=>{eK&&(0,A.g3)(eK)},[eK]);(0,d.useEffect)(()=>{!W||T||i.get(W)||(console.log("Fetching detailed composer for selected composer id",W),eP(!0),$(W).catch(e=>{console.error("Failed to fetch detailed composer:",e)}).finally(()=>{eP(!1)}))},[W,T,i,$]),(0,d.useEffect)(()=>{W&&!eV?eJ(!0):!W&&eV&&eJ(!1)},[W,eV]),(0,d.useEffect)(()=>{eK&&eM?.composer?.bcId?(0,A.s9)(eM.composer.bcId,eK):eM?.composer?.bcId&&(0,A.xh)(eM.composer.bcId)},[eK,eM?.composer?.bcId]);let tu=(0,d.useCallback)(e=>{if(!e)return"";let t=e.trim();return(t=(t=(t=t.replace(/^https?:\/\//,"")).replace(/\.git$/,"")).replace(/\/+$/,"")).toLowerCase()},[]),tm=(0,d.useCallback)((e,t)=>{let r,{property:s,operator:o,value:a}=t;switch(s){case"status":r=e.status??p.R6.CREATING;break;case"model":{let t=i.get(e.bcId);if(!t)return!0;r=t.modelDetails?.modelName||null;break}case"prompt":{let t=i.get(e.bcId);if(!t)return!0;r=t.prompt?.text||null;break}case"branchName":r=e.branchName||null;break;case"repoUrl":r=e.repoUrl?tu(e.repoUrl):null;break;case"createdAt":r=new Date(e.createdAtMs||0);break;case"merge":{let t=e.prUrl;if(t){let e=(0,A.Le)(t);r=e?.isMerged||!1}else r=!1;break}case"isArchived":r=e.isArchived||!1;break;default:r=null}switch(o){case"is":if("repoUrl"===s&&"string"==typeof a)return r===tu(a);return r===a;case"is_not":if("repoUrl"===s&&"string"==typeof a)return r!==tu(a);return r!==a;case"contains":if("string"==typeof r&&"string"==typeof a){if("repoUrl"===s)return r.includes(tu(a));return r.toLowerCase().includes(a.toLowerCase())}return!1;case"does_not_contain":if("string"==typeof r&&"string"==typeof a){if("repoUrl"===s)return!r.includes(tu(a));return!r.toLowerCase().includes(a.toLowerCase())}return!0;case"starts_with":if("string"==typeof r&&"string"==typeof a){if("repoUrl"===s)return r.startsWith(tu(a));return r.toLowerCase().startsWith(a.toLowerCase())}return!1;case"ends_with":if("string"==typeof r&&"string"==typeof a){if("repoUrl"===s)return r.endsWith(tu(a));return r.toLowerCase().endsWith(a.toLowerCase())}return!1;case"is_empty":return!r||""===r||Array.isArray(r)&&0===r.length;case"is_not_empty":return r&&""!==r&&(!Array.isArray(r)||r.length>0);case"any_of":if(Array.isArray(a)){if("repoUrl"===s)return a.map(e=>tu(e)).includes(r);return a.includes(r)}return!1;case"none_of":if(Array.isArray(a)){if("repoUrl"===s)return!a.map(e=>tu(e)).includes(r);return!a.includes(r)}return!0;case"before":if(r instanceof Date&&a instanceof Date)return r<a;return!1;case"after":if(r instanceof Date&&a instanceof Date)return r>a;return!1;case"between":if(r instanceof Date&&"object"==typeof a&&a.from&&a.to){let e=new Date(a.from),t=new Date(a.to);return e.setHours(0,0,0,0),t.setHours(23,59,59,999),r>=e&&r<=t}return!1;default:return!0}},[i,tu]),tp=(0,d.useCallback)(e=>{if(!em.rules||!Array.isArray(em.rules))return!0;for(let t of em.rules)if(!tm(e,t))return!1;return!0},[em,tm]),tx=(0,d.useMemo)(()=>{if(!eI.groupBy)return null;let e=new Map,t=l.filter(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&tp(e)).filter(e=>"prompt"!==eI.groupBy&&"model"!==eI.groupBy||void 0!==i.get(e.bcId));return("prompt"===eI.groupBy||"model"===eI.groupBy)&&0===t.length?null:(t.forEach(t=>{let r="Other";switch(eI.groupBy){case"status":r=(e=>{let t=e??p.R6.CREATING;return t===p.R6.CREATING||t===p.R6.RUNNING?"In Progress":t===p.R6.FINISHED||t===p.R6.UNSPECIFIED?"Completed":t===p.R6.ERROR?"Error":t===p.R6.EXPIRED?"Expired":"Other"})(t.status);break;case"branch":r=t.branchName||"No Branch";break;case"repo":if(t.repoUrl){let e=t.repoUrl.split("/");if(e.length>=2){let s=e.pop()?.replace(/\.git$/,""),o=e.pop();r=o&&s?`${o}/${s}`:t.repoUrl}else r=t.repoUrl}else r="No Repository";break;case"model":{let e=i.get(t.bcId);r=(0,eH.$L)(e?.modelDetails?.modelName);break}case"date":{let e=new Date(t.createdAtMs||0),s=new Date,o=new Date(s);o.setDate(o.getDate()-1),r=e.toDateString()===s.toDateString()?"Today":e.toDateString()===o.toDateString()?"Yesterday":e>new Date(s.getTime()-6048e5)?"This Week":e>new Date(s.getTime()-2592e6)?"This Month":"Older";break}case"merge":{let e=t.status??p.R6.CREATING;if(e===p.R6.CREATING||e===p.R6.RUNNING){r="In Progress";break}let s=t.prUrl;if(s){let e=(0,A.Le)(s);e?e.isMerged?r="Merged":e.isClosed?r="Closed":e.isDraft?r="Ready to open":(e.state,r="Open"):r="Open"}else{let e=i.get(t.bcId),s=c.get(t.bcId),o=(0,A.xH)(e||t,s);r=o&&(o.totalAdded>0||o.totalRemoved>0)?"Ready to open":"Awaiting follow-up"}break}case"prompt":r=t.promptGroupId?t.promptGroupId:`ungrouped-${t.bcId}`}e.has(r)||e.set(r,[]),e.get(r).push(t)}),Array.from(e.entries()).map(([e,t])=>{let r=e;if("prompt"===eI.groupBy&&t.length>0){let e=t[0],s=i.get(e.bcId);r=s?.prompt?.text?s.prompt.text:e.promptGroupId?"Loading...":"No Prompt"}return{name:r,composers:t.sort((e,t)=>rT(e,t,eI,i))}}).sort((e,t)=>{let r="asc"===eI.sortDirection?-1:1;if(eI.groupBy===eI.sortBy){if("date"===eI.groupBy){let s=["Today","Yesterday","This Week","This Month","Older"],o=s.indexOf(e.name),a=s.indexOf(t.name);if(-1!==o&&-1!==a)return(o-a)*r}return e.name.localeCompare(t.name)*r}if("prompt"===eI.groupBy){let r="No Prompt"===e.name,s="No Prompt"===t.name;return r&&!s?1:!r&&s?-1:e.name.localeCompare(t.name)}if("model"===eI.groupBy){let r="Unknown Model"===e.name,s="Unknown Model"===t.name;return r&&!s?1:!r&&s?-1:e.name.localeCompare(t.name)}if("merge"===eI.groupBy){let r=["In Progress","Open","Ready to open","Awaiting follow-up","Merged","Closed"],s=r.indexOf(e.name),o=r.indexOf(t.name);if(-1!==s&&-1!==o)return s-o;if(-1!==s&&-1===o)return -1;if(-1===s&&-1!==o)return 1}return e.name.localeCompare(t.name)}))},[eI,l,tp,i,c]),th=(0,d.useMemo)(()=>{if(tx)return tx;if("prompt"===eI.groupBy||"model"===eI.groupBy)return[];let e=new Map;return l.filter(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&tp(e)).forEach(t=>{let r=new Date(t.createdAtMs||0),s=new Date,o=new Date(s);o.setDate(o.getDate()-1);let a="Older";r.toDateString()===s.toDateString()?a="Today":r.toDateString()===o.toDateString()?a="Yesterday":r>new Date(s.getTime()-6048e5)?a="This Week":r>new Date(s.getTime()-2592e6)&&(a="This Month"),e.has(a)||e.set(a,[]),e.get(a).push(t)}),Array.from(e.entries()).map(([e,t])=>({name:e,composers:t.sort((e,t)=>rT(e,t,eI,i))})).sort((e,t)=>{let r=["Today","Yesterday","This Week","This Month","Older"],s=r.indexOf(e.name),o=r.indexOf(t.name);return -1!==s&&-1!==o?s-o:e.name.localeCompare(t.name)})},[l,tx,eI,i,tp]),tf=(0,d.useMemo)(()=>{let e=th.flatMap(e=>e.composers),t=e.filter(e=>(e.status??p.R6.UNSPECIFIED)===p.R6.ERROR),r=e.filter(e=>(e.status??p.R6.UNSPECIFIED)===p.R6.EXPIRED),s=th.filter(e=>"Errored"!==e.name&&"Expired"!==e.name).map(e=>({...e,composers:e.composers.filter(e=>{let t=e.status??p.R6.UNSPECIFIED;return t!==p.R6.ERROR&&t!==p.R6.EXPIRED})})).filter(e=>e.composers.length>0),o=[];return t.length&&o.push({name:"Errored",composers:t}),r.length&&o.push({name:"Expired",composers:r}),[...s,...o]},[th]),tg=(0,d.useMemo)(()=>th.filter(e=>e.composers.length>0).map((e,t)=>({...e,index:t})),[th]),tb=(0,d.useCallback)(()=>{if(!eU||0===tg.length)return 0;for(let e=0;e<tg.length;e++)if(tg[e].composers.some(e=>e.bcId===eU))return e;return 0},[eU,tg]),tv=(0,d.useCallback)(()=>{if(0===tg.length)return;let e=(tb()+1)%tg.length,t=tg[e];t&&t.composers.length>0&&(tr(e=>({...e,[t.name]:0})),eO(t.composers[0].bcId))},[tg,tb]),ty=(0,d.useCallback)(()=>{if(0===tg.length)return;let e=tb(),t=0===e?tg.length-1:e-1,r=tg[t];r&&r.composers.length>0&&(tr(e=>({...e,[r.name]:0})),eO(r.composers[0].bcId))},[tg,tb]),tj=(0,d.useCallback)(()=>tg.length>0?tg[0]:null,[tg]),tN=(0,d.useCallback)(e=>{for(let t of tg)if(t.composers.some(t=>t.bcId===e))return t;return null},[tg]),tC=(0,d.useCallback)(e=>{let t=tg.find(t=>t.name===e);if(!t)return;let r=tt[e]||0;r<Math.ceil(t.composers.length/5)-1&&tr(t=>({...t,[e]:r+1}))},[tg,tt]),tk=(0,d.useCallback)(e=>{let t=tt[e]||0;t>0&&tr(r=>({...r,[e]:t-1}))},[tt]),tI=(0,d.useMemo)(()=>th.flatMap(e=>e.composers),[th]),tS=(0,d.useMemo)(()=>eU?tI.findIndex(e=>e.bcId===eU):-1,[eU,tI]),tE=(0,d.useCallback)(()=>{q(null)},[q]),tA=(0,d.useCallback)(()=>{eh(e=>!e)},[]),tR=(0,d.useCallback)(async e=>{q(e.bcId);try{await fetch("/api/auth/notifyBackgroundComposerShown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.bcId})})}catch(e){console.error("Failed to notify background composer shown:",e)}if(!i.get(e.bcId))try{let t=await fetch("/api/background-composer/get-detailed-composer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.bcId,n:1,includeDiff:!0,includeTeamWide:!0})}),r=new p.VF().fromJson(await t.json(),{ignoreUnknownFields:!0});r.composers?.[0]?.composer?.bcId&&q(r.composers[0].composer.bcId)}catch(e){console.error("Failed to fetch detailed composer:",e)}},[i,q]),tM=(0,d.useCallback)(e=>{let t=null,r=-1,s=-1;for(let o=0;o<th.length;o++){let a=th[o],n=a.composers.findIndex(t=>t.bcId===e);if(-1!==n){t=a,r=o,s=n;break}}if(!t)return null;if(s<t.composers.length-1){let e=t.composers[s+1],r=Math.floor((s+1)/5);if(t){let e=t.name;r!==(tt[e]||0)&&tr(t=>({...t,[e]:r}))}return e}for(let e=r+1;e<th.length;e++){let t=th[e];if(t.composers.length>0)return tr(e=>({...e,[t.name]:0})),t.composers[0]}return null},[th,tt]),tD=(0,d.useCallback)(e=>{let t=null,r=-1,s=-1;for(let o=0;o<th.length;o++){let a=th[o],n=a.composers.findIndex(t=>t.bcId===e);if(-1!==n){t=a,r=o,s=n;break}}if(!t)return null;if(s>0){let e=t.composers[s-1],r=Math.floor((s-1)/5);if(t){let e=t.name;r!==(tt[e]||0)&&tr(t=>({...t,[e]:r}))}return e}for(let e=r-1;e>=0;e--){let t=th[e];if(t.composers.length>0){let e=t.composers[t.composers.length-1],r=Math.floor((t.composers.length-1)/5);return tr(e=>({...e,[t.name]:r})),e}}return null},[th,tt]),[tT,tP]=(0,d.useState)(!0),[tL,t$]=(0,d.useState)(!0);!function({selectedComposerId:e,isInputFocused:t,isAnyDropdownOpen:r,highlightedComposerId:s,setHighlightedComposerId:o,selectedIndex:a,flattenedComposers:n,findNextComposer:l,findPrevComposer:i,handleSelectComposer:c,handleCloseModal:d,navigateToNextSection:u,navigateToPreviousSection:m,getFirstRenderedSection:p,getSectionContainingComposer:x,navigateToNextPageInSection:h,navigateToPreviousPageInSection:f,sectionPagination:g,prLoading:b,openExistingPullRequest:v,toggleLeftSidebar:y,toggleRightPane:w}){let j=t||r||e||0===n.length;(0,ti.vC)("esc",()=>{!r&&(document.querySelectorAll('[data-menu-open="true"], .menu-open, [aria-expanded="true"]').length>0||(e?d():o(null)))},{enabled:!t,preventDefault:!r},[e,d,o,t,r]),(0,ti.vC)("down",()=>{if(!s){n.length>0&&o(n[0].bcId);return}let e=l(s);e&&o(e.bcId)},{enabled:!j,preventDefault:!0},[s,n,l,o,j]),(0,ti.vC)("up",()=>{if(!s){n.length>0&&o(n[n.length-1].bcId);return}let e=i(s);e&&o(e.bcId)},{enabled:!j,preventDefault:!0},[s,n,i,o,j]),(0,ti.vC)("enter",()=>{a>=0&&a<n.length&&c(n[a])},{enabled:!j,preventDefault:!0},[a,n,c,j]),(0,ti.vC)("p, shift+p",()=>{a>=0&&a<n.length&&n[a].prUrl&&!b&&v()},{enabled:!j,preventDefault:!0},[a,n,b,v,j]),(0,ti.vC)("j, shift+j",()=>{u()},{enabled:!j,preventDefault:!0},[u,j]),(0,ti.vC)("k, shift+k",()=>{m()},{enabled:!j,preventDefault:!0},[m,j]),(0,ti.vC)("left",()=>{if(s){let e=x(s);if(e){let t=g[e.name]||0;if(t>0){f(e.name);let r=(t-1)*5;e.composers[r]&&o(e.composers[r].bcId)}}}else{let e=p();if(e){let t=g[e.name]||0;if(t>0){f(e.name);let r=(t-1)*5;e.composers[r]&&o(e.composers[r].bcId)}}}},{enabled:!j,preventDefault:!0},[s,p,g,f,o,x,j]),(0,ti.vC)("right",()=>{if(s){let e=x(s);if(e){let t=g[e.name]||0;if(t<Math.ceil(e.composers.length/5)-1){h(e.name);let r=(t+1)*5;e.composers[r]&&o(e.composers[r].bcId)}}}else{let e=p();if(e){let t=g[e.name]||0;if(t<Math.ceil(e.composers.length/5)-1){h(e.name);let r=(t+1)*5;e.composers[r]&&o(e.composers[r].bcId)}}}},{enabled:!j,preventDefault:!0},[s,p,g,h,o,x,j]),(0,ti.vC)("c, shift+c",()=>{if(a>=0&&a<n.length){let e=n[a];(0,A.Q1)(e.bcId)}},{enabled:!j,preventDefault:!0},[a,n,j]),(0,ti.vC)("mod+b",()=>{y()},{preventDefault:!0},[]),(0,ti.vC)("mod+alt+b",()=>{w()},{preventDefault:!0},[])}({selectedComposerId:W,isInputFocused:eF,isAnyDropdownOpen:eB,highlightedComposerId:eU,setHighlightedComposerId:eO,selectedIndex:tS,flattenedComposers:tI,detailedComposers:i,findNextComposer:tM,findPrevComposer:tD,handleSelectComposer:tR,handleCloseModal:tE,navigateToNextSection:tv,navigateToPreviousSection:ty,getFirstRenderedSection:tj,getSectionContainingComposer:tN,navigateToNextPageInSection:tC,navigateToPreviousPageInSection:tk,sectionPagination:tt,prLoading:eW,openExistingPullRequest:td,toggleLeftSidebar:(0,d.useCallback)(()=>{tP(e=>!e)},[]),toggleRightPane:(0,d.useCallback)(()=>{t$(e=>!e)},[])}),(0,d.useEffect)(()=>{if(a||!n&&!o){let e=encodeURIComponent(window.location.href);window.location.href=`/api/auth/login?redirect_uri=${e}`}},[o,a,n]);let t_=(0,d.useCallback)(async()=>{try{let e=50;e="Custom"===eg?ev||50:parseInt(eg.replace("$",""))||50,await ea(e,void 0),O(!1)}catch(e){console.error("Failed to toggle hard limit:",e)}},[eg,ea,O,ev]),tU=(0,d.useCallback)(e=>{eb(e),"Custom"!==e&&ey(null)},[]),tO=(0,d.useCallback)(e=>{e>1e5?ey(1e5):ey(e),eb("Custom")},[]),[tF,tz]=(0,d.useState)(!1),[tB,tG]=(0,d.useState)(null);(0,d.useEffect)(()=>{tG("true"===localStorage.getItem("hasSeenAnnouncementModal"))},[]);let tH=(0,d.useCallback)(()=>{tG(!0),localStorage.setItem("hasSeenAnnouncementModal","true")},[]),tW=(0,d.useCallback)(async()=>{if(!tF){tz(!0);try{let e=await en({tier:"pro",isFromAgentsPage:!0});window.open(e,"_blank","noopener,noreferrer")}catch(e){console.error("[Upgrade] Error creating checkout URL:",e)}finally{setTimeout(()=>{tz(!1)},3e3)}}},[tF,en]),[tq,tK]=(0,d.useState)(null);(0,d.useEffect)(()=>{if("full"===eI.viewMode||!eM?.composer?.bcId)return void tK(null);let e=c.get(eM.composer.bcId);tK((0,A.xH)(eM,e))},[eM,c,eI.viewMode]);let tV=(0,d.useMemo)(()=>u(eM?.composer?.bcId||""),[u,eM?.composer?.bcId]);(0,d.useMemo)(()=>{if(eM?.composer?.bcId)return D(eM.composer.bcId)},[D,eM?.composer?.bcId]);let tJ=(0,d.useRef)(null),tZ=(0,d.useRef)(new Map),tX=eM?.composer?.bcId,tY=eM?.composer?.status,tQ=(0,d.useRef)({bcId:null,status:void 0});(0,d.useEffect)(()=>{if(tX){let{bcId:e,status:t}=tQ.current;(e!==tX||t!==tY)&&(V.current?.(tX,tY),tQ.current={bcId:tX,status:tY})}else tQ.current.bcId&&(J.current?.(),tQ.current={bcId:null,status:void 0},tJ.current=null)},[tX,tY]),(0,d.useEffect)(()=>()=>{J.current?.(),tQ.current={bcId:null,status:void 0}},[]),(0,d.useEffect)(()=>()=>{tZ.current.clear()},[]);let t0=(0,d.useMemo)(()=>{if(!W)return null;for(let e=0;e<th.length;e++){let t=th[e],r=t.composers.findIndex(e=>e.bcId===W);if(-1!==r){let s=t.composers[r],o=[s];return s.promptGroupId&&(o=t.composers.filter(e=>e.promptGroupId===s.promptGroupId)),{sectionIndex:e,composerIndex:r,section:{...t,composers:o}}}}return null},[W,th]),t1=(0,d.useMemo)(()=>{if(!t0)return!1;let{sectionIndex:e,composerIndex:t}=t0;if(t>0)return!0;for(let t=e-1;t>=0;t--)if(th[t].composers.length>0)return!0;return!1},[t0,th]),t2=(0,d.useMemo)(()=>{if(!t0)return!1;let{sectionIndex:e,composerIndex:t,section:r}=t0;if(t<r.composers.length-1)return!0;for(let t=e+1;t<th.length;t++)if(th[t].composers.length>0)return!0;return!1},[t0,th]),t3=(0,d.useCallback)(e=>{K.current&&K.current.setPrompt(e)},[K]);return(0,s.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[ek&&(0,s.jsxs)("div",{className:"container mx-auto flex max-w-[660px] flex-col gap-4 px-4 py-0 sm:gap-1.5",children:[(0,s.jsx)(e0,{onFocusChange:ez,onDropdownOpenChange:eG,onBeforeSubmit:ta,viewConfig:eI,onViewConfigChange:eS,filterConfig:em,onFilterConfigChange:ep,inputRef:K,githubConnected:Q,isGithubLoading:ee,onConnectGithub:tn,githubError:es,deeplinkData:t,onOrchestraStarted:e4}),!W&&0===l.length&&!T&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(tw,{onChipClick:t3})})]}),"full"===eI.viewMode&&(0,s.jsx)(t5,{allSections:th,detailedComposers:i,detailedDiffs:c,selectedComposerId:W,selectedComposer:eM??null,isComposerNotFound:eL,prLoading:eW,existingPrUrl:eK,isConversationCollapsed:ex,isInputFocused:eF,isAnyDropdownOpen:eB,isLeftSidebarVisible:tT,setIsLeftSidebarVisible:tP,isRightPaneVisible:tL,setIsRightPaneVisible:t$,viewConfig:eI,filterConfig:em,inputBoxRef:K,githubConnected:Q,githubError:es,onCloseModal:tE,onCollapseConversation:tA,onSelectComposer:tR,onSetSelectedComposerId:q,onFocusChange:ez,onDropdownOpenChange:eG,onBeforeSubmit:ta,backgroundComposers:l,backgroundComposersLoading:T,onViewConfigChange:eS,onFilterConfigChange:ep,onConnectGithub:tn,onOpenExistingPullRequest:td,onOpenPullRequest:tc,deeplinkData:t,onOpenNewAgentModal:e7,onOrchestraStarted:e4}),"full"!==eI.viewMode&&(0===l.length?T?(0,s.jsx)("div",{className:`container mx-auto flex max-w-[660px] flex-col gap-4 px-4 py-0 sm:gap-1.5 sm:px-14 ${ek?"pb-[96px]":""}`,children:(0,s.jsx)("div",{className:"flex flex-col gap-[16px]",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("div",{className:"h-4 w-32 animate-pulse rounded bg-theme-border opacity-30"}),[void 0,void 0].map((e,r)=>(0,s.jsx)("div",{className:"h-24 w-full animate-pulse rounded-lg bg-theme-border opacity-20",style:{animationDelay:`${(2*t+r)*100}ms`}},r))]},t))})}):null:th.length>0?(0,s.jsx)("div",{className:`container mx-auto flex max-w-[660px] flex-col gap-4 px-4 py-0 sm:gap-1.5 ${ek?"pb-[96px]":""}`,children:(0,s.jsx)("div",{className:`flex flex-col ${"prompt"===eI.groupBy?"gap-[32px]":"gap-[4px]"}`,children:tf.filter(e=>e.composers.length>0).map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(rj,{title:e.name,composers:e.composers,sectionPagination:tt,setSectionPagination:tr,flattenedComposers:tI,selectedIndex:tS,detailedComposers:i,prLoading:eW,onOpenExistingPullRequest:td,onSelectComposer:tR,viewConfig:eI})},e.name))})}):null),l.length>0&&"full"!==eI.viewMode&&0===th.length&&(em?.rules&&em.rules.length>0||eI.groupBy)&&!to&&(0,s.jsx)("div",{className:"container mx-auto max-w-[660px] px-4 py-0 sm:px-14",children:(0,s.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center gap-2 text-theme-text-secondary",children:[(0,s.jsx)("span",{className:"web-text-base text-theme-text-primary",children:"No agents match filter"}),(0,s.jsx)("button",{className:"rounded-md bg-gray-500/5 px-2 py-1 web-text-base text-theme-text-secondary transition-colors hover:bg-gray-500/10 hover:text-gray-300",onClick:()=>{ep(k),eS({...eI,groupBy:null})},children:"Clear filters"})]})}),"full"!==eI.viewMode&&(0,s.jsx)(s.Fragment,{children:ek?(0,s.jsx)(rm,{selectedComposerId:W,isModalVisible:eV,handleCloseModal:tE,selectedComposer:eM,selectedComposerDiffStats:tq,isComposerNotFound:eL,prLoading:eW,existingPrUrl:eK,onOpenExistingPullRequest:td,onOpenPullRequest:tc,groupedComposers:t0?.section.composers??null,groupTitle:t0?.section.name??null,onSelectComposer:tR}):(0,s.jsx)(ru,{selectedComposerId:W,isModalVisible:eV,handleCloseModal:tE,isConversationCollapsed:ex,isConversationLoading:0===tV.length||T,selectedComposer:eM,selectedComposerDiffStats:tq,isComposerNotFound:eL,prLoading:eW,existingPrUrl:eK,onOpenInCursor:A.Q1,onOpenExistingPullRequest:td,onOpenPullRequest:tc,handleCollapseConversation:tA,onSelectPrevious:()=>{if(W){let e=tD(W);e&&tR(e)}},onSelectNext:()=>{if(W){let e=tM(W);e&&tR(e)}},hasPrevious:t1,hasNext:t2})}),ek?(0,s.jsx)(rA,{showUpgradeModal:F,setShowUpgradeModal:z,onUpgradeToPro:()=>{tW()}}):(0,s.jsx)(rN,{showUpgradeModal:F,setShowUpgradeModal:z,onUpgradeToPro:tW,isUpgrading:tF}),ek?(0,s.jsx)(rR,{showUsagePricingModal:U,setShowUsagePricingModal:O,handleHardLimitToggle:t_,stripeStatus:eo,limitOptions:ef,selectedLimit:eg,customValue:ev,handleLimitSelect:tU,handleCustomLimitChange:tO}):(0,s.jsx)(rk,{showUsagePricingModal:U,setShowUsagePricingModal:O,handleHardLimitToggle:t_,stripeStatus:eo,limitOptions:ef,selectedLimit:eg,customValue:ev,handleLimitSelect:tU,handleCustomLimitChange:tO}),(0,s.jsx)(rD,{showPrivacyModeModal:B,setShowPrivacyModeModal:G,isLoadingPrivacyMode:ei,isEnforcedByTeam:ec,isMobile:ek,hoursRemainingInGracePeriod:ed}),(0,s.jsx)(rE,{isOpen:eZ,onClose:()=>eX(!1),onConnect:tl}),(0,s.jsx)(t8,{isOpen:!1===tB&&!ek&&!eu&&0===l.length&&!T&&!W,onClose:tH}),Q&&(0,s.jsx)(rS,{inputBoxRef:K,showFAB:e,onFocusChange:ez,onDropdownOpenChange:eG,onBeforeSubmit:ta,viewConfig:eI,onViewConfigChange:eS,filterConfig:em,onFilterConfigChange:ep,githubConnected:Q,isGithubLoading:ee,onConnectGithub:tn}),eY&&(0,s.jsx)("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-all duration-200 ease-out ${e1?"bg-black/50 opacity-100":"bg-black/0 opacity-0"}`,onClick:e9,children:(0,s.jsx)("div",{className:`mx-4 w-full max-w-2xl rounded-[16px] border border-gray-500/10 bg-gradient-to-b from-[#17191D] to-[#1B1D21] shadow-2xl transition-all duration-200 ease-out ${e1?"translate-y-0 scale-100 opacity-100":"translate-y-2 scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),style:{minHeight:"120px"},children:(0,s.jsx)("div",{className:"p-1.5",children:(0,s.jsx)(e0,{onFocusChange:ez,onDropdownOpenChange:eG,onBeforeSubmit:()=>{let e=ta();return e&&setTimeout(()=>e9(),100),e},viewConfig:eI,isFloating:!0,onViewConfigChange:eS,filterConfig:em,onFilterConfigChange:ep,inputRef:K,githubConnected:Q,onConnectGithub:tn,githubError:es,hasOpenModal:!0,onOrchestraStarted:e4})})})})]})}var rL=r(32030);let r$="web-push-permission-requested",r_="web-push-token",rU="web-push-device-id";var rO=r(20350);async function rF(e){try{let t=await (0,rO.J)(e);if("BUGBOT_FIX_IN_WEB"!==t.type)throw Error("Invalid deeplink type");if(1!==t.version)throw Error("Unsupported payload version");return t}catch(e){throw console.error("JWT validation failed:",e),e}}async function rz(e,t){try{let r=await fetch("/api/bugbot/encrypted-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({redis_key:e,encryption_key:t})});if(!r.ok)throw Error(`Failed to fetch bug data: ${r.status}`);return(await r.json()).bugReport}catch(e){throw console.error("Failed to fetch bug data:",e),e}}async function rB(e){try{let t=await rF(e);return{bugReport:await rz(t.data.redisKey,t.data.encryptionKey),repoOwner:t.data.repoOwner,repoName:t.data.repoName,branch:t.data.branch,prNumber:t.data.prNumber,commitSha:t.data.commitSha,provider:t.data.provider,hostname:t.data.hostname}}catch(e){return console.error("Failed to handle bugbot deeplink:",e),u.oR.error(`Failed to handle bugbot deeplink: ${e instanceof Error?e.message:"Unknown error"}`),null}}var rG=r(41866),rH=r.n(rG);function rW(){let e=(0,ed.t)(),t=(0,y.useGateValue)("platform_workflows");return(0,s.jsx)("div",{className:"px-4 pt-2 sm:px-9",children:(0,s.jsxs)("div",{className:"flex h-[64px] w-full items-center justify-between p-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-4 self-start pt-3",children:(0,s.jsx)(tH.A,{href:e?void 0:"/home?from=agents",onClick:void 0})}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",style:{marginRight:"-8px"},children:[(0,s.jsxs)(s.Fragment,{children:[(t||!1)&&(0,s.jsx)(rH(),{href:"/platform",className:"cursor-pointer text-theme-text-secondary px-2 py-1 rounded-full transition-colors hover:text-theme-text-primary",children:(0,s.jsx)("div",{className:"web-text-base",children:"Platform"})}),(0,s.jsx)(rH(),{href:"/dashboard",className:"cursor-pointer text-theme-text-secondary px-2 py-1 rounded-full transition-colors hover:text-theme-text-primary",children:(0,s.jsx)("div",{className:"web-text-base",children:"Dashboard"})})]}),(0,s.jsx)(eo.i,{})]})]})})}function rq(){let e=(0,d.useRef)(null),[t,r]=(0,d.useState)(!1),[o,n]=(0,d.useState)(null),m=function(){let[e,t]=(0,d.useState)({isSupported:!1,permissionStatus:null,isRegistered:!1,isLoading:!1,error:null});(0,d.useEffect)(()=>{let e=rL.xl&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window;t(t=>({...t,isSupported:e,permissionStatus:e?Notification.permission:null}))},[]);let r=()=>"true"===localStorage.getItem(r$),s=(0,d.useCallback)(()=>localStorage.getItem(r_),[]),o=(0,d.useCallback)(e=>{localStorage.setItem(r_,e)},[]),a=(0,d.useCallback)(()=>{localStorage.removeItem(r_)},[]),n=async()=>{if(!("serviceWorker"in navigator))throw Error("Service Worker not supported");try{let e=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});return await navigator.serviceWorker.ready,e}catch(e){throw console.error("Service Worker registration failed:",e),e}},l=async e=>await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){let t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),s=window.atob(r),o=new Uint8Array(s.length);for(let e=0;e<s.length;++e)o[e]=s.charCodeAt(e);return o}("BACmRDpfKPQIh4RAQhbb3lsdesotPXWZmUTMgAGSAiWt8U60nrRpPkL4sdrice12Ni3KRdwQ9b4xfmPAR5tES_o")}),i=(0,d.useCallback)(async e=>{let t=function(){let e=localStorage.getItem(rU);if(e)return e;let t=`web-${Date.now()}-${Math.random().toString(36).slice(2,11)}`;return localStorage.setItem(rU,t),t}(),r=JSON.stringify(e.toJSON()),s=new p.nL({token:r,deviceId:t,platform:p.ir.WEB}),a=await fetch("/api/auth/registerPushNotificationToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.toJson())});if(!a.ok)throw Error(`Failed to register push token: ${a.statusText}`);o(r)},[o]),c=(0,d.useCallback)(async()=>{if(!e.isSupported)return t(e=>({...e,error:"Push notifications are not supported on this device"})),!1;if(r()||"granted"===Notification.permission)return!0;t(e=>({...e,isLoading:!0,error:null}));try{let e=await Notification.requestPermission();if(localStorage.setItem(r$,"true"),t(t=>({...t,permissionStatus:e})),"granted"!==e)return t(e=>({...e,isLoading:!1})),!1;let r=await n(),s=await l(r);return await i(s),t(e=>({...e,isRegistered:!0,isLoading:!1})),!0}catch(e){return console.error("Error requesting push permission:",e),t(t=>({...t,error:e instanceof Error?e.message:"Failed to set up push notifications",isLoading:!1})),!1}},[e.isSupported,i]);return(0,d.useEffect)(()=>{e.isSupported&&(async()=>{try{s()&&"granted"===Notification.permission&&((await navigator.serviceWorker.getRegistrations()).length>0?t(e=>({...e,isRegistered:!0})):a())}catch(e){console.error("Error checking push registration:",e)}})()},[e.isSupported,s,a]),{...e,requestPermission:c,hasBeenAskedForPermission:r,shouldRequestPermission:e.isSupported&&!r()&&"default"===Notification.permission}}(),[x,h]=(0,d.useState)(null),f=(0,S.o)(),[g,b]=(0,d.useState)(!1),v=(0,c.useSearchParams)(),y=v?.get("selectedBcId")||v?.get("id")||null;return(0,d.useEffect)(()=>{let t=e.current;if(!t)return;let s=()=>{r(t.scrollTop>182)};return s(),t.addEventListener("scroll",s,{passive:!0}),()=>{t.removeEventListener("scroll",s)}},[]),(0,d.useEffect)(()=>{(async()=>{let e=new URLSearchParams(window.location.search).get("data");if(e)try{let t=await rB(e);if(t){h(t),setTimeout(()=>{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()))},6e3);let e=t.bugReport.id||"unknown";try{await fetch("/api/bugbotDeeplinkEvent",{method:"POST",headers:{"Content-Type":"application/json"},body:new l.i9({userId:0,bugId:e,event:l.A4.HANDLED_FIX_IN_WEB}).toJsonString()})}catch(e){}}}catch(e){console.error("Failed to handle BugBot deeplink:",e),setTimeout(()=>{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()))},6e3);try{await fetch("/api/bugbotDeeplinkEvent",{method:"POST",headers:{"Content-Type":"application/json"},body:new l.i9({userId:0,bugId:"unknown",event:l.A4.ERROR}).toJsonString()})}catch(e){}}})()},[]),(0,d.useEffect)(()=>{localStorage.setItem("hasVisitedAgents","true")},[]),(0,d.useEffect)(()=>{b(!0)},[]),(0,d.useEffect)(()=>{(async()=>{m.shouldRequestPermission&&(await m.requestPermission()?console.log("Web push notifications enabled"):console.log("Web push notifications permission denied or failed"))})()},[m.shouldRequestPermission,m.requestPermission]),(0,s.jsxs)(j.q,{children:[(0,s.jsx)(a(),{id:"6ab12870f5b27be0",children:"html{overscroll-behavior:none}@media(min-width:769px){.agents-page ::-webkit-scrollbar{width:8px;height:8px}.agents-page ::-webkit-scrollbar-track{background:transparent}.agents-page ::-webkit-scrollbar-thumb{background:rgba(156,163,175,.3);border-radius:4px}.agents-page ::-webkit-scrollbar-thumb:hover{background:rgba(156,163,175,.3)}.agents-page *{scrollbar-width:thin;scrollbar-color:rgba(156,163,175,.3)transparent}.agents-page *:hover{scrollbar-color:rgba(156,163,175,.3)transparent}}@media(max-width:768px){.agents-page ::-webkit-scrollbar{display:none;width:0;height:0;-webkit-appearance:none}.agents-page *::-webkit-scrollbar{display:none;width:0;height:0;-webkit-appearance:none}.agents-page *{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch}.agents-page div{scrollbar-width:none;-ms-overflow-style:none}}"}),(0,s.jsx)(u.l$,{theme:"dark",position:"bottom-left",closeButton:!0,toastOptions:{style:{background:"#1b1d21",color:"d1d5db",borderColor:"#24262a"}}}),(0,s.jsx)(w.UQ,{initialSelectedComposerId:y,children:(0,s.jsxs)("div",{ref:e,className:"jsx-6ab12870f5b27be0 "+((0,i.cn)("agents-page flex h-screen min-h-screen flex-col overflow-y-auto")||""),children:[g&&f&&(0,s.jsx)(rW,{}),(0,s.jsx)(d.Suspense,{fallback:(0,s.jsx)(s.Fragment,{children:" "}),children:(0,s.jsx)(rP,{showFAB:t,deeplinkData:x,onViewModeChange:n})})]})})]})}},48e3:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Tabs:()=>l});var s=r(99345),o=r(88341),a=r(32539),n=r(67638);let l=(0,o.memo)(({options:e,onChange:t,activeIndex:r=0,className:l,optionsClassName:i,activeOptionsClassName:c,chipClassName:d,chipOffset:u=1,gap:m=0})=>{let p=(0,o.useRef)(null),[x,h]=(0,o.useState)(!1),[f,g]=(0,o.useState)({width:0,transform:0});(0,o.useEffect)(()=>{setTimeout(()=>h(!0),1)},[]),(0,o.useEffect)(()=>{let e=()=>{if(!p.current)return;let e=Array.from(p.current.querySelectorAll(".option-tab")),t=e.slice(0,r).reduce((e,t)=>e+(t?.offsetWidth+m||0),-u);g({width:(e[r]?.offsetWidth||0)+2*u,transform:t})};e();let t=new ResizeObserver(()=>{e()});return p.current&&t.observe(p.current),()=>{t.disconnect()}},[r,m,u]);let b=(0,o.useMemo)(()=>e.map((e,o)=>(0,s.jsx)("button",{className:(0,n.cn)("option-tab relative z-[2] flex items-center justify-center -outline-offset-2","h-5.5 px-2.5","text-brand-borders hover:text-brand-neutrals-400",r===o&&"text-brand-neutrals-400",x&&"transition-colors duration-300","motion-reduce:transition-none",i,r===o&&c),onClick:()=>t&&t(e.value),type:"button",children:(0,s.jsx)(a.o5,{variant:"label",as:"span",className:"relative z-10 uppercase",children:e.name})},o)),[r,c,x,t,e,i]),v=(0,o.useMemo)(()=>({gap:`${m}px`}),[m]),y=(0,o.useMemo)(()=>({"--transform-x":`${f.transform}px`,"--width":`${f.width}px`,"--tw-enter-translate-y":"-50%"}),[f.transform,f.width]);return(0,s.jsxs)("div",{ref:p,className:(0,n.cn)("relative z-10 flex w-fit overflow-hidden rounded-md border border-brand-neutrals-100 animate-in fade-in dark:border-brand-neutrals-800",l),style:v,children:[b,x&&(0,s.jsx)("span",{style:y,className:(0,n.cn)("animate-in fade-in","absolute top-1/2 z-[1] -translate-y-1/2 translate-x-[var(--transform-x)]","h-[calc(100%_+_1px)] w-[var(--width)]","rounded-md","border","bg-brand-white dark:bg-brand-neutrals-900","border-brand-neutrals-100 dark:border-brand-neutrals-800","transition-all duration-400 ease-out-cubic",d)})]})});l.displayName="Tabs"},65855:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DropdownMenu:()=>l,DropdownMenuContent:()=>c,DropdownMenuGroup:()=>p,DropdownMenuItem:()=>d,DropdownMenuLabel:()=>u,DropdownMenuSeparator:()=>m,DropdownMenuTrigger:()=>i});var s=r(99345),o=r(957),a=r(88341),n=r(67638);let l=o.bL,i=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(o.l9,{ref:r,className:e,...t}));i.displayName=o.l9.displayName;let c=a.forwardRef(({className:e,sideOffset:t=4,...r},a)=>(0,s.jsx)(o.ZL,{children:(0,s.jsx)(o.UC,{ref:a,sideOffset:t,className:(0,n.cn)("z-popover w-full rounded-lg border outline-none","border-brand-neutrals-100 bg-brand-white text-brand-light-black dark:border-brand-neutrals-800 dark:bg-brand-medium-black dark:text-brand-light-grey-wash","max-w-[min(42rem,_var(--radix-popover-content-available-width))]","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2","data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2","data-[side=top]:slide-in-from-bottom-2",e),...r})}));c.displayName=o.UC.displayName;let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(o.q7,{ref:r,className:(0,n.cn)("relative flex","web-text-base/[1rem] tracking-4 text-brand-light-black dark:text-brand-light-grey-wash","transition-colors duration-300","gap-2 gap-x-3 p-3.5","web-text-base","rounded-md","cursor-pointer select-none","outline-none","hover:bg-brand-neutrals-50/50 dark:hover:bg-brand-light-black","hover:text-brand-neutrals-600 dark:hover:text-brand-neutrals-400","focus:text-brand-neutrals-600 dark:focus:text-brand-neutrals-400","data-[disabled]:pointer-events-none data-[disabled]:opacity-50","transition-colors","[&_svg]:pointer-events-none","motion-reduce:transition-none",e),...t}));d.displayName=o.q7.displayName;let u=o.JU,m=o.wv,p=o.YJ},73452:(e,t,r)=>{"use strict";r.d(t,{A4:()=>o,i9:()=>a});var s=r(7475);let o=s.C.makeEnum("aiserver.v1.BugbotDeeplinkEventKind",[{no:0,name:"BUGBOT_DEEPLINK_EVENT_KIND_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"BUGBOT_DEEPLINK_EVENT_KIND_CLICKED",localName:"CLICKED"},{no:2,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_DIALOG_SHOWN",localName:"HANDLED_DIALOG_SHOWN"},{no:3,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_CHAT_CREATED",localName:"HANDLED_CHAT_CREATED"},{no:4,name:"BUGBOT_DEEPLINK_EVENT_KIND_ERROR",localName:"ERROR"},{no:5,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_FIX_IN_WEB",localName:"HANDLED_FIX_IN_WEB"}]),a=s.C.makeMessageType("aiserver.v1.LogDeeplinkEventRequest",()=>[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"bug_id",kind:"scalar",T:9},{no:3,name:"comment_id",kind:"scalar",T:3,opt:!0},{no:4,name:"event",kind:"enum",T:s.C.getEnumType(o)}])},76560:(e,t,r)=>{"use strict";r.d(t,{H:()=>n});var s=r(13528),o=r(51875);let a=["dashboard","me"],n=()=>(0,o.I)({queryKey:a,queryFn:async()=>{let e=await fetch("/api/dashboard/get-me",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new s.Ewt)});if(!e.ok)throw Error(`Failed to get user: ${e.statusText}`);let t=await e.json();return s.S7I.fromJson(t)},enabled:!0})},79598:(e,t,r)=>{"use strict";r.d(t,{Li:()=>n,TD:()=>a,ZF:()=>l,pP:()=>o});var s=r(28921);function o(e){return e?.sub?e.sub:e?.email?e.email:void 0}let a={staleTime:3e5,gcTime:18e5,refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)};function n(e,t,r){let o=Object.keys(t).sort().reduce((e,r)=>{let s=t[r];if(null!=s)if(s instanceof Date){let t=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");e[r]=`${t}-${o}-${a}`}else e[r]=s;return e},{});return(0,s.createHash)("md5").update(JSON.stringify({endpoint:e,params:o,userContext:r})).digest("hex").substring(0,16)}async function l(e,t={}){return fetch(e,{...t,headers:{Accept:"application/json","Cache-Control":"max-age=300",...t.headers}})}},85637:(e,t,r)=>{"use strict";r.d(t,{m:()=>d});var s=r(99345),o=r(65855),a=r(67638),n=r(88341),l=r(57638),i=r(38448),c=r(66416);r(19628);let d=({items:e=[],groups:t=[],trigger:r,isLoading:d=!1,disabled:u=!1,className:m="",buttonClassName:p="",triggerTextClassName:x="",menuClassName:h="",menuAlign:f="right",size:g="base",style:b="outline",onOpenChange:v,searchable:y=!1,searchPlaceholder:w="Search...",value:j,footer:N})=>{let[C,k]=(0,n.useState)(!1),[I,S]=(0,n.useState)(""),E=(0,n.useRef)(null),A=(0,n.useMemo)(()=>t.length>0?t.flatMap(e=>e.items):e,[e,t]),R=(0,n.useMemo)(()=>{if(!y||!I.trim())return A;let e=I.toLowerCase();return A.filter(t=>(t.searchText??("string"==typeof t.label?t.label:"")).toLowerCase().includes(e))},[A,I,y]),M=(0,n.useMemo)(()=>{if(0===t.length)return[];if(!y||!I.trim())return t;let e=new Map;return R.forEach(t=>{let r=t.group||"";e.has(r)||e.set(r,[]),e.get(r).push(t)}),t.map(t=>({label:t.label,items:e.get(t.label)||[]})).filter(e=>e.items.length>0)},[t,R,I,y]);(0,n.useEffect)(()=>{C||S("")},[C]),(0,n.useEffect)(()=>{if(C&&y&&E.current){let e=setTimeout(()=>{E.current?.focus()},100);return()=>clearTimeout(e)}},[C,y]),(0,n.useEffect)(()=>{v?.(C)},[C]);let D=(0,n.useCallback)(e=>{k(e)},[]),T=(0,n.useCallback)((e,t)=>{!e.disabled&&e.onClick&&(e.onClick(),e.keepOpen?t.preventDefault():k(!1))},[]),P=(0,n.useMemo)(()=>{let e=[];return"outline"===b?(e.push("dashboard-outline-button"),"md"===g&&e.push("dashboard-outline-button-md")):"text"===b&&(e.push("group flex items-center rounded-md","ease whitespace-nowrap transition duration-150"),"base"===g?e.push("py-[3px] web-text-sm gap-0.5"):e.push("py-[3px] web-text-base gap-0.5"),u?e.push("text-[var(--color-theme-text-tertiary)] cursor-not-allowed"):e.push("text-[var(--color-theme-text-primary)]","hover:text-[var(--color-theme-text-primary)]")),p&&e.push(p),(0,a.cn)(...e)},[b,g,u,p]),L="base"===g?"h-3 w-3":"h-4 w-4";return(0,s.jsx)(o.DropdownMenu,{open:C,onOpenChange:D,modal:!1,children:(0,s.jsxs)("div",{className:(0,a.cn)("relative",m),children:["string"==typeof r?(0,s.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)("button",{"aria-haspopup":"true","aria-expanded":C,className:P,disabled:u||d,children:[d?"Loading...":x?(0,s.jsx)("span",{className:(0,a.cn)("outline"===b&&"dashboard-outline-button-text",x),children:r}):r,(()=>{if("string"!=typeof r)return null;let e=(0,a.cn)("transition-transform",C&&"rotate-180");if("outline"===b)return(0,s.jsx)(l.A,{className:(0,a.cn)("h-3.5 w-3.5",e),style:{color:"var(--dashboard-icon-secondary)"}});let t=(0,a.cn)(L,e,u?"text-[var(--color-theme-text-quaternary)]":(0,a.cn)("text-[var(--color-theme-text-secondary)]","group-hover:text-[var(--color-theme-text-primary)]"));return(0,s.jsx)(l.A,{className:t})})()]})}):(0,s.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:r}),(0,s.jsxs)(o.DropdownMenuContent,{align:"left"===f?"start":"end",sideOffset:4,className:(0,a.cn)("dropdown-menu-content","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2","data-[side=top]:slide-in-from-bottom-2",h),children:[y&&A.length>0&&(0,s.jsxs)("div",{className:"dropdown-search-container",children:[(0,s.jsx)(i.A,{className:"h-3 w-3 text-theme-text-secondary flex-shrink-0"}),(0,s.jsx)("input",{ref:E,type:"text",placeholder:w,value:I,onChange:e=>S(e.target.value),className:"flex-1 bg-transparent border-none outline-none web-text-sm text-theme-text-primary placeholder:text-theme-text-secondary",onClick:e=>e.stopPropagation(),onKeyDown:e=>{if("Escape"===e.key)return void k(!1);["ArrowDown","ArrowUp","Home","End","Enter"].includes(e.key)||e.stopPropagation()},"aria-label":"Search items"})]}),(0,s.jsx)("div",{className:"dropdown-items-container",role:"menu",children:0===R.length?(0,s.jsx)("div",{className:"px-2 py-4 text-center web-text-sm text-theme-text-secondary",children:I?"No results found":"No items"}):M.length>0?M.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[t>0&&(0,s.jsx)(o.DropdownMenuSeparator,{className:"h-[1px] -mx-1",style:{backgroundColor:"var(--color-theme-border-tertiary)",height:"1px",minHeight:"1px"}}),(0,s.jsxs)(o.DropdownMenuGroup,{className:"dropdown-section",children:[(0,s.jsx)(o.DropdownMenuLabel,{className:"px-2 py-0.5 web-text-sm font-semibold text-theme-text-tertiary",children:e.label}),e.items.map((e,r)=>{let n=`dropdown-item-${t}-${r}`,l=(0,a.cn)("dropdown-item web-text-sm leading-[18px]",e.disabled&&"dropdown-item-disabled",e.className),i=void 0!==j&&void 0!==e.value&&j===e.value;return e.href?(0,s.jsx)(o.DropdownMenuItem,{disabled:e.disabled,onSelect:t=>{e.keepOpen?t.preventDefault():k(!1)},asChild:!0,children:(0,s.jsxs)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:(0,a.cn)(l,"dropdown-item-link"),children:[(0,s.jsx)("div",{className:"flex-1 min-w-0",children:e.secondaryText?(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium",children:e.label}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary",children:e.secondaryText})]}):e.label}),i&&(0,s.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0",style:{color:"var(--dashboard-icon-secondary)"}})]})},n):(0,s.jsx)(o.DropdownMenuItem,{disabled:e.disabled,onSelect:t=>T(e,t),asChild:!0,children:(0,s.jsxs)("button",{disabled:e.disabled,className:(0,a.cn)(l,"dropdown-item-button"),children:[(0,s.jsx)("div",{className:"flex-1 min-w-0",children:e.secondaryText?(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium",children:e.label}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary",children:e.secondaryText})]}):e.label}),i&&(0,s.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0",style:{color:"var(--dashboard-icon-secondary)"}})]})},n)})]})]},`group-${t}`)):R.map((e,t)=>{let r=`dropdown-item-${t}`,n=(0,a.cn)("dropdown-item web-text-sm leading-[18px]",e.disabled&&"dropdown-item-disabled",e.className),l=void 0!==j&&void 0!==e.value&&j===e.value;return e.href?(0,s.jsx)(o.DropdownMenuItem,{disabled:e.disabled,onSelect:t=>{e.keepOpen?t.preventDefault():k(!1)},asChild:!0,children:(0,s.jsxs)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:(0,a.cn)(n,"dropdown-item-link"),children:[(0,s.jsx)("div",{className:"flex-1 min-w-0",children:e.secondaryText?(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium",children:e.label}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary",children:e.secondaryText})]}):e.label}),l&&(0,s.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0",style:{color:"var(--dashboard-icon-secondary)"}})]})},r):(0,s.jsx)(o.DropdownMenuItem,{disabled:e.disabled,onSelect:t=>T(e,t),asChild:!0,children:(0,s.jsxs)("button",{disabled:e.disabled,className:(0,a.cn)(n,"dropdown-item-button"),children:[(0,s.jsx)("div",{className:"flex-1 min-w-0",children:e.secondaryText?(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"web-text-sm font-medium",children:e.label}),(0,s.jsx)("div",{className:"dashboard-xs text-theme-text-secondary",children:e.secondaryText})]}):e.label}),l&&(0,s.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0",style:{color:"var(--dashboard-icon-secondary)"}})]})},r)})}),N&&(0,s.jsx)("div",{className:"dropdown-footer",children:N})]})]})})}}},e=>{e.O(0,[47777,28445,28342,71804,19234,7475,41866,51875,76401,32007,19381,10216,42653,83801,32030,57111,8861,1956,4633,40950,14574,36075,73098,43169,89347,89576,13615,13528,25584,76034,88170,87444,12683,55939,47181,38173,48412,77358],()=>e(e.s=7103)),_N_E=e.O()}]);